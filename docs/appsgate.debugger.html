<!DOCTYPE html>

<html>
<head>
  <title>appsgate.debugger.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>appsgate.debugger.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <pre><code>AppsGate.Debugger v1<span class="hljs-number">.0</span><span class="hljs-number">.4</span>
</code></pre>
            </div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <pre><code>Copyright (c)<span class="hljs-number">2014</span> RÃ©mi Barraquand.
Distributed under ISC license
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>
(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(root, factory)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>Setup AppsGate.Debugger appropriately for the environment. Start with AMD.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> define === <span class="hljs-string">'function'</span> &amp;&amp; define.amd) {
        define([<span class="hljs-string">'backbone'</span>, <span class="hljs-string">'jquery'</span>, <span class="hljs-string">'underscore'</span>, <span class="hljs-string">'d3'</span>, <span class="hljs-string">'i18n'</span>, <span class="hljs-string">'exports'</span>], <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(Backbone, $, _, d3, i18n, exports)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>Export global even in AMD case in case this script is loaded with
others that may still expect a global AppsGateDebugger.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">return</span> (root.AppsGateDebugger = factory(root, exports, Backbone, $, _, d3, i18n));
        });
    } <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>Else, as a browser global.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        root.AppsGateDebugger = factory(root, {}, root.Backbone, root.$, root._, root.d3, root.i18n);
    }
}(<span class="hljs-keyword">this</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(root, Debugger, Backbone, $, _, d3, i18n)</span> </span>{
<span class="hljs-pi">    'use strict'</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <h2 id="initial-setup">Initial Setup</h2>

            </div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>Save the previous value of the AppsGateDebugger variable, so that it can be restored later on, if noConflict is used.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> previousDebugger = root.AppsGateDebugger;</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Current version of the library. Keep in sync with package.json.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    Debugger.VERSION = <span class="hljs-string">'1.0.4'</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>Runs AppsGate.Debugger.js in noConflict mode, returning the AppsGateDebugger variable to its previous owner.
Returns a reference to this AppsGateDebugger object.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    Debugger.noConflict = <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
        root.AppsGateDebugger = previousDebugger;
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>Borrow Backbone.extend function.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    Debugger.extend = Backbone.Model.extend;</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>Inline include of SVG file for faster loading.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> BASE_SVG = <span class="hljs-string">'&lt;svg xmlns="http://www.w3.org/2000/svg"&gt;&lt;defs&gt;&lt;g id="colorlight_state_off"&gt;&lt;g transform="matrix(.18519 0 0 .18519-12.778-148.7)"&gt;&lt;path fill="#f9f9f9" d="m122 847c0 4.971-4.03 9-9 9h-34c-4.971 0-9-4.03-9-9v-34c0-4.971 4.03-9 9-9h34c4.971 0 9 4.03 9 9v34"/&gt;&lt;path d="m122 847c0 4.971-4.03 9-9 9h-34c-4.971 0-9-4.03-9-9v-34c0-4.971 4.03-9 9-9h34c4.971 0 9 4.03 9 9v34z" stroke="#f8c500" stroke-miterlimit="10" stroke-width="2" fill="none"/&gt;&lt;/g&gt;&lt;path opacity=".62" fill="#fff" d="m5.88 6.185l.018-.796c.127-.099.243-.219.338-.36.47-.7.291-1.644-.399-2.107-.69-.463-1.631-.27-2.101.431-.47.7-.292 1.644.399 2.106.005.003.011.006.015.009l-.015.703 1.745.014"/&gt;&lt;path d="m5.675 6.489l-1.365.011c-.077.001-.115-.053-.116-.114 0-.061.037-.115.114-.116l1.365-.011c.077-.001.115.053.116.114 0 .061-.036.115-.114.116m-.689-4.089c.907-.007 1.646.72 1.653 1.624.004.462-.187.883-.494 1.183-.096.117-.152.267-.167.688-.004.101-.078.149-.157.146-.079-.003-.149-.056-.146-.157.017-.446.082-.684.249-.883.253-.245.415-.595.412-.974-.005-.737-.608-1.33-1.348-1.324-.737.006-1.33.608-1.324 1.345.003.379.171.727.427.968.17.196.239.433.262.879.005.101-.064.155-.143.159-.079.004-.154-.042-.159-.143-.022-.421-.08-.569-.178-.685-.312-.295-.509-.714-.512-1.175-.007-.904.72-1.643 1.625-1.65m.691 4.467l-1.365.011c-.077.001-.115-.052-.116-.114 0-.061.037-.115.114-.116l1.365-.011c.077-.001.115.052.116.114 0 .061-.036.115-.114.116m-.145.379l-1.07.009c-.077.001-.115-.053-.116-.114 0-.061.036-.115.114-.116l1.07-.008c.077-.001.115.052.115.114.001.062-.036.115-.114.116m-.162.156c-.056.124-.201.213-.372.214-.171.001-.317-.085-.375-.208l.746-.006" fill="#605f5f"/&gt;&lt;path stroke-miterlimit="10" d="m1.346 1.989h1.296" fill="none" stroke="#605f5f" stroke-width=".37"/&gt;&lt;/g&gt;&lt;g id="colorlight_state_on"&gt;&lt;g transform="matrix(.18519 0 0 .18519-24.26-148.7)"&gt;&lt;path d="m184 847c0 4.971-4.03 9-9 9h-34c-4.971 0-9-4.03-9-9v-34c0-4.971 4.03-9 9-9h34c4.971 0 9 4.03 9 9v34z" stroke="#f8c500" stroke-miterlimit="10" stroke-width="2" fill="none"/&gt;&lt;path d="m161.64 838l-7.371.059c-.416.003-.621-.284-.625-.616-.002-.331.199-.621.615-.624l7.371-.059c.418-.003.621.285.625.616.002.331-.197.622-.615.624m-3.719-22.08c4.9-.038 8.889 3.89 8.928 8.772.02 2.494-1.01 4.769-2.666 6.389-.518.634-.82 1.44-.902 3.714-.021.548-.422.803-.848.787-.426-.016-.807-.3-.787-.848.09-2.408.441-3.695 1.342-4.768 1.365-1.322 2.242-3.213 2.225-5.262-.029-3.98-3.281-7.182-7.281-7.15-3.98.031-7.18 3.283-7.15 7.264.018 2.047.922 3.924 2.307 5.225.918 1.059 1.291 2.34 1.416 4.747.029.547-.348.837-.773.858-.424.023-.83-.227-.857-.772-.119-2.272-.434-3.073-.961-3.699-1.684-1.595-2.746-3.853-2.766-6.347-.039-4.883 3.89-8.871 8.773-8.91m3.734 24.11l-7.371.058c-.416.003-.621-.283-.625-.615-.002-.331.199-.622.615-.625l7.371-.057c.418-.004.621.282.625.614.003.332-.197.623-.615.625m-.781 2.045l-5.777.046c-.418.003-.621-.284-.625-.615-.002-.332.197-.622.615-.626l5.779-.044c.416-.003.621.283.623.614.004.333-.197.623-.615.625m-.877.844c-.305.67-1.088 1.149-2.01 1.156-.922.008-1.713-.46-2.027-1.125l4.03-.031" fill="#605f5f"/&gt;&lt;circle cy="815.73" cx="142.73" r="6.397" transform="translate(-.964-2.029)" fill="#f8c500"/&gt;&lt;/g&gt;&lt;/g&gt;&lt;g id="colorlight_type"&gt;&lt;path opacity=".62" fill="#fff" d="m5.88 6.185l.018-.796c.127-.099.243-.219.338-.36.47-.7.291-1.644-.399-2.107-.69-.463-1.631-.27-2.101.431-.47.7-.292 1.644.399 2.106.005.003.011.006.015.009l-.015.703 1.745.014"/&gt;&lt;path fill="#605f5f" d="m99.52 841.39l-7.371.059c-.416.003-.621-.284-.625-.616-.002-.331.199-.621.615-.624l7.371-.059c.418-.003.621.285.625.616.002.331-.197.622-.615.624m-3.719-22.08c4.9-.038 8.889 3.89 8.928 8.772.02 2.494-1.01 4.769-2.666 6.389-.518.634-.82 1.44-.902 3.714-.021.548-.422.803-.848.787s-.807-.3-.787-.848c.09-2.408.441-3.695 1.342-4.768 1.365-1.322 2.242-3.213 2.225-5.262-.029-3.98-3.281-7.182-7.281-7.15-3.98.031-7.18 3.283-7.15 7.264.018 2.047.922 3.924 2.307 5.225.918 1.059 1.291 2.34 1.416 4.747.029.547-.348.837-.773.858-.424.023-.83-.227-.857-.772-.119-2.272-.434-3.073-.961-3.699-1.684-1.595-2.746-3.853-2.766-6.347-.04-4.882 3.89-8.871 8.773-8.91m3.734 24.12l-7.371.058c-.416.003-.621-.283-.625-.615-.002-.331.199-.622.615-.625l7.371-.057c.418-.004.621.282.625.614.002.332-.197.623-.615.625m-.781 2.045l-5.777.046c-.418.003-.621-.284-.625-.615-.002-.332.197-.622.615-.626l5.779-.044c.416-.003.621.283.623.614.004.333-.197.623-.615.625m-.877.843c-.305.67-1.088 1.149-2.01 1.156-.922.008-1.713-.46-2.027-1.125l4.03-.031" transform="matrix(.18519 0 0 .18519-12.778-148.7)"/&gt;&lt;/g&gt;&lt;g id="connection"&gt;&lt;g transform="matrix(.15994 0 0 .15994 1.197-108.4)" fill="#9acf00"&gt;&lt;path d="m27.57 704.8c.49-.699.329-1.663-.367-2.153l-.23-.161c-.691-.491-1.658-.321-2.148.38l-24.54 34.821c-.492.7-.33 1.665.367 2.154l.228.162c.695.489 1.658.318 2.151-.383l24.539-34.82"/&gt;&lt;path d="m27.598 692.96l7.665-10.878c.976-1.387.972-3.085-.026-3.786l-.336-.224c-.986-.708-2.593-.146-3.57 1.244l-7.496 10.639"/&gt;&lt;path d="m39.17 700.79l7.664-10.876c.975-1.388.972-3.086-.026-3.788l-.334-.224c-.987-.706-2.594-.144-3.57 1.247l-7.496 10.637"/&gt;&lt;path d="m39.27 694.64l-9.262-6.166"/&gt;&lt;path d="m25.379 685.39l-3.872-2.578-7.877 11.836c-3 4.516-1.905 10.713 2.289 14.988l-1.329 3.892 7.235 4.814 3.314-2.613c5.521 2.122 11.563.726 14.541-3.745l7.878-11.835-3.655-2.431"/&gt;&lt;/g&gt;&lt;/g&gt;&lt;g id="contact_state_off"&gt;&lt;g transform="matrix(.16949 0 0 .16949-63.898-41.36)"&gt;&lt;path d="m435 293c0 4.971-4.03 9-9 9h-39c-4.971 0-9-4.03-9-9v-39c0-4.971 4.03-9 9-9h39c4.971 0 9 4.03 9 9v39" fill="#f9f9f9"/&gt;&lt;path d="m435 293c0 4.971-4.03 9-9 9h-39c-4.971 0-9-4.03-9-9v-39c0-4.971 4.03-9 9-9h39c4.971 0 9 4.03 9 9v39z" stroke="#f8c500" stroke-miterlimit="10" stroke-width="2" fill="none"/&gt;&lt;/g&gt;&lt;g fill="#a0a0a0"&gt;&lt;path d="m429 286.16c0 1.56-1.275 2.835-2.835 2.835h-37.33c-1.56 0-2.835-1.275-2.835-2.835v-5.33c0-1.56 1.275-2.835 2.835-2.835h37.33c1.56 0 2.835 1.275 2.835 2.835v5.33" transform="matrix(.16949 0 0 .16949-64.07-41.36)"/&gt;&lt;path d="m5.238.645h2.203v.508h-2.203z" transform="matrix(.94274.33352-.33352.94274-.169 0)"/&gt;&lt;/g&gt;&lt;/g&gt;&lt;g id="contact_state_on"&gt;&lt;g transform="matrix(.16949 0 0 .16949-10.508-40.847)"&gt;&lt;path fill="#f9f9f9" d="m120 290c0 4.971-4.03 9-9 9h-39c-4.971 0-9-4.03-9-9v-39c0-4.971 4.03-9 9-9h39c4.971 0 9 4.03 9 9v39"/&gt;&lt;path d="m120 290c0 4.971-4.03 9-9 9h-39c-4.971 0-9-4.03-9-9v-39c0-4.971 4.03-9 9-9h39c4.971 0 9 4.03 9 9v39z" stroke="#f8c500" stroke-miterlimit="10" stroke-width="2" fill="none"/&gt;&lt;/g&gt;&lt;g transform="translate(-.171)" fill="#a0a0a0"&gt;&lt;path d="m114 281.16c0 1.56-1.275 2.835-2.835 2.835h-37.32c-1.56 0-2.835-1.28-2.835-2.84v-5.33c0-1.55 1.275-2.83 2.835-2.83h37.33c1.56 0 2.835 1.275 2.835 2.835v5.33z" transform="matrix(.16949 0 0 .16949-10.508-40.847)"/&gt;&lt;path d="m3.898 4.746h2.203v.508h-2.203z"/&gt;&lt;/g&gt;&lt;/g&gt;&lt;g id="contact_type"&gt;&lt;g transform="translate(-.17)" fill="#a0a0a0"&gt;&lt;path d="m114 281.16c0 1.56-1.275 2.835-2.835 2.835h-37.33c-1.56 0-2.835-1.28-2.835-2.84v-5.33c0-1.55 1.275-2.83 2.835-2.83h37.33c1.56 0 2.835 1.275 2.835 2.835v5.33" transform="matrix(.16949 0 0 .16949-10.508-40.847)"/&gt;&lt;path d="m3.898 4.746h2.203v.508h-2.203z"/&gt;&lt;/g&gt;&lt;/g&gt;&lt;g id="disconnection"&gt;&lt;g transform="matrix(.15994 0 0 .15994 1.197 0)" fill="#ce4242"&gt;&lt;path d="m27.57 27.04c.491-.699.329-1.663-.367-2.153l-.23-.161c-.691-.491-1.658-.321-2.148.38l-24.541 34.822c-.492.7-.33 1.665.367 2.154l.228.162c.695.489 1.658.318 2.151-.383l24.54-34.821" stroke-width=".6"/&gt;&lt;path d="m27.598 15.194l7.665-10.878c.975-1.387.971-3.085-.027-3.786l-.336-.224c-.986-.708-2.593-.146-3.57 1.244l-7.497 10.639"/&gt;&lt;path d="m39.17 23.03l7.664-10.876c.975-1.388.971-3.086-.026-3.788l-.334-.224c-.988-.706-2.594-.144-3.571 1.246l-7.496 10.637"/&gt;&lt;path d="m39.27 16.879l-9.262-6.166"/&gt;&lt;path d="m25.378 7.633l-3.872-2.578-7.876 11.836c-3.01 4.516-1.905 10.713 2.289 14.988l-1.329 3.892 7.235 4.814 3.314-2.613c5.521 2.122 11.564.726 14.541-3.745l7.878-11.835-3.655-2.431"/&gt;&lt;/g&gt;&lt;/g&gt;&lt;g id="domicube_state_1"&gt;&lt;g transform="translate(0-1042.36)"&gt;&lt;path fill="none" stroke="#000" stroke-linejoin="round" d="m.733 1043.09h8.535v8.54h-8.535z"/&gt;&lt;text x="2.058" y="1050.64" font-family="Sans" word-spacing="0" line-height="125%" letter-spacing="0" font-size="9"&gt;&lt;tspan x="2.058" y="1050.64"&gt;1&lt;/tspan&gt;&lt;/text&gt;&lt;/g&gt;&lt;/g&gt;&lt;g id="domicube_state_2"&gt;&lt;g transform="translate(0-1042.36)"&gt;&lt;path fill="none" stroke="#000" stroke-linejoin="round" d="m.733 1043.09h8.535v8.54h-8.535z"/&gt;&lt;text x="2.058" y="1050.64" font-family="Sans" word-spacing="0" line-height="125%" letter-spacing="0" font-size="9"&gt;&lt;tspan x="2.058" y="1050.64"&gt;2&lt;/tspan&gt;&lt;/text&gt;&lt;/g&gt;&lt;/g&gt;&lt;g id="domicube_state_3"&gt;&lt;g transform="translate(0-1042.36)"&gt;&lt;path fill="none" stroke="#000" stroke-linejoin="round" d="m.733 1043.09h8.535v8.54h-8.535z"/&gt;&lt;text x="2.058" y="1050.64" font-family="Sans" word-spacing="0" line-height="125%" letter-spacing="0" font-size="9"&gt;&lt;tspan x="2.058" y="1050.64"&gt;3&lt;/tspan&gt;&lt;/text&gt;&lt;/g&gt;&lt;/g&gt;&lt;g id="domicube_state_4"&gt;&lt;g transform="translate(0-1042.36)"&gt;&lt;path fill="none" stroke="#000" stroke-linejoin="round" d="m.733 1043.09h8.535v8.54h-8.535z"/&gt;&lt;text x="2.058" y="1050.64" font-family="Sans" word-spacing="0" line-height="125%" letter-spacing="0" font-size="9"&gt;&lt;tspan x="2.058" y="1050.64"&gt;4&lt;/tspan&gt;&lt;/text&gt;&lt;/g&gt;&lt;/g&gt;&lt;g id="domicube_state_5"&gt;&lt;g transform="translate(0-1042.36)"&gt;&lt;path fill="none" stroke="#000" stroke-linejoin="round" d="m.733 1043.09h8.535v8.54h-8.535z"/&gt;&lt;text x="2.058" y="1050.64" font-family="Sans" word-spacing="0" line-height="125%" letter-spacing="0" font-size="9"&gt;&lt;tspan x="2.058" y="1050.64"&gt;5&lt;/tspan&gt;&lt;/text&gt;&lt;/g&gt;&lt;/g&gt;&lt;g id="domicube_state_6"&gt;&lt;g transform="translate(0-1042.36)"&gt;&lt;path fill="none" stroke="#000" stroke-linejoin="round" d="m.733 1043.09h8.535v8.54h-8.535z"/&gt;&lt;text x="2.058" y="1050.64" font-family="Sans" word-spacing="0" line-height="125%" letter-spacing="0" font-size="9"&gt;&lt;tspan x="2.058" y="1050.64"&gt;6&lt;/tspan&gt;&lt;/text&gt;&lt;/g&gt;&lt;/g&gt;&lt;g id="domicube_state_off"&gt;&lt;g transform="translate(0-1042.36)"&gt;&lt;g transform="matrix(.17241 0 0 .17241-24.482 1028.05)"&gt;&lt;path d="m199 131c0 4.971-4.03 9-9 9h-38c-4.971 0-9-4.03-9-9v-38c0-4.971 4.03-9 9-9h38c4.971 0 9 4.03 9 9v38" fill="#f9f9f9"/&gt;&lt;path stroke-miterlimit="10" d="m199 131c0 4.971-4.03 9-9 9h-38c-4.971 0-9-4.03-9-9v-38c0-4.971 4.03-9 9-9h38c4.971 0 9 4.03 9 9v38z" fill="none" stroke="#f8c500" stroke-width="2"/&gt;&lt;/g&gt;&lt;g fill="none" stroke="#605f5f"&gt;&lt;path d="m3.21 1045.57h3.581v3.581h-3.581z" stroke-linejoin="round" stroke-width=".419"/&gt;&lt;path stroke-miterlimit="10" d="m1.346 1044.35h1.296" stroke-width=".37"/&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;g id="domicube_state_on"&gt;&lt;g transform="translate(0-1042.36)"&gt;&lt;g transform="matrix(.17241 0 0 .17241-24.482 1028.05)"&gt;&lt;path d="m199 131c0 4.971-4.03 9-9 9h-38c-4.971 0-9-4.03-9-9v-38c0-4.971 4.03-9 9-9h38c4.971 0 9 4.03 9 9v38" fill="#f9f9f9"/&gt;&lt;path stroke-miterlimit="10" d="m199 131c0 4.971-4.03 9-9 9h-38c-4.971 0-9-4.03-9-9v-38c0-4.971 4.03-9 9-9h38c4.971 0 9 4.03 9 9v38z" fill="none" stroke="#f8c500" stroke-width="2"/&gt;&lt;/g&gt;&lt;path d="m3.21 1045.57h3.581v3.581h-3.581z" fill="none" stroke="#605f5f" stroke-linejoin="round" stroke-width=".419"/&gt;&lt;circle r="6.397" stroke-miterlimit="10" cy="891.73" cx="437.73" transform="matrix(.18519 0 0 .18519-79.07 879.21)" fill="#f8c500"/&gt;&lt;/g&gt;&lt;/g&gt;&lt;g id="domicube_type"&gt;&lt;path d="m3.21 1045.57h3.581v3.581h-3.581z" fill="none" stroke="#605f5f" stroke-linejoin="round" stroke-width=".419" transform="translate(0-1042.36)"/&gt;&lt;/g&gt;&lt;g id="focus"&gt;&lt;path d="m2.083 6.25h-.833v1.667c0 .46.373.833.833.833h1.667v-.833h-1.667v-1.667m0-4.167h1.667v-.833h-1.667c-.46 0-.833.373-.833.833v1.667h.833v-1.667m5.833-.833h-1.667v.833h1.667v1.667h.833v-1.667c0-.46-.373-.833-.833-.833m0 6.667h-1.667v.833h1.667c.46 0 .833-.373.833-.833v-1.667h-.833v1.667m-2.917-4.583c-.921 0-1.667.746-1.667 1.667 0 .921.746 1.667 1.667 1.667.921 0 1.667-.746 1.667-1.667 0-.921-.746-1.667-1.667-1.667m0 2.5c-.46 0-.833-.373-.833-.833 0-.46.373-.833.833-.833.46 0 .833.373.833.833 0 .46-.373.833-.833.833"/&gt;&lt;/g&gt;&lt;g id="focused"&gt;&lt;path d="m5 3.333c-.921 0-1.667.746-1.667 1.667 0 .921.746 1.667 1.667 1.667.921 0 1.667-.746 1.667-1.667 0-.921-.746-1.667-1.667-1.667m-2.917 2.917h-.833v1.667c0 .46.373.833.833.833h1.667v-.833h-1.667v-1.667m0-4.167h1.667v-.833h-1.667c-.46 0-.833.373-.833.833v1.667h.833v-1.667m5.833-.833h-1.667v.833h1.667v1.667h.833v-1.667c0-.46-.373-.833-.833-.833m0 6.667h-1.667v.833h1.667c.46 0 .833-.373.833-.833v-1.667h-.833v1.667"/&gt;&lt;/g&gt;&lt;g id="illumination_state_off"&gt;&lt;g transform="matrix(.17241 0 0 .17241-36.897-27.759)"&gt;&lt;path d="m271 209c0 4.971-4.03 9-9 9h-38c-4.971 0-9-4.03-9-9v-38c0-4.971 4.03-9 9-9h38c4.971 0 9 4.03 9 9v38" fill="#f9f9f9"/&gt;&lt;path stroke-miterlimit="10" d="m271 209c0 4.971-4.03 9-9 9h-38c-4.971 0-9-4.03-9-9v-38c0-4.971 4.03-9 9-9h38c4.971 0 9 4.03 9 9v38z" fill="none" stroke="#f8c500" stroke-width="2"/&gt;&lt;/g&gt;&lt;g transform="matrix(.17241 0 0 .17241-36.983-26.983)"&gt;&lt;path stroke-miterlimit="10" d="m248.01 185.6c0 2.477-2.01 4.482-4.483 4.482-2.477 0-4.483-2.01-4.483-4.482 0-2.479 2.01-4.484 4.483-4.484 2.475-.001 4.483 2 4.483 4.484z" fill="#808080" stroke="#605f5f" stroke-width="3"/&gt;&lt;g fill="#605f5f"&gt;&lt;path d="m240 182.66c.333.465.311 1.05-.05 1.305-.358.255-.917.083-1.249-.384l-4.795-6.76c-.33-.466-.309-1.051.051-1.305.359-.257.918-.085 1.25.382l4.793 6.762"/&gt;&lt;path d="m240.47 189.02c.538-.379 1.179-.398 1.435-.039.254.359.022.961-.514 1.34l-7.786 5.511c-.54.38-1.181.397-1.436.04-.254-.362-.024-.96.513-1.34l7.788-5.512"/&gt;&lt;path d="m246.52 189.22c-.366-.519-.373-1.144-.013-1.396.36-.255.947-.043 1.312.473l5.29 7.475c.363.516.369 1.14.012 1.396-.359.252-.947.041-1.312-.475l-5.289-7.473"/&gt;&lt;path d="m247.65 183.07c-.465.332-1.05.309-1.304-.051-.255-.36-.082-.918.386-1.251l6.762-4.786c.467-.328 1.054-.306 1.305.056.257.356.083.917-.384 1.245l-6.765 4.787"/&gt;&lt;path d="m245 200.09c0 .642-.34.912-.759.912h-.482c-.419 0-.759-.271-.759-.912v-9.926c0-.642.34-1.162.759-1.162h.482c.419 0 .759.521.759 1.162v9.926"/&gt;&lt;path d="m245 180.14c0 .607-.34.864-.759.864h-.482c-.419 0-.759-.257-.759-.864v-9.409c0-.608.34-.727.759-.727h.482c.419 0 .759.118.759.727v9.409"/&gt;&lt;path d="m259 186.24c0 .419-.869.759-1.424.759h-8.572c-.555 0-1-.34-1-.759v-.482c0-.419.449-.759 1-.759h8.572c.555 0 1.424.34 1.424.759v.482"/&gt;&lt;path d="m239 186.24c0 .419-.46.759-1.027.759h-8.778c-.567 0-1.194-.34-1.194-.759v-.482c0-.419.627-.759 1.194-.759h8.778c.567 0 1.027.34 1.027.759v.482"/&gt;&lt;/g&gt;&lt;ellipse stroke-miterlimit="10" cx="243.53" cy="185.69" rx="6.875" ry="6.81" fill="none" stroke="#f9f9f9" stroke-width="3"/&gt;&lt;/g&gt;&lt;path stroke-miterlimit="10" d="m1.346 1.989h1.296" fill="none" stroke="#605f5f" stroke-width=".37"/&gt;&lt;/g&gt;&lt;g id="illumination_state_on"&gt;&lt;g transform="matrix(.17241 0 0 .17241-36.897-27.759)"&gt;&lt;path d="m271 209c0 4.971-4.03 9-9 9h-38c-4.971 0-9-4.03-9-9v-38c0-4.971 4.03-9 9-9h38c4.971 0 9 4.03 9 9v38" fill="#f9f9f9"/&gt;&lt;path stroke-miterlimit="10" d="m271 209c0 4.971-4.03 9-9 9h-38c-4.971 0-9-4.03-9-9v-38c0-4.971 4.03-9 9-9h38c4.971 0 9 4.03 9 9v38z" fill="none" stroke="#f8c500" stroke-width="2"/&gt;&lt;/g&gt;&lt;g transform="matrix(.17241 0 0 .17241-36.983-26.983)"&gt;&lt;path stroke-miterlimit="10" d="m248.01 185.6c0 2.477-2.01 4.482-4.483 4.482-2.477 0-4.483-2.01-4.483-4.482 0-2.479 2.01-4.484 4.483-4.484 2.475-.001 4.483 2 4.483 4.484z" fill="#f8c500" stroke="#605f5f" stroke-width="3"/&gt;&lt;g fill="#605f5f"&gt;&lt;path d="m240 182.66c.333.465.311 1.05-.05 1.305-.358.255-.917.083-1.249-.384l-4.795-6.76c-.33-.466-.309-1.051.051-1.305.359-.257.918-.085 1.25.382l4.793 6.762"/&gt;&lt;path d="m240.47 189.02c.538-.379 1.179-.398 1.435-.039.254.359.022.961-.514 1.34l-7.786 5.511c-.54.38-1.181.397-1.436.04-.254-.362-.024-.96.513-1.34l7.788-5.512"/&gt;&lt;path d="m246.52 189.22c-.366-.519-.373-1.144-.013-1.396.36-.255.947-.043 1.312.473l5.29 7.475c.363.516.369 1.14.012 1.396-.359.252-.947.041-1.312-.475l-5.289-7.473"/&gt;&lt;path d="m247.65 183.07c-.465.332-1.05.309-1.304-.051-.255-.36-.082-.918.386-1.251l6.762-4.786c.467-.328 1.054-.306 1.305.056.257.356.083.917-.384 1.245l-6.765 4.787"/&gt;&lt;path d="m245 200.09c0 .642-.34.912-.759.912h-.482c-.419 0-.759-.271-.759-.912v-9.926c0-.642.34-1.162.759-1.162h.482c.419 0 .759.521.759 1.162v9.926"/&gt;&lt;path d="m245 180.14c0 .607-.34.864-.759.864h-.482c-.419 0-.759-.257-.759-.864v-9.409c0-.608.34-.727.759-.727h.482c.419 0 .759.118.759.727v9.409"/&gt;&lt;path d="m259 186.24c0 .419-.869.759-1.424.759h-8.572c-.555 0-1-.34-1-.759v-.482c0-.419.449-.759 1-.759h8.572c.555 0 1.424.34 1.424.759v.482"/&gt;&lt;path d="m239 186.24c0 .419-.46.759-1.027.759h-8.778c-.567 0-1.194-.34-1.194-.759v-.482c0-.419.627-.759 1.194-.759h8.778c.567 0 1.027.34 1.027.759v.482"/&gt;&lt;/g&gt;&lt;ellipse stroke-miterlimit="10" cx="243.53" cy="185.69" rx="6.875" ry="6.81" fill="none" stroke="#f9f9f9" stroke-width="3"/&gt;&lt;/g&gt;&lt;circle r="6.397" stroke-miterlimit="10" cy="891.73" cx="437.73" transform="matrix(.18519 0 0 .18519-79.07-163.15)" fill="#f8c500"/&gt;&lt;/g&gt;&lt;g id="illumination_type"&gt;&lt;g transform="matrix(.17241 0 0 .17241-36.983-26.983)"&gt;&lt;path d="m248.01 185.6c0 2.477-2.01 4.482-4.483 4.482-2.477 0-4.483-2.01-4.483-4.482 0-2.479 2.01-4.484 4.483-4.484 2.475-.001 4.483 2 4.483 4.484z" stroke-miterlimit="10" fill="#bebebe" stroke="#5f5f5f" stroke-width="3"/&gt;&lt;g fill="#5f5f5f"&gt;&lt;path d="m240 182.66c.333.465.311 1.05-.05 1.305-.358.255-.917.083-1.249-.384l-4.795-6.76c-.33-.466-.309-1.051.051-1.305.359-.257.918-.085 1.25.382l4.793 6.762"/&gt;&lt;path d="m240.47 189.02c.538-.379 1.179-.398 1.435-.039.254.359.022.961-.514 1.34l-7.786 5.511c-.54.38-1.181.397-1.436.04-.254-.362-.024-.96.513-1.34l7.788-5.512"/&gt;&lt;path d="m246.52 189.22c-.366-.519-.373-1.144-.013-1.396.36-.255.947-.043 1.312.473l5.29 7.475c.363.516.369 1.14.012 1.396-.359.252-.947.041-1.312-.475l-5.289-7.473"/&gt;&lt;path d="m247.65 183.07c-.465.332-1.05.309-1.304-.051-.255-.36-.082-.918.386-1.251l6.762-4.786c.467-.328 1.054-.306 1.305.056.257.356.083.917-.384 1.245l-6.765 4.787"/&gt;&lt;path d="m245 200.09c0 .642-.34.912-.759.912h-.482c-.419 0-.759-.271-.759-.912v-9.926c0-.642.34-1.162.759-1.162h.482c.419 0 .759.521.759 1.162v9.926"/&gt;&lt;path d="m245 180.14c0 .607-.34.864-.759.864h-.482c-.419 0-.759-.257-.759-.864v-9.409c0-.608.34-.727.759-.727h.482c.419 0 .759.118.759.727v9.409"/&gt;&lt;path d="m259 186.24c0 .419-.869.759-1.424.759h-8.572c-.555 0-1-.34-1-.759v-.482c0-.419.449-.759 1-.759h8.572c.555 0 1.424.34 1.424.759v.482"/&gt;&lt;path d="m239 186.24c0 .419-.46.759-1.027.759h-8.778c-.567 0-1.194-.34-1.194-.759v-.482c0-.419.627-.759 1.194-.759h8.778c.567 0 1.027.34 1.027.759v.482"/&gt;&lt;/g&gt;&lt;ellipse ry="6.81" rx="6.875" cy="185.69" cx="243.53" stroke-miterlimit="10" fill="none" stroke="#f9f9f9" stroke-width="3"/&gt;&lt;/g&gt;&lt;/g&gt;&lt;g id="keycardswitch_state_in"&gt;&lt;g transform="matrix(.17857 0 0 .17857-40-57.679)"&gt;&lt;path fill="#f9f9f9" d="m279 369c0 4.971-4.03 9-9 9h-36c-4.971 0-9-4.03-9-9v-36c0-4.971 4.03-9 9-9h36c4.971 0 9 4.03 9 9v36"/&gt;&lt;path d="m279 369c0 4.971-4.03 9-9 9h-36c-4.971 0-9-4.03-9-9v-36c0-4.971 4.03-9 9-9h36c4.971 0 9 4.03 9 9v36z" stroke="#f8c500" stroke-miterlimit="10" stroke-width="2" fill="none"/&gt;&lt;/g&gt;&lt;g transform="matrix(.17857 0 0 .17857-40-57.679)"&gt;&lt;path opacity=".31" fill="#bf9100" d="m260.42 350h-17.42v-7.13z"/&gt;&lt;path stroke-width="2" stroke="#f9f9f9" stroke-miterlimit="10" fill="none" d="m252 353v14"/&gt;&lt;path fill="#f9f9f9" d="m255 366.36l-3 3.39-3-3.39v-2.88l3 3.39 3-3.39z"/&gt;&lt;/g&gt;&lt;path fill="#333" d="m2.679 3.929h4.464v5h-4.464z"/&gt;&lt;path transform="matrix(.17857 0 0 .17857-40-57.679)" stroke="#cecece" stroke-miterlimit="10" fill="none" d="m240.38 346.17l1.95 3.33h19.67l1.27-3.36"/&gt;&lt;path fill="#f8c500" d="m3.393 3.571h3.214v1.25h-3.214z"/&gt;&lt;/g&gt;&lt;g id="keycardswitch_state_out"&gt;&lt;g transform="matrix(.17857 0 0 .17857-11.607-57.679)"&gt;&lt;path fill="#f9f9f9" d="m120 369c0 4.971-4.03 9-9 9h-36c-4.971 0-9-4.03-9-9v-36c0-4.971 4.03-9 9-9h36c4.971 0 9 4.03 9 9v36"/&gt;&lt;path d="m120 369c0 4.971-4.03 9-9 9h-36c-4.971 0-9-4.03-9-9v-36c0-4.971 4.03-9 9-9h36c4.971 0 9 4.03 9 9v36z" stroke="#f8c500" stroke-miterlimit="10" stroke-width="2" fill="none"/&gt;&lt;/g&gt;&lt;path fill="#333" d="m2.857 3.929h4.286v5h-4.286z"/&gt;&lt;path transform="matrix(.17857 0 0 .17857-11.607-57.679)" stroke="#cecece" stroke-miterlimit="10" fill="none" d="m81.43 346.14l1.95 3.36h19.72l1.27-3.38"/&gt;&lt;path fill="#f8c500" d="m3.571.893h2.857v3.75h-2.857z"/&gt;&lt;path opacity=".31" transform="matrix(.17857 0 0 .17857-11.607-57.679)" fill="#bf9100" d="M85 328.22 101.51 349 85 349z"/&gt;&lt;/g&gt;&lt;g id="keycardswitch_type"&gt;&lt;g fill="#666"&gt;&lt;path d="m2.857 3.929h4.286v5h-4.286z"/&gt;&lt;path transform="matrix(.17857 0 0 .17857-11.607-57.679)" stroke="#cecece" stroke-miterlimit="10" d="m81.43 346.14l1.95 3.36h19.72l1.27-3.38"/&gt;&lt;/g&gt;&lt;path fill="#999" d="m3.571.893h2.857v3.75h-2.857z"/&gt;&lt;path opacity=".31" transform="matrix(.17857 0 0 .17857-11.607-57.679)" fill="#666" d="M85 328.22 101.51 349 85 349z"/&gt;&lt;/g&gt;&lt;g id="magnify"&gt;&lt;g transform="matrix(.06305 0 0 .06335 0-.157)"&gt;&lt;path d="m67.37 66.43c-3.964 3.973-3.972 10.405 0 14.369l73.899 73.903c3.971 3.964 10.401 3.964 14.373 0 3.963-3.972 3.963-10.412 0-14.376l-73.903-73.889c-1.981-1.984-4.58-2.976-7.18-2.976-2.6 0-5.201.992-7.188 2.976z"/&gt;&lt;path d="m5.804 55.611c0 27.609 22.377 49.992 49.981 49.992 27.597 0 49.98-22.383 49.98-49.992 0-27.595-22.377-49.969-49.975-49.969-27.604 0-49.981 22.374-49.981 49.972z" fill="#0ff"/&gt;&lt;path d="m55.891 16.495c9.06 0 17.537 1.599 24.78 4.372-6.461-5.217-15.177-8.424-24.78-8.424-9.603 0-18.321 3.207-24.781 8.424 7.243-2.773 15.717-4.372 24.781-4.372" fill="#fff"/&gt;&lt;path d="m76.75 51.43v7.932h-16.468v16.771h-8.64v-16.771h-16.468v-7.932h16.468v-16.869h8.64v16.869h16.468" fill="#1a1a1a"/&gt;&lt;g fill="#666"&gt;&lt;path d="m86.16 99.58l14.09 14.1 14.37-14.369-14.1-14.09-14.364 14.368"/&gt;&lt;path d="m0 55.829c0 30.93 25.07 56.01 56 56.01 30.924 0 55.998-25.08 55.998-56.01 0-30.92-25.07-55.997-55.998-55.997-30.93-.005-56 25.07-56 55.992z"/&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;g id="mediaplayer_state_off"&gt;&lt;g transform="translate(-7.627-1049.44)"&gt;&lt;g transform="matrix(.17241 0 0 .17241-16.855 1035.13)"&gt;&lt;path d="m199 131c0 4.971-4.03 9-9 9h-38c-4.971 0-9-4.03-9-9v-38c0-4.971 4.03-9 9-9h38c4.971 0 9 4.03 9 9v38" fill="#f9f9f9"/&gt;&lt;path stroke-miterlimit="10" d="m199 131c0 4.971-4.03 9-9 9h-38c-4.971 0-9-4.03-9-9v-38c0-4.971 4.03-9 9-9h38c4.971 0 9 4.03 9 9v38z" fill="none" stroke="#f8c500" stroke-width="2"/&gt;&lt;/g&gt;&lt;path stroke-miterlimit="10" d="m8.973 1051.43h1.296" fill="none" stroke="#605f5f" stroke-width=".37"/&gt;&lt;/g&gt;&lt;g transform="matrix(.08333 0 0 .08333 2.333 2.333)" fill="#666"&gt;&lt;path d="m52 12.982h-40c-2.2 0-4 1.8-4 4v30.04c0 2.2 1.8 4 4 4h40c2.2 0 4-1.8 4-4v-30.04c0-2.2-1.8-4-4-4m-23.796 7.807l9.593 6.55-9.593 6.55v-13.1m19.797 22.423h-21.13c-.57 1.24-1.816 2.105-3.27 2.105-1.454 0-2.699-.866-3.27-2.105h-4.335c-.829 0-1.5-.672-1.5-1.5 0-.828.671-1.5 1.5-1.5h4.336c.57-1.24 1.815-2.106 3.27-2.106 1.455 0 2.7.866 3.27 2.106h21.13c.828 0 1.5.672 1.5 1.5 0 .828-.673 1.5-1.501 1.5"/&gt;&lt;circle cx="23.605" cy="41.712" r="1.397"/&gt;&lt;/g&gt;&lt;/g&gt;&lt;g id="mediaplayer_state_on"&gt;&lt;g transform="translate(-7.627-1049.44)"&gt;&lt;g transform="matrix(.17241 0 0 .17241-16.855 1035.13)"&gt;&lt;path d="m199 131c0 4.971-4.03 9-9 9h-38c-4.971 0-9-4.03-9-9v-38c0-4.971 4.03-9 9-9h38c4.971 0 9 4.03 9 9v38" fill="#f9f9f9"/&gt;&lt;path stroke-miterlimit="10" d="m199 131c0 4.971-4.03 9-9 9h-38c-4.971 0-9-4.03-9-9v-38c0-4.971 4.03-9 9-9h38c4.971 0 9 4.03 9 9v38z" fill="none" stroke="#f8c500" stroke-width="2"/&gt;&lt;/g&gt;&lt;circle r="6.397" stroke-miterlimit="10" cy="891.73" cx="437.73" transform="matrix(.18519 0 0 .18519-71.44 886.29)" fill="#f8c500"/&gt;&lt;/g&gt;&lt;g transform="matrix(.08333 0 0 .08333 2.333 2.333)" fill="#666"&gt;&lt;path d="m52 12.982h-40c-2.2 0-4 1.8-4 4v30.04c0 2.2 1.8 4 4 4h40c2.2 0 4-1.8 4-4v-30.04c0-2.2-1.8-4-4-4m-23.796 7.807l9.593 6.55-9.593 6.55v-13.1m19.797 22.423h-21.13c-.57 1.24-1.816 2.105-3.27 2.105-1.454 0-2.699-.866-3.27-2.105h-4.335c-.829 0-1.5-.672-1.5-1.5 0-.828.671-1.5 1.5-1.5h4.336c.57-1.24 1.815-2.106 3.27-2.106 1.455 0 2.7.866 3.27 2.106h21.13c.828 0 1.5.672 1.5 1.5 0 .828-.673 1.5-1.501 1.5"/&gt;&lt;circle cx="23.605" cy="41.712" r="1.397"/&gt;&lt;/g&gt;&lt;/g&gt;&lt;g id="mediaplayer_type"&gt;&lt;g transform="matrix(.08333 0 0 .08333 2.333 2.333)" fill="#666"&gt;&lt;path d="m52 12.982h-40c-2.2 0-4 1.8-4 4v30.04c0 2.2 1.8 4 4 4h40c2.2 0 4-1.8 4-4v-30.04c0-2.2-1.8-4-4-4m-23.796 7.807l9.593 6.55-9.593 6.55v-13.1m19.797 22.423h-21.13c-.57 1.24-1.816 2.105-3.27 2.105-1.454 0-2.699-.866-3.27-2.105h-4.335c-.829 0-1.5-.672-1.5-1.5 0-.828.671-1.5 1.5-1.5h4.336c.57-1.24 1.815-2.106 3.27-2.106 1.455 0 2.7.866 3.27 2.106h21.13c.828 0 1.5.672 1.5 1.5 0 .828-.673 1.5-1.501 1.5"/&gt;&lt;circle cx="23.605" cy="41.712" r="1.397"/&gt;&lt;/g&gt;&lt;/g&gt;&lt;g id="program"&gt;&lt;g transform="matrix(.10837 0 0 .1001-.418.022)"&gt;&lt;path d="m81.902 11.08h-63.813c-3.478 0-6.288 2.936-6.288 6.561v75.47c0 3.625 2.811 6.562 6.288 6.562h63.813c3.477 0 6.29-2.938 6.29-6.562v-75.47c0-3.624-2.813-6.561-6.29-6.561m.755 79.01s.173 1.517-.537 2.303c-.721.8-2.055.691-2.055.691l-60.709.032s-.856-.013-1.509-.762c-.564-.646-.557-2.02-.557-2.02l.022-70.43s0-1.043.611-1.6c.659-.602 1.612-.653 1.612-.653h60.721s1.151-.032 1.689.519c.732.749.71 1.536.71 1.536v70.38z"/&gt;&lt;path d="m37.19 32.05h35.439v3.151h-35.439z"/&gt;&lt;path d="m26.04 43.29v7.874h7.876v-7.874h-7.876m1.18 6.682v-5.51h5.514v5.51h-5.514"/&gt;&lt;path d="m37.19 47.01h35.439v3.15h-35.439z"/&gt;&lt;path d="m37.19 61.36h35.439v3.15h-35.439z"/&gt;&lt;path d="m37.19 75.36h35.439v3.149h-35.439z"/&gt;&lt;path d="m26.04 28.324v7.875h7.876v-7.875h-7.876m1.18 6.682v-5.509h5.514v5.509h-5.514"/&gt;&lt;path d="m26.04 57.636v7.874h7.876v-7.874h-7.876m1.18 6.682v-5.511h5.514v5.511h-5.514"/&gt;&lt;path d="m26.04 71.64v7.874h7.876v-7.874h-7.876m1.18 6.681v-5.51h5.514v5.51h-5.514"/&gt;&lt;g&gt;&lt;path d="m55.722 2.298c0 1.392-1.254 2.519-2.799 2.519h-5.596c-1.546 0-2.799-1.127-2.799-2.519 0-1.39 1.253-2.518 2.799-2.518h5.596c1.545 0 2.799 1.128 2.799 2.518"/&gt;&lt;path d="m62.11 7.748c0-1.458-.134-3.888-1.324-3.888h-21.546c-1.113 0-1.38 2.44-1.362 3.883l24.23.005"/&gt;&lt;path d="m67.31 12.798c0-2.084-.191-5.556-1.891-5.556h-30.78c-1.592 0-1.972 3.488-1.947 5.549l34.618.007"/&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;g id="programe"&gt;&lt;g transform="matrix(.10837 0 0 .1001-.418.022)"&gt;&lt;path d="m81.902 11.08h-63.813c-3.478 0-6.288 2.936-6.288 6.561v75.47c0 3.625 2.811 6.562 6.288 6.562h63.813c3.477 0 6.29-2.938 6.29-6.562v-75.47c0-3.624-2.813-6.561-6.29-6.561m.755 79.01s.173 1.517-.537 2.303c-.721.8-2.055.691-2.055.691l-60.709.032s-.856-.013-1.509-.762c-.564-.646-.557-2.02-.557-2.02l.022-70.43s0-1.043.611-1.6c.659-.602 1.612-.653 1.612-.653h60.721s1.151-.032 1.689.519c.732.749.71 1.536.71 1.536v70.38z"/&gt;&lt;path d="m37.19 32.05h35.439v3.151h-35.439z"/&gt;&lt;path d="m26.04 43.29v7.874h7.876v-7.874h-7.876m1.18 6.682v-5.51h5.514v5.51h-5.514"/&gt;&lt;path d="m37.19 47.01h35.439v3.15h-35.439z"/&gt;&lt;path d="m37.19 61.36h35.439v3.15h-35.439z"/&gt;&lt;path d="m37.19 75.36h35.439v3.149h-35.439z"/&gt;&lt;path d="m26.04 28.324v7.875h7.876v-7.875h-7.876m1.18 6.682v-5.509h5.514v5.509h-5.514"/&gt;&lt;path d="m26.04 57.636v7.874h7.876v-7.874h-7.876m1.18 6.682v-5.511h5.514v5.511h-5.514"/&gt;&lt;path d="m26.04 71.64v7.874h7.876v-7.874h-7.876m1.18 6.681v-5.51h5.514v5.51h-5.514"/&gt;&lt;g&gt;&lt;path d="m55.722 2.298c0 1.392-1.254 2.519-2.799 2.519h-5.596c-1.546 0-2.799-1.127-2.799-2.519 0-1.39 1.253-2.518 2.799-2.518h5.596c1.545 0 2.799 1.128 2.799 2.518"/&gt;&lt;path d="m62.11 7.748c0-1.458-.134-3.888-1.324-3.888h-21.546c-1.113 0-1.38 2.44-1.362 3.883l24.23.005"/&gt;&lt;path d="m67.31 12.798c0-2.084-.191-5.556-1.891-5.556h-30.78c-1.592 0-1.972 3.488-1.947 5.549l34.618.007"/&gt;&lt;/g&gt;&lt;/g&gt;&lt;/g&gt;&lt;g id="read"&gt;&lt;g transform="matrix(.10837 0 0 .1001.442.022)"&gt;&lt;path d="m81.902 11.08h-63.813c-3.478 0-6.288 2.936-6.288 6.561v75.47c0 3.625 2.811 6.562 6.288 6.562h63.813c3.477 0 6.29-2.938 6.29-6.562v-75.47c0-3.624-2.813-6.561-6.29-6.561m.755 79.01s.173 1.517-.537 2.303c-.721.8-2.055.691-2.055.691l-60.709.032s-.856-.013-1.509-.762c-.564-.646-.557-2.02-.557-2.02l.022-70.43s0-1.043.611-1.6c.659-.602 1.612-.653 1.612-.653h60.721s1.151-.032 1.689.519c.732.749.71 1.536.71 1.536v70.38z"/&gt;&lt;path d="m37.19 32.05h35.439v3.151h-35.439z"/&gt;&lt;path d="m26.04 43.29v7.874h7.876v-7.874h-7.876m1.18 6.682v-5.51h5.514v5.51h-5.514"/&gt;&lt;path d="m37.19 47.01h35.439v3.15h-35.439z"/&gt;&lt;path d="m37.19 61.36h35.439v3.15h-35.439z"/&gt;&lt;path d="m37.19 75.36h35.439v3.149h-35.439z"/&gt;&lt;path d="m26.04 28.324v7.875h7.876v-7.875h-7.876m1.18 6.682v-5.509h5.514v5.509h-5.514"/&gt;&lt;path d="m26.04 57.636v7.874h7.876v-7.874h-7.876m1.18 6.682v-5.511h5.514v5.511h-5.514"/&gt;&lt;path d="m26.04 71.64v7.874h7.876v-7.874h-7.876m1.18 6.681v-5.51h5.514v5.51h-5.514"/&gt;&lt;g&gt;&lt;path d="m55.722 2.298c0 1.392-1.254 2.519-2.799 2.519h-5.596c-1.546 0-2.799-1.127-2.799-2.519 0-1.39 1.253-2.518 2.799-2.518h5.596c1.545 0 2.799 1.128 2.799 2.518"/&gt;&lt;path d="m62.11 7.748c0-1.458-.134-3.888-1.324-3.888h-21.546c-1.113 0-1.38 2.44-1.362 3.883l24.23.005"/&gt;&lt;path d="m67.31 12.798c0-2.084-.191-5.556-1.891-5.556h-30.78c-1.592 0-1.972 3.488-1.947 5.549l34.618.007"/&gt;&lt;/g&gt;&lt;/g&gt;&lt;path d="m4.605 7.172v-.697h-2.271-2.271v-1.17-1.17h2.271 2.271l.004-.695.004-.695 1.549 1.279c1.197.989 1.34 1.151 1.528 1.306-.024.032-3.061 2.539-3.076 2.539-.005 0-.01-.314-.01-.697z" stroke="#0000bf" stroke-width=".045" fill="#3a88ff"/&gt;&lt;/g&gt;&lt;g id="single_switch_state_5"&gt;&lt;g transform="matrix(.17857 0 0 .17857-39.821-71.43)"&gt;&lt;path d="m278 446c0 4.971-4.03 9-9 9h-36c-4.971 0-9-4.03-9-9v-36c0-4.971 4.03-9 9-9h36c4.971 0 9 4.03 9 9v36" fill="#f9f9f9"/&gt;&lt;path d="m278 446c0 4.971-4.03 9-9 9h-36c-4.971 0-9-4.03-9-9v-36c0-4.971 4.03-9 9-9h36c4.971 0 9 4.03 9 9v36z" stroke-miterlimit="10" fill="none" stroke="#f8c500" stroke-width="2"/&gt;&lt;path d="m267 446c0 1.104-.896 2-2 2h-29c-1.104 0-2-.896-2-2v-27c0-1.104.896-2 2-2h29c1.104 0 2 .896 2 2v27" fill="#a0a0a0"/&gt;&lt;/g&gt;&lt;g opacity=".09"&gt;&lt;path d="m267 446c0 1.104-.896 2-2 2h-29c-1.104 0-2-.896-2-2v-21c0-1.104.896-2 2-2h29c1.104 0 2 .896 2 2v21" fill="#fff" transform="matrix(.17857 0 0 .17857-39.821-71.43)"/&gt;&lt;/g&gt;&lt;g transform="matrix(.17857 0 0 .17857-39.821-71.43)" fill="none" stroke="#919191" stroke-miterlimit="10"&gt;&lt;path d="m248.27 411.16c1.63-1.63 4.272-1.629 5.901.001"/&gt;&lt;path d="m249.6 412.81c.869-.869 2.276-.868 3.146 0"/&gt;&lt;path d="m246.4 409.06c2.495-2.495 6.603-2.431 9.176.142"/&gt;&lt;/g&gt;&lt;path fill="#f9f9f9" d="m2.679 3.571h4.286v4.643h-4.286z"/&gt;&lt;path fill="#f8c500" d="m3.036 5.893h3.75v2.143h-3.75z"/&gt;&lt;/g&gt;&lt;g id="single_switch_state_7"&gt;&lt;g transform="matrix(.17857 0 0 .17857-53.57-71.07)"&gt;&lt;path d="m355 444c0 4.971-4.03 9-9 9h-36c-4.971 0-9-4.03-9-9v-36c0-4.971 4.03-9 9-9h36c4.971 0 9 4.03 9 9v36" fill="#f9f9f9"/&gt;&lt;path d="m355 444c0 4.971-4.03 9-9 9h-36c-4.971 0-9-4.03-9-9v-36c0-4.971 4.03-9 9-9h36c4.971 0 9 4.03 9 9v36z" stroke-miterlimit="10" fill="none" stroke="#f8c500" stroke-width="2"/&gt;&lt;path d="m344 444c0 1.104-.896 2-2 2h-28c-1.104 0-2-.896-2-2v-26c0-1.104.896-2 2-2h28c1.104 0 2 .896 2 2v26" fill="#a0a0a0"/&gt;&lt;/g&gt;&lt;g opacity=".09"&gt;&lt;path d="m344 444c0 1.104-.896 2-2 2h-28c-1.104 0-2-.896-2-2v-20c0-1.104.896-2 2-2h28c1.104 0 2 .896 2 2v20" fill="#fff" transform="matrix(.17857 0 0 .17857-53.57-71.07)"/&gt;&lt;/g&gt;&lt;g transform="matrix(.17857 0 0 .17857-53.57-71.07)" fill="none" stroke="#919191" stroke-miterlimit="10"&gt;&lt;path d="m324.81 409.02c1.572-1.572 4.123-1.571 5.695.001"/&gt;&lt;path d="m326.09 410.61c.839-.838 2.197-.837 3.036.001"/&gt;&lt;path d="m323 407c2.408-2.408 6.372-2.347 8.854.137"/&gt;&lt;/g&gt;&lt;path fill="#f9f9f9" d="m2.857 3.75h4.107v4.464h-4.107z"/&gt;&lt;path fill="#f8c500" d="m3.214 3.929h3.571v2.143h-3.571z"/&gt;&lt;/g&gt;&lt;g id="smartplug_state_off"&gt;&lt;g transform="matrix(.18519 0 0 .18519-52.963-162.96)"&gt;&lt;path d="m339 924c0 4.971-4.03 9-9 9h-34c-4.971 0-9-4.03-9-9v-34c0-4.971 4.03-9 9-9h34c4.971 0 9 4.03 9 9v34" fill="#f9f9f9"/&gt;&lt;path d="m339 924c0 4.971-4.03 9-9 9h-34c-4.971 0-9-4.03-9-9v-34c0-4.971 4.03-9 9-9h34c4.971 0 9 4.03 9 9v34z" stroke="#f8c500" stroke-width="2" fill="none" stroke-miterlimit="10"/&gt;&lt;/g&gt;&lt;g transform="translate(-.709-.398)"&gt;&lt;circle r="10.38" cy="909.15" cx="316.83" transform="matrix(.18519 0 0 .18519-52.963-162.96)" fill="#fff" stroke="#545454" stroke-width=".5"/&gt;&lt;path d="m6.01 4.384c0 .172-.139.31-.31.31-.171 0-.31-.139-.31-.31 0-.171.139-.31.31-.31.171 0 .31.139.31.31" fill="#999"/&gt;&lt;g transform="matrix(.18519 0 0 .18519-52.963-162.96)" fill="#605f5f"&gt;&lt;circle r="1.393" cy="910.08" cx="322.96"/&gt;&lt;circle r="1.392" cy="910.08" cx="310.63"/&gt;&lt;/g&gt;&lt;/g&gt;&lt;path stroke-miterlimit="10" d="m1.346 1.989h1.296" fill="none" stroke="#605f5f" stroke-width=".37"/&gt;&lt;/g&gt;&lt;g id="smartplug_state_on"&gt;&lt;path d="m9.821 8.151c0 .921-.746 1.667-1.667 1.667h-6.296c-.921 0-1.667-.746-1.667-1.667v-6.296c0-.921.746-1.667 1.667-1.667h6.296c.921 0 1.667.746 1.667 1.667v6.296" fill="#f9f9f9"/&gt;&lt;g stroke-miterlimit="10"&gt;&lt;path d="m480 925c0 4.971-4.03 9-9 9h-34c-4.971 0-9-4.03-9-9v-34c0-4.971 4.03-9 9-9h34c4.971 0 9 4.03 9 9v34z" fill="none" stroke="#f8c500" stroke-width="2" transform="matrix(.18519 0 0 .18519-79.07-163.15)"/&gt;&lt;/g&gt;&lt;g transform="translate(.031.343)"&gt;&lt;circle cx="453.83" cy="906.15" r="10.38" transform="matrix(.18519 0 0 .18519-79.07-163.15)" fill="#fff" stroke="#545454" stroke-width=".5" stroke-miterlimit="10"/&gt;&lt;path d="m5.266 3.643c0 .172-.139.31-.31.31-.171 0-.31-.139-.31-.31 0-.171.139-.31.31-.31.171 0 .31.139.31.31" fill="#999"/&gt;&lt;g transform="matrix(.18519 0 0 .18519-79.07-163.15)" fill="#605f5f"&gt;&lt;circle cx="459.96" cy="907.08" r="1.393"/&gt;&lt;circle cx="447.63" cy="907.08" r="1.392"/&gt;&lt;/g&gt;&lt;/g&gt;&lt;circle r="6.397" stroke-miterlimit="10" cy="891.73" cx="437.73" transform="matrix(.18519 0 0 .18519-79.07-163.15)" fill="#f8c500"/&gt;&lt;/g&gt;&lt;g id="smartplug_type"&gt;&lt;circle stroke-width=".5" cx="453.83" cy="906.15" transform="matrix(.18519 0 0 .18519-79.07-163.15)" stroke="#545454" stroke-miterlimit="10" r="10.38" fill="#fff"/&gt;&lt;path d="m5.266 3.643c0 .172-.139.31-.31.31-.171 0-.31-.139-.31-.31 0-.171.139-.31.31-.31.171 0 .31.139.31.31" fill="#999"/&gt;&lt;g fill="#605f5f" transform="matrix(.18519 0 0 .18519-79.07-163.15)"&gt;&lt;circle cx="459.96" cy="907.08" r="1.393"/&gt;&lt;circle cx="447.63" cy="907.08" r="1.392"/&gt;&lt;/g&gt;&lt;/g&gt;&lt;g id="switch_state_1"&gt;&lt;g transform="matrix(.17857 0 0 .17857-63.75-86.79)"&gt;&lt;path d="m412 532c0 4.971-4.03 9-9 9h-36c-4.971 0-9-4.03-9-9v-36c0-4.971 4.03-9 9-9h36c4.971 0 9 4.03 9 9v36" fill="#f9f9f9"/&gt;&lt;path d="m412 532c0 4.971-4.03 9-9 9h-36c-4.971 0-9-4.03-9-9v-36c0-4.971 4.03-9 9-9h36c4.971 0 9 4.03 9 9v36z" stroke="#f8c500" stroke-miterlimit="10" stroke-width="2" fill="none"/&gt;&lt;path d="m401 532c0 1.104-.896 2-2 2h-28c-1.104 0-2-.896-2-2v-27c0-1.104.896-2 2-2h28c1.104 0 2 .896 2 2v27" fill="#a0a0a0"/&gt;&lt;/g&gt;&lt;g opacity=".09"&gt;&lt;path d="m401 532c0 1.104-.896 2-2 2h-28c-1.104 0-2-.896-2-2v-21c0-1.104.896-2 2-2h28c1.104 0 2 .896 2 2v21" fill="#fff" transform="matrix(.17857 0 0 .17857-63.75-86.79)"/&gt;&lt;/g&gt;&lt;g fill="#f9f9f9"&gt;&lt;path d="m3.036 3.393h2.143v4.821h-2.143z"/&gt;&lt;path d="m5.179 3.393h1.786v4.821h-1.786z"/&gt;&lt;/g&gt;&lt;g stroke="#919191" fill="none" stroke-miterlimit="10" transform="matrix(.17857 0 0 .17857-63.75-86.79)"&gt;&lt;path d="m382.69 497.91c1.525-1.525 3.999-1.524 5.524.001"/&gt;&lt;path d="m383.94 499.45c.814-.813 2.132-.812 2.945.001"/&gt;&lt;path d="m380.94 495.95c2.336-2.336 6.182-2.276 8.59.133"/&gt;&lt;/g&gt;&lt;path fill="#fff" d="m3.036 3.393h1.964v4.821h-1.964z"/&gt;&lt;path fill="#1e1e1e" d="m5 3.393h1.964v4.821h-1.964z"/&gt;&lt;path stroke-width=".179" stroke="#605f5f" stroke-miterlimit="10" fill="none" d="m5.089 3.393v4.821"/&gt;&lt;path fill="#f8c500" d="m3.214 3.571h1.607v1.786h-1.607z"/&gt;&lt;/g&gt;&lt;g id="switch_state_3"&gt;&lt;g transform="matrix(.17857 0 0 .17857-89.29-87.32)"&gt;&lt;path d="m555 535c0 4.971-4.03 9-9 9h-36c-4.971 0-9-4.03-9-9v-36c0-4.971 4.03-9 9-9h36c4.971 0 9 4.03 9 9v36" fill="#f9f9f9"/&gt;&lt;path d="m555 535c0 4.971-4.03 9-9 9h-36c-4.971 0-9-4.03-9-9v-36c0-4.971 4.03-9 9-9h36c4.971 0 9 4.03 9 9v36z" stroke="#f8c500" stroke-miterlimit="10" stroke-width="2" fill="none"/&gt;&lt;path d="m543 534c0 1.104-.896 2-2 2h-27c-1.104 0-2-.896-2-2v-25c0-1.104.896-2 2-2h27c1.104 0 2 .896 2 2v25" fill="#a0a0a0"/&gt;&lt;/g&gt;&lt;g opacity=".09"&gt;&lt;path d="m543 534c0 1.104-.896 2-2 2h-27c-1.104 0-2-.896-2-2v-19c0-1.104.896-2 2-2h27c1.104 0 2 .896 2 2v19" fill="#fff" transform="matrix(.17857 0 0 .17857-89.29-87.32)"/&gt;&lt;/g&gt;&lt;g fill="#f9f9f9"&gt;&lt;path d="m2.857 3.75h2.143v4.286h-2.143z"/&gt;&lt;path d="m5 3.75h1.964v4.286h-1.964z"/&gt;&lt;/g&gt;&lt;g stroke="#919191" fill="none" stroke-miterlimit="10" transform="matrix(.17857 0 0 .17857-89.29-87.32)"&gt;&lt;path d="m524.6 501.88c1.462-1.463 3.833-1.462 5.294.001"/&gt;&lt;path d="m525.79 503.36c.779-.779 2.042-.778 2.821.001"/&gt;&lt;path d="m522.92 500.01c2.238-2.239 5.923-2.182 8.231.126"/&gt;&lt;/g&gt;&lt;path fill="#fff" d="m2.857 3.75h1.964v4.286h-1.964z"/&gt;&lt;path fill="#1e1e1e" d="m4.821 3.75h2.143v4.286h-2.143z"/&gt;&lt;path stroke-width=".179" stroke="#605f5f" stroke-miterlimit="10" fill="none" d="m4.911 3.75v4.286"/&gt;&lt;path fill="#f8c500" d="m3.036 6.071h1.607v1.786h-1.607z"/&gt;&lt;/g&gt;&lt;g id="switch_state_5"&gt;&lt;g transform="matrix(.17857 0 0 .17857-36.964-86.25)"&gt;&lt;path d="m262 529c0 4.971-4.03 9-9 9h-36c-4.971 0-9-4.03-9-9v-36c0-4.971 4.03-9 9-9h36c4.971 0 9 4.03 9 9v36" fill="#f9f9f9"/&gt;&lt;path d="m262 529c0 4.971-4.03 9-9 9h-36c-4.971 0-9-4.03-9-9v-36c0-4.971 4.03-9 9-9h36c4.971 0 9 4.03 9 9v36z" stroke="#f8c500" stroke-miterlimit="10" stroke-width="2" fill="none"/&gt;&lt;path d="m251 528c0 1.104-.896 2-2 2h-28c-1.104 0-2-.896-2-2v-26c0-1.104.896-2 2-2h28c1.104 0 2 .896 2 2v26" fill="#a0a0a0"/&gt;&lt;/g&gt;&lt;g opacity=".09"&gt;&lt;path d="m251 528c0 1.104-.896 2-2 2h-28c-1.104 0-2-.896-2-2v-20c0-1.104.896-2 2-2h28c1.104 0 2 .896 2 2v20" fill="#fff" transform="matrix(.17857 0 0 .17857-36.964-86.25)"/&gt;&lt;/g&gt;&lt;g fill="#f9f9f9"&gt;&lt;path d="m3.036 3.393h1.964v4.464h-1.964z"/&gt;&lt;path d="m5 3.393h1.964v4.464h-1.964z"/&gt;&lt;/g&gt;&lt;g stroke="#919191" fill="none" stroke-miterlimit="10" transform="matrix(.17857 0 0 .17857-36.964-86.25)"&gt;&lt;path d="m232.65 495.86c1.507-1.507 3.951-1.506 5.457.001"/&gt;&lt;path d="m233.88 497.39c.804-.804 2.105-.803 2.909.001"/&gt;&lt;path d="m230.92 493.93c2.308-2.307 6.106-2.248 8.485.131"/&gt;&lt;/g&gt;&lt;path fill="#fff" d="m3.036 3.393h1.964v4.464h-1.964z"/&gt;&lt;path fill="#1e1e1e" d="m5 3.393h1.964v4.464h-1.964z"/&gt;&lt;path stroke-width=".179" stroke="#605f5f" stroke-miterlimit="10" fill="none" d="m5.089 3.393v4.464"/&gt;&lt;path fill="#f8c500" d="m5.357 3.571h1.429v1.964h-1.429z"/&gt;&lt;/g&gt;&lt;g id="switch_state_7"&gt;&lt;g transform="matrix(.17857 0 0 .17857-65.36-101.43)"&gt;&lt;path d="m421 614c0 4.971-4.03 9-9 9h-36c-4.971 0-9-4.03-9-9v-36c0-4.971 4.03-9 9-9h36c4.971 0 9 4.03 9 9v36" fill="#f9f9f9"/&gt;&lt;path d="m421 614c0 4.971-4.03 9-9 9h-36c-4.971 0-9-4.03-9-9v-36c0-4.971 4.03-9 9-9h36c4.971 0 9 4.03 9 9v36z" stroke="#f8c500" stroke-miterlimit="10" stroke-width="2" fill="none"/&gt;&lt;path d="m409 611c0 1.104-.896 2-2 2h-28c-1.104 0-2-.896-2-2v-26c0-1.104.896-2 2-2h28c1.104 0 2 .896 2 2v26" fill="#a0a0a0"/&gt;&lt;/g&gt;&lt;g opacity=".09"&gt;&lt;path d="m409 611c0 1.104-.896 2-2 2h-28c-1.104 0-2-.896-2-2v-20c0-1.104.896-2 2-2h28c1.104 0 2 .896 2 2v20" fill="#fff" transform="matrix(.17857 0 0 .17857-65.36-101.43)"/&gt;&lt;/g&gt;&lt;g fill="#f9f9f9"&gt;&lt;path d="m2.857 3.036h2.143v4.643h-2.143z"/&gt;&lt;path d="m5 3.036h1.964v4.643h-1.964z"/&gt;&lt;/g&gt;&lt;g stroke="#919191" fill="none" stroke-miterlimit="10" transform="matrix(.17857 0 0 .17857-65.36-101.43)"&gt;&lt;path d="m390.3 577.68c1.801-1.8 4.721-1.799 6.521.001"/&gt;&lt;path d="m391.77 579.51c.96-.96 2.515-.96 3.476.001"/&gt;&lt;path d="m388.23 575.37c2.756-2.757 7.296-2.687 10.139.156"/&gt;&lt;/g&gt;&lt;path fill="#fff" d="m2.857 3.036h1.964v4.643h-1.964z"/&gt;&lt;path fill="#1e1e1e" d="m4.821 3.036h2.143v4.643h-2.143z"/&gt;&lt;path stroke-width=".179" stroke="#605f5f" stroke-miterlimit="10" fill="none" d="m4.911 3.036v4.643"/&gt;&lt;path fill="#f8c500" d="m5.179 5.357h1.429v2.143h-1.429z"/&gt;&lt;/g&gt;&lt;g id="switch_type"&gt;&lt;path d="m106 524c0 1.104-.896 2-2 2h-28c-1.104 0-2-.896-2-2v-26c0-1.104.896-2 2-2h28c1.104 0 2 .896 2 2v26" fill="#a0a0a0" transform="matrix(.17857 0 0 .17857-11.07-86.25)"/&gt;&lt;g opacity=".09"&gt;&lt;path d="m106 524c0 1.104-.896 2-2 2h-28c-1.104 0-2-.896-2-2v-20c0-1.104.896-2 2-2h28c1.104 0 2 .896 2 2v20" fill="#fff" transform="matrix(.17857 0 0 .17857-11.07-86.25)"/&gt;&lt;/g&gt;&lt;g fill="#fff"&gt;&lt;path d="m3.036 2.857h1.964v4.464h-1.964z"/&gt;&lt;path d="m5 2.857h1.964v4.464h-1.964z"/&gt;&lt;/g&gt;&lt;/g&gt;&lt;g id="temperature_state_off"&gt;&lt;text font-size="1.866" x="3.621" y="9.216" fill="#605f5f" font-family="GravurCondensed-Regular"&gt;45%&lt;/text&gt;&lt;g transform="matrix(.17241 0 0 .17241-24.483-14.31)"&gt;&lt;path d="m199 131c0 4.971-4.03 9-9 9h-38c-4.971 0-9-4.03-9-9v-38c0-4.971 4.03-9 9-9h38c4.971 0 9 4.03 9 9v38" fill="#f9f9f9"/&gt;&lt;path stroke-miterlimit="10" d="m199 131c0 4.971-4.03 9-9 9h-38c-4.971 0-9-4.03-9-9v-38c0-4.971 4.03-9 9-9h38c4.971 0 9 4.03 9 9v38z" fill="none" stroke="#f8c500" stroke-width="2"/&gt;&lt;/g&gt;&lt;g transform="translate(.135.846)"&gt;&lt;path d="m5.446 4.768v-2.39c0-.321-.261-.581-.581-.581-.321 0-.581.261-.581.581v2.39c-.242.181-.387.466-.387.775 0 .534.434.969.969.969.534 0 .969-.435.969-.969 0-.31-.145-.594-.387-.775m-.581 1.486c-.392 0-.711-.318-.711-.711 0-.276.157-.515.388-.633v-2.532c0-.178.144-.323.323-.323.178 0 .323.144.323.323v2.532c.23.118.388.357.388.633 0 .392-.318.711-.711.711" fill="#605f5f"/&gt;&lt;path d="m5.05 5.05v-1.544h-.367v1.544c-.202.075-.346.269-.346.497 0 .293.237.53.53.53.292 0 .53-.237.53-.53 0-.228-.144-.422-.346-.497" fill="#b3b3b3"/&gt;&lt;/g&gt;&lt;path stroke-miterlimit="10" d="m1.346 1.989h1.296" fill="none" stroke="#605f5f" stroke-width=".37"/&gt;&lt;/g&gt;&lt;g id="temperature_state_on"&gt;&lt;text font-size="1.866" x="3.621" y="9.216" fill="#605f5f" font-family="GravurCondensed-Regular"&gt;45%&lt;/text&gt;&lt;g transform="matrix(.17241 0 0 .17241-24.483-14.31)"&gt;&lt;path d="m199 131c0 4.971-4.03 9-9 9h-38c-4.971 0-9-4.03-9-9v-38c0-4.971 4.03-9 9-9h38c4.971 0 9 4.03 9 9v38" fill="#f9f9f9"/&gt;&lt;path stroke-miterlimit="10" d="m199 131c0 4.971-4.03 9-9 9h-38c-4.971 0-9-4.03-9-9v-38c0-4.971 4.03-9 9-9h38c4.971 0 9 4.03 9 9v38z" fill="none" stroke="#f8c500" stroke-width="2"/&gt;&lt;/g&gt;&lt;g transform="translate(.135.846)"&gt;&lt;path d="m5.446 4.768v-2.39c0-.321-.261-.581-.581-.581-.321 0-.581.261-.581.581v2.39c-.242.181-.387.466-.387.775 0 .534.434.969.969.969.534 0 .969-.435.969-.969 0-.31-.145-.594-.387-.775m-.581 1.486c-.392 0-.711-.318-.711-.711 0-.276.157-.515.388-.633v-2.532c0-.178.144-.323.323-.323.178 0 .323.144.323.323v2.532c.23.118.388.357.388.633 0 .392-.318.711-.711.711" fill="#605f5f"/&gt;&lt;path d="m5.05 5.05v-1.544h-.367v1.544c-.202.075-.346.269-.346.497 0 .293.237.53.53.53.292 0 .53-.237.53-.53 0-.228-.144-.422-.346-.497" fill="#f8c500"/&gt;&lt;/g&gt;&lt;circle r="6.397" stroke-miterlimit="10" cy="891.73" cx="437.73" transform="matrix(.18519 0 0 .18519-79.07-163.15)" fill="#f8c500"/&gt;&lt;/g&gt;&lt;g id="temperature_type"&gt;&lt;path d="m5.806 5.457v-2.945c0-.395-.321-.716-.716-.716-.395 0-.716.321-.716.716v2.945c-.298.223-.477.573-.477.955 0 .658.535 1.194 1.194 1.194s1.194-.535 1.194-1.194c0-.381-.179-.732-.477-.955m-.716 1.83c-.483 0-.875-.392-.875-.875 0-.34.194-.635.477-.78v-3.12c0-.22.178-.398.398-.398s.398.178.398.398v3.12c.283.145.477.439.477.78 0 .483-.392.875-.875.875" fill="#605f5f"/&gt;&lt;/g&gt;&lt;g id="user"&gt;&lt;path d="m4.291 2.353c1.281 0 2.319-1.301 2.319-2.906 0-1.605-1.038-2.906-2.319-2.906s-2.319 1.301-2.319 2.906c0 1.605 1.038 2.906 2.319 2.906-2.647 0-4.814 1.847-5 4.188h10c-.186-2.341-2.353-4.188-5-4.188"/&gt;&lt;/g&gt;&lt;g id="write"&gt;&lt;g transform="matrix(.10837 0 0 .1001-1.279.022)"&gt;&lt;path d="m81.902 11.08h-63.813c-3.478 0-6.288 2.936-6.288 6.561v75.47c0 3.625 2.811 6.562 6.288 6.562h63.813c3.477 0 6.29-2.938 6.29-6.562v-75.47c0-3.624-2.813-6.561-6.29-6.561m.755 79.01s.173 1.517-.537 2.303c-.721.8-2.055.691-2.055.691l-60.709.032s-.856-.013-1.509-.762c-.564-.646-.557-2.02-.557-2.02l.022-70.43s0-1.043.611-1.6c.659-.602 1.612-.653 1.612-.653h60.721s1.151-.032 1.689.519c.732.749.71 1.536.71 1.536v70.38z"/&gt;&lt;path d="m37.19 32.05h35.439v3.151h-35.439z"/&gt;&lt;path d="m26.04 43.29v7.874h7.876v-7.874h-7.876m1.18 6.682v-5.51h5.514v5.51h-5.514"/&gt;&lt;path d="m37.19 47.01h35.439v3.15h-35.439z"/&gt;&lt;path d="m37.19 61.36h35.439v3.15h-35.439z"/&gt;&lt;path d="m37.19 75.36h35.439v3.149h-35.439z"/&gt;&lt;path d="m26.04 28.324v7.875h7.876v-7.875h-7.876m1.18 6.682v-5.509h5.514v5.509h-5.514"/&gt;&lt;path d="m26.04 57.636v7.874h7.876v-7.874h-7.876m1.18 6.682v-5.511h5.514v5.511h-5.514"/&gt;&lt;path d="m26.04 71.64v7.874h7.876v-7.874h-7.876m1.18 6.681v-5.51h5.514v5.51h-5.514"/&gt;&lt;g&gt;&lt;path d="m55.722 2.298c0 1.392-1.254 2.519-2.799 2.519h-5.596c-1.546 0-2.799-1.127-2.799-2.519 0-1.39 1.253-2.518 2.799-2.518h5.596c1.545 0 2.799 1.128 2.799 2.518"/&gt;&lt;path d="m62.11 7.748c0-1.458-.134-3.888-1.324-3.888h-21.546c-1.113 0-1.38 2.44-1.362 3.883l24.23.005"/&gt;&lt;path d="m67.31 12.798c0-2.084-.191-5.556-1.891-5.556h-30.78c-1.592 0-1.972 3.488-1.947 5.549l34.618.007"/&gt;&lt;/g&gt;&lt;/g&gt;&lt;path d="m6.852 7.172v-.697h-2.271-2.271v-1.17-1.17h2.271 2.271l.004-.695.004-.695 1.549 1.279c1.197.989 1.34 1.151 1.528 1.306-.024.032-3.061 2.539-3.076 2.539-.005 0-.01-.314-.01-.697z" stroke="#0000bf" stroke-width=".045" fill="#3a88ff"/&gt;&lt;/g&gt;&lt;/defs&gt;&lt;/svg&gt;'</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>Inline include of theme config files</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> THEMES_BASIC = {
    	<span class="hljs-string">"font"</span>: {
    		<span class="hljs-string">"color"</span>: <span class="hljs-string">"rgba(76, 76, 76, 1)"</span>
    	},
    	<span class="hljs-string">"dashboard"</span>: {
    		<span class="hljs-string">"width"</span>: <span class="hljs-number">960</span>,
    		<span class="hljs-string">"widget"</span>: {
    			<span class="hljs-string">"height"</span>: <span class="hljs-number">30</span>,
    			<span class="hljs-string">"margin"</span>: {
    				<span class="hljs-string">"top"</span>: <span class="hljs-number">0</span>,
    				<span class="hljs-string">"left"</span>: <span class="hljs-number">0</span>,
    				<span class="hljs-string">"bottom"</span>: <span class="hljs-number">0</span>,
    				<span class="hljs-string">"right"</span>: <span class="hljs-number">0</span>
    			}
    		},
    		<span class="hljs-string">"group"</span>: {
    			<span class="hljs-string">"height"</span>: <span class="hljs-number">30</span>,
    			<span class="hljs-string">"margin"</span>: {
    				<span class="hljs-string">"top"</span>: <span class="hljs-number">20</span>,
    				<span class="hljs-string">"left"</span>: <span class="hljs-number">0</span>,
    				<span class="hljs-string">"bottom"</span>: <span class="hljs-number">0</span>,
    				<span class="hljs-string">"right"</span>: <span class="hljs-number">0</span>
    			},
    			<span class="hljs-string">"header"</span>: {
    				<span class="hljs-string">"fill"</span>: {
    					<span class="hljs-string">"color"</span>: <span class="hljs-string">"transparent"</span>
    				}
    			},
    			<span class="hljs-string">"container"</span>: {
    				<span class="hljs-string">"padding"</span>: {
    					<span class="hljs-string">"top"</span>: <span class="hljs-number">10</span>,
    					<span class="hljs-string">"bottom"</span>: <span class="hljs-number">10</span>
    				},
    				<span class="hljs-string">"margin"</span>: {
    					<span class="hljs-string">"top"</span>: <span class="hljs-number">30</span>,
    					<span class="hljs-string">"bottom"</span>: <span class="hljs-number">10</span>
    				}
    			}
    		},
    		<span class="hljs-string">"sidebar"</span>: {
    			<span class="hljs-string">"width"</span>: <span class="hljs-number">250</span>,
    			<span class="hljs-string">"menu"</span>: {
    				<span class="hljs-string">"width"</span>: <span class="hljs-number">25</span>
    			}
    		},
    		<span class="hljs-string">"aside"</span>: {
    			<span class="hljs-string">"padding"</span>: {
    				<span class="hljs-string">"left"</span>: <span class="hljs-number">5</span>,
    				<span class="hljs-string">"right"</span>: <span class="hljs-number">5</span>
    			}
    		}
    	},
    	<span class="hljs-string">"element"</span>: {
    		<span class="hljs-string">"odd"</span>: {
    			<span class="hljs-string">"fill"</span>: {
    				<span class="hljs-string">"color"</span>: <span class="hljs-string">"#f6f6f6"</span>
    			}
    		},
    		<span class="hljs-string">"even"</span>: {
    			<span class="hljs-string">"fill"</span>: {
    				<span class="hljs-string">"color"</span>: <span class="hljs-string">"#fafafa"</span>
    			}
    		},
    		<span class="hljs-string">"active"</span>: {
    			<span class="hljs-string">"opacity"</span>: <span class="hljs-number">1</span>
    		},
    		<span class="hljs-string">"inactive"</span>: {
    			<span class="hljs-string">"opacity"</span>: <span class="hljs-number">0.1</span>
    		},
    		<span class="hljs-string">"title"</span>: {
    			<span class="hljs-string">"padding"</span>: {
    				<span class="hljs-string">"left"</span>: <span class="hljs-number">10</span>
    			}
    		}
    	},
    	<span class="hljs-string">"pictogram"</span>: {
    		<span class="hljs-string">"scale"</span>: <span class="hljs-number">1.2</span>,
    		<span class="hljs-string">"dimension"</span>: {
    			<span class="hljs-string">"height"</span>: <span class="hljs-number">10</span>
    		}
    	},
    	<span class="hljs-string">"device"</span>: {
    		<span class="hljs-string">"state"</span>: {
    			<span class="hljs-string">"border"</span>: {
    				<span class="hljs-string">"width"</span>: <span class="hljs-number">2</span>,
    				<span class="hljs-string">"color"</span>: <span class="hljs-string">"rgba(154, 207, 7, 0.8)"</span>,
    				<span class="hljs-string">"focused"</span>: {
    					<span class="hljs-string">"width"</span>: <span class="hljs-number">4</span>,
    					<span class="hljs-string">"color"</span>: <span class="hljs-string">"rgba(154, 207, 7, 1)"</span>
    				}
    			},
    			<span class="hljs-string">"fill"</span>: {
    				<span class="hljs-string">"color"</span>: <span class="hljs-string">"rgba(154, 207, 7, 0.2)"</span>
    			},
    			<span class="hljs-string">"focused"</span>: {
    				<span class="hljs-string">"fill"</span>: {
    					<span class="hljs-string">"color"</span>: <span class="hljs-string">"rgba(154, 207, 7, 0.5)"</span>
    				}
    			}
    		},
    		<span class="hljs-string">"value"</span>: {
    			<span class="hljs-string">"border"</span>: {
    				<span class="hljs-string">"width"</span>: <span class="hljs-number">2</span>,
    				<span class="hljs-string">"color"</span>: <span class="hljs-string">"rgba(41, 81, 109, 0.8)"</span>,
    				<span class="hljs-string">"focused"</span>: {
    					<span class="hljs-string">"color"</span>: <span class="hljs-string">"rgba(154, 207, 7, 1)"</span>
    				}
    			},
    			<span class="hljs-string">"fill"</span>: {
    				<span class="hljs-string">"color"</span>: <span class="hljs-string">"rgba(41, 81, 109, 0.2)"</span>
    			},
    			<span class="hljs-string">"focused"</span>: {
    				<span class="hljs-string">"fill"</span>: {
    					<span class="hljs-string">"color"</span>: <span class="hljs-string">"rgba(41, 81, 109, 0.5)"</span>
    				}
    			}
    		}
    	},
    	<span class="hljs-string">"program"</span>: {
    		<span class="hljs-string">"state"</span>: {
    			<span class="hljs-string">"height"</span>: <span class="hljs-number">15</span>,
    			<span class="hljs-string">"radius"</span>: {
    				<span class="hljs-string">"x"</span>: <span class="hljs-number">5</span>,
    				<span class="hljs-string">"y"</span>: <span class="hljs-number">5</span>
    			},
    			<span class="hljs-string">"disabled"</span>: {
    				<span class="hljs-string">"color"</span>: <span class="hljs-string">"rgba(105, 105, 105, 0.3)"</span>,
    				<span class="hljs-string">"focused"</span>: {
    					<span class="hljs-string">"color"</span>: <span class="hljs-string">"rgba(105, 105, 105, 0.6)"</span>
    				}
    			},
    			<span class="hljs-string">"enabled"</span>: {
    				<span class="hljs-string">"color"</span>: <span class="hljs-string">"rgba(154, 207, 7, 0.3)"</span>,
    				<span class="hljs-string">"focused"</span>: {
    					<span class="hljs-string">"color"</span>: <span class="hljs-string">"rgba(154, 207, 7, 0.6)"</span>
    				}
    			},
    			<span class="hljs-string">"invalid"</span>: {
    				<span class="hljs-string">"color"</span>: <span class="hljs-string">"rgba(207, 60, 0, 0.3)"</span>,
    				<span class="hljs-string">"focused"</span>: {
    					<span class="hljs-string">"color"</span>: <span class="hljs-string">"rgba(207, 60, 0, 0.6)"</span>
    				}
    			}
    		}
    	},
    	<span class="hljs-string">"status"</span>: {
    		<span class="hljs-string">"border"</span>: {
    			<span class="hljs-string">"width"</span>: <span class="hljs-number">2</span>
    		},
    		<span class="hljs-string">"connection"</span>: {
    			<span class="hljs-string">"border"</span>: {
    				<span class="hljs-string">"color"</span>: <span class="hljs-string">"rgba(154, 207, 7, 0.8)"</span>
    			},
    			<span class="hljs-string">"focused"</span>: {
    				<span class="hljs-string">"border"</span>: {
    					<span class="hljs-string">"color"</span>: <span class="hljs-string">"rgba(154, 207, 7, 1)"</span>
    				}
    			}
    		},
    		<span class="hljs-string">"problem"</span>: {
    			<span class="hljs-string">"border"</span>: {
    				<span class="hljs-string">"color"</span>: <span class="hljs-string">"rgba(206, 96, 39, 0.80)"</span>
    			},
    			<span class="hljs-string">"focused"</span>: {
    				<span class="hljs-string">"border"</span>: {
    					<span class="hljs-string">"color"</span>: <span class="hljs-string">"rgba(206, 96, 39, 1)"</span>
    				}
    			}
    		},
    		<span class="hljs-string">"disconnection"</span>: {
    			<span class="hljs-string">"border"</span>: {
    				<span class="hljs-string">"color"</span>: <span class="hljs-string">"rgba(206, 66, 66, 0.80)"</span>
    			},
    			<span class="hljs-string">"focused"</span>: {
    				<span class="hljs-string">"border"</span>: {
    					<span class="hljs-string">"color"</span>: <span class="hljs-string">"rgba(206, 66, 66, 1)"</span>
    				}
    			}
    		}
    	},
    	<span class="hljs-string">"ruler"</span>: {
    		<span class="hljs-string">"width"</span>: <span class="hljs-number">5</span>,
    		<span class="hljs-string">"fill"</span>: {
    			<span class="hljs-string">"color"</span>: <span class="hljs-string">"#e0e0e0"</span>
    		},
    		<span class="hljs-string">"border"</span>: {
    			<span class="hljs-string">"width"</span>: <span class="hljs-number">2</span>,
    			<span class="hljs-string">"color"</span>: <span class="hljs-string">"transparent"</span>
    		},
    		<span class="hljs-string">"line"</span>: {
    			<span class="hljs-string">"width"</span>: <span class="hljs-number">1</span>,
    			<span class="hljs-string">"left"</span>: <span class="hljs-number">2</span>,
    			<span class="hljs-string">"fill"</span>: {
    				<span class="hljs-string">"color"</span>: <span class="hljs-string">"#696969"</span>
    			}
    		},
    		<span class="hljs-string">"lookahead"</span>: <span class="hljs-number">2</span>
    	},
    	<span class="hljs-string">"focusline"</span>: {
    		<span class="hljs-string">"height"</span>: <span class="hljs-number">80</span>,
    		<span class="hljs-string">"margin"</span>: {
    			<span class="hljs-string">"top"</span>: <span class="hljs-number">10</span>,
    			<span class="hljs-string">"left"</span>: <span class="hljs-number">0</span>,
    			<span class="hljs-string">"bottom"</span>: <span class="hljs-number">10</span>,
    			<span class="hljs-string">"right"</span>: <span class="hljs-number">0</span>
    		},
    		<span class="hljs-string">"fill"</span>: {
    			<span class="hljs-string">"color"</span>: <span class="hljs-string">"transparent"</span>
    		},
    		<span class="hljs-string">"bar"</span>: {
    			<span class="hljs-string">"fill"</span>: {
    				<span class="hljs-string">"color"</span>: <span class="hljs-string">"rgba(105, 105, 105, 0.3)"</span>
    			},
    			<span class="hljs-string">"border"</span>: {
    				<span class="hljs-string">"color"</span>: <span class="hljs-string">"rgba(105, 0, 105, 0.5)"</span>
    			}
    		},
    		<span class="hljs-string">"ruler_shadow"</span>: {
    			<span class="hljs-string">"width"</span>: <span class="hljs-number">1</span>,
    			<span class="hljs-string">"fill"</span>: {
    				<span class="hljs-string">"color"</span>: <span class="hljs-string">"rgba(255, 0, 0, 0.3)"</span>
    			}
    		},
    		<span class="hljs-string">"focused_time"</span>: {
    			<span class="hljs-string">"label"</span>: {
    				<span class="hljs-string">"height"</span>: <span class="hljs-number">10</span>
    			}
    		},
    		<span class="hljs-string">"selector"</span>: {
    			<span class="hljs-string">"min_width"</span>: <span class="hljs-number">30</span>,
    			<span class="hljs-string">"max_width"</span>: <span class="hljs-string">"false"</span>,
    			<span class="hljs-string">"fill"</span>: {
    				<span class="hljs-string">"color"</span>: <span class="hljs-string">"rgba(144, 195, 191, 0.1)"</span>
    			},
    			<span class="hljs-string">"border"</span>: {
    				<span class="hljs-string">"width"</span>: <span class="hljs-number">0</span>,
    				<span class="hljs-string">"color"</span>: <span class="hljs-string">"rgba(144, 195, 191, 1)"</span>
    			},
    			<span class="hljs-string">"mask"</span>: {
    				<span class="hljs-string">"fill"</span>: {
    					<span class="hljs-string">"color"</span>: <span class="hljs-string">"rgba(255, 255, 255, 0.8)"</span>
    				},
    				<span class="hljs-string">"border"</span>: {
    					<span class="hljs-string">"width"</span>: <span class="hljs-number">0</span>,
    					<span class="hljs-string">"color"</span>: <span class="hljs-string">"transparent"</span>
    				}
    			},
    			<span class="hljs-string">"handle"</span>: {
    				<span class="hljs-string">"fill"</span>: {
    					<span class="hljs-string">"color"</span>: <span class="hljs-string">"rgba(105, 105, 105, 0.5)"</span>
    				},
    				<span class="hljs-string">"width"</span>: <span class="hljs-number">8</span>
    			}
    		}
    	},
    	<span class="hljs-string">"axis"</span>: {
    		<span class="hljs-string">"stroke"</span>: {
    			<span class="hljs-string">"color"</span>: <span class="hljs-string">"rgba(0, 0, 0, 0.1)"</span>,
    			<span class="hljs-string">"width"</span>: <span class="hljs-number">1</span>
    		},
    		<span class="hljs-string">"tick"</span>: {
    			<span class="hljs-string">"height"</span>: <span class="hljs-number">5</span>
    		},
    		<span class="hljs-string">"label"</span>: {
    			<span class="hljs-string">"height"</span>: <span class="hljs-number">11</span>
    		}
    	}
    };
    

    Debugger.themes = {
        basic: THEMES_BASIC
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <h2 id="helpers">Helpers</h2>

            </div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              <p>Throw an error <em>message</em>.
The <code>message</code> can be formatted with extra arguments given by <code>args</code>.</p>
<pre><code>throwError(<span class="hljs-string">'some {error} with {stack}'</span>, { error: e, stack: e.stack });
</code></pre>
            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">throwError</span><span class="hljs-params">(message, args)</span> </span>{
        <span class="hljs-keyword">var</span> error = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(_.template(message, args || {}, { interpolate: <span class="hljs-regexp">/\#\{(.+?)\}/g</span> }));
        error.name = <span class="hljs-string">'Error'</span>;
        <span class="hljs-keyword">throw</span> error;
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>Sluggify a <code>text</code>.
This function replaces spaces by <code>-</code> and remove all non ascii characters.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">sluggify</span><span class="hljs-params">(text)</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">String</span>(text).toLowerCase().replace(<span class="hljs-built_in">RegExp</span>(<span class="hljs-string">" "</span>, <span class="hljs-string">"g"</span>), <span class="hljs-string">"-"</span>).replace(<span class="hljs-regexp">/[^\w-]+/g</span>, <span class="hljs-string">""</span>)
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>Parse boolean from a string or a boolean.
Leading whitespaces in the string are ignored.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">parseBoolean</span><span class="hljs-params">(string)</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-regexp">/^true$/i</span>.test(string);
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>Ensure that some property of path <code>propertyPath</code> is defined in <code>object</code> and not empty.
If a <code>value</code> is provided as third arguments then it also checked that the value
referred by <code>propertyPath</code> is equal to <code>value</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ensure</span><span class="hljs-params">(object, propertyPath <span class="hljs-comment">/*, value */</span>)</span> </span>{
        <span class="hljs-keyword">var</span> properties = propertyPath.split(<span class="hljs-string">'.'</span>);
        <span class="hljs-keyword">while</span> (properties.length) {
            <span class="hljs-keyword">var</span> property = properties.shift();
            <span class="hljs-keyword">if</span> (_.isObject(object) &amp;&amp; object.hasOwnProperty(property) &amp;&amp; !_.isEmpty(object[property])) {
                object = object[property];
            }
            <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            }
        }
    
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">arguments</span>.length == <span class="hljs-number">2</span>) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> object === _.last(<span class="hljs-built_in">arguments</span>);
        }
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>Check if <code>object</code> is missing some (sub)property referenced by <code>propertyPath</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">missing</span><span class="hljs-params">(object, propertyPath)</span> </span>{
        <span class="hljs-keyword">return</span> !ensure(object, propertyPath);
    }</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>Deep version of lodash _.defaults</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> defaultsDeep = _.partialRight(_.merge, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">recursiveDefaults</span> <span class="hljs-params">( <span class="hljs-comment">/* ... */</span> )</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>Ensure dates and arrays are not recursively merged</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (_.isArray(<span class="hljs-built_in">arguments</span>[<span class="hljs-number">0</span>]) || _.isDate(<span class="hljs-built_in">arguments</span>[<span class="hljs-number">0</span>])) {
            <span class="hljs-keyword">return</span> <span class="hljs-built_in">arguments</span>[<span class="hljs-number">0</span>];
        }
        <span class="hljs-keyword">return</span> _.merge(<span class="hljs-built_in">arguments</span>[<span class="hljs-number">0</span>], <span class="hljs-built_in">arguments</span>[<span class="hljs-number">1</span>], recursiveDefaults);
    });</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>Trigger an event and/or a corresponding method name (@copyright Marionette.triggerMethod).</p>
<ul>
<li><code>this.triggerMethod(&#39;foo&#39;)</code> will trigger the âfooâ event and
call the âonFooâ method.</li>
<li><code>this.triggerMethod(&#39;foo:bar&#39;)</code> will trigger the âfoo:barâ event and
call the âonFooBarâ method.</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    Debugger.triggerMethod = (<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>Split the event name on the â:â</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">var</span> splitter = <span class="hljs-regexp">/(^|:)(\w)/gi</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>Take the event section (âsection1:section2:section3â)
and turn it in to uppercase name</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getEventName</span><span class="hljs-params">(match, prefix, eventName)</span> </span>{
            <span class="hljs-keyword">return</span> eventName.toUpperCase();
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>Actual triggerMethod implementation</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">var</span> triggerMethod = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(event)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>get the method name from the event name</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">var</span> methodName = <span class="hljs-string">'on'</span> + event.replace(splitter, getEventName);
            <span class="hljs-keyword">var</span> method = <span class="hljs-keyword">this</span>[methodName];
            <span class="hljs-keyword">var</span> result;</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>Call the onMethodName if it exists</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">if</span> (_.isFunction(method)) {</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>pass all arguments, except the event name</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                result = method.apply(<span class="hljs-keyword">this</span>, _.tail(<span class="hljs-built_in">arguments</span>));
            }</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>Trigger the event, if a trigger method exists</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">if</span> (_.isFunction(<span class="hljs-keyword">this</span>.trigger)) {
                <span class="hljs-keyword">this</span>.trigger.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
            }
    
            <span class="hljs-keyword">return</span> result;
        };
    
        <span class="hljs-keyword">return</span> triggerMethod;
    })();</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <h2 id="smartbuffer">SmartBuffer</h2>

            </div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p>The SmartBuffer can buffer data intelligently using various techniques:</p>
<ul>
<li>standard (default) - behave like a standard queue</li>
<li>pairing - pair buffered data two by two</li>
<li>shadowing - shadow last element when needed</li>
<li>ignoreData - just keep timestamp and ignore data</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>    Debugger.SmartBuffer = (<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p>Create a new smart buffer model with the specified options.
By default <code>pairing</code>, <code>shadowing</code> and <code>ignoreData</code> are all set to <code>false</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">var</span> SmartBuffer = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(options)</span> </span>{
            <span class="hljs-keyword">this</span>._buffer = [];
            <span class="hljs-keyword">this</span>.options = defaultsDeep({}, options, {
                pairing: <span class="hljs-literal">false</span>,
                shadowing: <span class="hljs-literal">false</span>,
                ignoreData: <span class="hljs-literal">false</span>
            });
        };</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <p>Attach all inheritable methods to the SmartBuffer prototype.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _.extend(SmartBuffer.prototype, {</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>Concat <code>bulk</code> data.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            concat: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(bulk)</span> </span>{
                _.each(bulk, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(f)</span> </span>{
                    <span class="hljs-keyword">this</span>.push.apply(<span class="hljs-keyword">this</span>, f);
                }, <span class="hljs-keyword">this</span>);
            },</pre></div></div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <p>Push new <code>data</code> with given <code>timestamp</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            push: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(timestamp, data)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <p>In case we just keep track of the timestamp.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.ignoreData) {
                    <span class="hljs-keyword">this</span>._buffer.push({
                        timestamp: timestamp
                    });
                    <span class="hljs-keyword">return</span>;
                }</pre></div></div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              <p>Return if buffer is empty and data is undefined.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">if</span> (_.isEmpty(<span class="hljs-keyword">this</span>._buffer) &amp;&amp; _.isUndefined(data)) {
                    <span class="hljs-keyword">return</span>;
                }
    
                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.pairing) {
                    <span class="hljs-keyword">if</span> (data !== <span class="hljs-literal">undefined</span> &amp;&amp; _.isEmpty(<span class="hljs-keyword">this</span>._buffer)) {</pre></div></div>
            
        </li>
        
        
        <li id="section-40">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-40">&#182;</a>
              </div>
              <p>If buffer is empty just push the new data.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                        <span class="hljs-keyword">this</span>._buffer.push({
                            timestamp: timestamp,
                            data: data,
                            next: <span class="hljs-keyword">this</span>.options.shadowing? {
                                timestamp: timestamp,
                                data: data
                            } : <span class="hljs-literal">null</span>
                        });
                    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (data !== <span class="hljs-literal">undefined</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-41">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-41">&#182;</a>
              </div>
              <p>Set previous.next.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                        <span class="hljs-keyword">this</span>._buffer[<span class="hljs-keyword">this</span>.size() - <span class="hljs-number">1</span>].next = {
                            timestamp: timestamp,
                            data: data
                        };</pre></div></div>
            
        </li>
        
        
        <li id="section-42">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-42">&#182;</a>
              </div>
              <p>Push a new frame.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                        <span class="hljs-keyword">this</span>._buffer.push({
                            timestamp: timestamp,
                            data: data,
                            next: <span class="hljs-keyword">this</span>.options.shadowing? {
                                timestamp: timestamp,
                                data: data
                            } : <span class="hljs-literal">null</span>
                        });
                    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.shadowing)  {</pre></div></div>
            
        </li>
        
        
        <li id="section-43">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-43">&#182;</a>
              </div>
              <p>If shadowing then update shadow timestamp.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                        <span class="hljs-keyword">this</span>._buffer[<span class="hljs-keyword">this</span>.size() - <span class="hljs-number">1</span>].next.timestamp = timestamp;
                    }
                } <span class="hljs-keyword">else</span> <span class="hljs-comment">/* pairing is not activated */</span> {
                    <span class="hljs-keyword">if</span> (data !== <span class="hljs-literal">undefined</span> &amp;&amp; <span class="hljs-keyword">this</span>._lastIsShadow) {</pre></div></div>
            
        </li>
        
        
        <li id="section-44">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-44">&#182;</a>
              </div>
              <p>Replace shadow by new frame if shadowing is activated. #</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                        <span class="hljs-keyword">this</span>._buffer[<span class="hljs-keyword">this</span>.size() - <span class="hljs-number">1</span>] = {
                            timestamp: timestamp,
                            data: data
                        };</pre></div></div>
            
        </li>
        
        
        <li id="section-45">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-45">&#182;</a>
              </div>
              <p>Last is not a shadow anymore.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                        <span class="hljs-keyword">this</span>._lastIsShadow = <span class="hljs-literal">false</span>;
                    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (data !== <span class="hljs-literal">undefined</span> &amp;&amp; <span class="hljs-keyword">this</span>._lastIsShadow) {</pre></div></div>
            
        </li>
        
        
        <li id="section-46">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-46">&#182;</a>
              </div>
              <p>Update shadow timestamp if shadowing is activated</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                        <span class="hljs-keyword">this</span>._buffer[<span class="hljs-keyword">this</span>.size() - <span class="hljs-number">1</span>].timestamp = timestamp;
                    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (data !== <span class="hljs-literal">undefined</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-47">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-47">&#182;</a>
              </div>
              <p>Push new data</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                        <span class="hljs-keyword">this</span>._buffer.push({
                            timestamp: timestamp,
                            data: data
                        });
                    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.shadowing) {</pre></div></div>
            
        </li>
        
        
        <li id="section-48">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-48">&#182;</a>
              </div>
              <p>Push a shadow if shadowing is activated.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                        <span class="hljs-keyword">this</span>._buffer.push({
                            timestamp: timestamp,
                            data: <span class="hljs-keyword">this</span>._buffer[<span class="hljs-keyword">this</span>.size() - <span class="hljs-number">1</span>].data
                        });</pre></div></div>
            
        </li>
        
        
        <li id="section-49">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-49">&#182;</a>
              </div>
              <p>Make last a shadow.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                        <span class="hljs-keyword">this</span>._lastIsShadow = <span class="hljs-literal">true</span>;
                    }
                }
            },</pre></div></div>
            
        </li>
        
        
        <li id="section-50">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-50">&#182;</a>
              </div>
              <p>Get all data from the buffer.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            all: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._buffer;
            },</pre></div></div>
            
        </li>
        
        
        <li id="section-51">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-51">&#182;</a>
              </div>
              <p>Get first item from the buffer.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            first: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                <span class="hljs-keyword">return</span> _.first(<span class="hljs-keyword">this</span>._buffer);
            },</pre></div></div>
            
        </li>
        
        
        <li id="section-52">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-52">&#182;</a>
              </div>
              <p>Get last item from the buffer.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            last: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                <span class="hljs-keyword">return</span> _.last(<span class="hljs-keyword">this</span>._buffer);
            },</pre></div></div>
            
        </li>
        
        
        <li id="section-53">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-53">&#182;</a>
              </div>
              <p>Select and return a subset of items matching some <code>predicate</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            select: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(predicate)</span> </span>{
                <span class="hljs-keyword">return</span> _.filter(<span class="hljs-keyword">this</span>._buffer, predicate);
            },</pre></div></div>
            
        </li>
        
        
        <li id="section-54">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-54">&#182;</a>
              </div>
              <p>Return a subset of items not matching some <code>predicate</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            reject: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(predicate)</span> </span>{
                <span class="hljs-keyword">return</span> _.reject(<span class="hljs-keyword">this</span>._buffer, predicate);
            },</pre></div></div>
            
        </li>
        
        
        <li id="section-55">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-55">&#182;</a>
              </div>
              <p>Return the domain covered by this buffer where date in the domain are formatted according to <code>dateFn</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            domain: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(dateFn)</span> </span>{
                <span class="hljs-keyword">if</span> (_.isUndefined(<span class="hljs-keyword">this</span>._buffer)) <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    
                dateFn || (dateFn = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                    <span class="hljs-keyword">return</span> d;
                });
    
                <span class="hljs-keyword">var</span> min = <span class="hljs-keyword">this</span>._buffer[<span class="hljs-number">0</span>];
                <span class="hljs-keyword">var</span> max = _.max(<span class="hljs-keyword">this</span>._buffer, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                    <span class="hljs-keyword">return</span> d.next ? d.next.timestamp : d.timestamp
                });
    
                <span class="hljs-keyword">return</span> [dateFn(min.timestamp), dateFn(max.next ? max.next.timestamp : max.timestamp)];
            },</pre></div></div>
            
        </li>
        
        
        <li id="section-56">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-56">&#182;</a>
              </div>
              <p>Return a frame from buffered data that match a given <code>timestamp</code>.
If no match found then <code>null</code> is returned.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            at: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(timestamp)</span> </span>{
                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.pairing) {
                    <span class="hljs-keyword">return</span> _.findLast(<span class="hljs-keyword">this</span>._buffer, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(frame)</span> </span>{
                        <span class="hljs-keyword">return</span> frame.timestamp &lt;= timestamp &amp;&amp; timestamp &lt;= frame.next.timestamp;
                    });
                } <span class="hljs-keyword">else</span> {
                    <span class="hljs-keyword">return</span> _.findLast(<span class="hljs-keyword">this</span>._buffer, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(frame)</span> </span>{
                        <span class="hljs-keyword">return</span> frame.timestamp == timestamp;
                    });
                }
            },</pre></div></div>
            
        </li>
        
        
        <li id="section-57">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-57">&#182;</a>
              </div>
              <p>Return a frame inside a timestamp <code>range</code>, if multiple frames match then the one
closest to the boundary on the <code>direction</code> side will be returned.
If no match found then <code>null</code> is returned.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            inside: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(range, direction)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-58">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-58">&#182;</a>
              </div>
              <p>The lookup function depends on the lookup direction</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">var</span> lookup = direction == <span class="hljs-string">'left'</span> ? _.find : _.findLast;
    
                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.pairing) {
                    <span class="hljs-keyword">return</span> lookup.call(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>._buffer, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(frame)</span> </span>{
                        <span class="hljs-keyword">return</span> (range[<span class="hljs-number">0</span>] &lt;= frame.timestamp &amp;&amp; frame.timestamp &lt;= range[<span class="hljs-number">1</span>])
                            || (frame.next &amp;&amp; range[<span class="hljs-number">0</span>] &lt;= frame.next.timestamp &amp;&amp; frame.next.timestamp &lt;= range[<span class="hljs-number">1</span>])
                            || (frame.timestamp &lt;= range[<span class="hljs-number">0</span>] &amp;&amp; frame.next &amp;&amp; range[<span class="hljs-number">1</span>] &lt;= frame.next.timestamp);
                    });
                } <span class="hljs-keyword">else</span> {
                    <span class="hljs-keyword">return</span> lookup.call(<span class="hljs-keyword">this</span>, <span class="hljs-keyword">this</span>._buffer, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(frame)</span> </span>{
                        <span class="hljs-keyword">return</span> range[<span class="hljs-number">0</span>] &lt;= frame.timestamp &amp;&amp; frame.timestamp &lt;= range[<span class="hljs-number">1</span>];
                    });
                }
            },</pre></div></div>
            
        </li>
        
        
        <li id="section-59">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-59">&#182;</a>
              </div>
              <p>Return size of the buffer.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            size: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._buffer.length;
            },</pre></div></div>
            
        </li>
        
        
        <li id="section-60">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-60">&#182;</a>
              </div>
              <p>Clear the buffer.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            clear: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-61">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-61">&#182;</a>
              </div>
              <p>We donât use this._buffer = [] here cause there can be other references
to this array in the code.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">while</span>(<span class="hljs-keyword">this</span>._buffer.length &gt; <span class="hljs-number">0</span>) {
                    <span class="hljs-keyword">this</span>._buffer.pop();
                }
            },</pre></div></div>
            
        </li>
        
        
        <li id="section-62">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-62">&#182;</a>
              </div>
              <p>Flush all frames from buffer that date before <code>timestamp</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            flushBefore: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(timestamp)</span> </span>{
                _.remove(<span class="hljs-keyword">this</span>._buffer, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(frame)</span> </span>{
                    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.options.pairing) {
                        <span class="hljs-keyword">return</span> frame.timestamp &lt;= timestamp &amp;&amp; frame.next.timestamp &lt; timestamp;
                    } <span class="hljs-keyword">else</span> {
                        <span class="hljs-keyword">return</span> frame.timestamp &lt;= timestamp;
                    }
                }, <span class="hljs-keyword">this</span>);
            }
        });
    
        <span class="hljs-keyword">return</span> SmartBuffer;
    })();</pre></div></div>
            
        </li>
        
        
        <li id="section-63">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-63">&#182;</a>
              </div>
              <h2 id="logger">Logger</h2>

            </div>
            
        </li>
        
        
        <li id="section-64">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-64">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>    
    <span class="hljs-keyword">var</span> Logger = Debugger.Logger = (<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
    
        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">format</span><span class="hljs-params">(message, args)</span> </span>{
            <span class="hljs-keyword">return</span> _.template(message, args || {}, { interpolate: <span class="hljs-regexp">/\#\{(.+?)\}/g</span> });
        }
    
        <span class="hljs-keyword">var</span> LoggerWrapper = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(logger)</span> </span>{
            <span class="hljs-keyword">this</span>.__logger = logger || <span class="hljs-built_in">console</span>;
        };
    
        _.extend(LoggerWrapper.prototype, _.object(_.map([<span class="hljs-string">'log'</span>, <span class="hljs-string">'info'</span>, <span class="hljs-string">'warn'</span>, <span class="hljs-string">'debug'</span>, <span class="hljs-string">'error'</span>], <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(method)</span> </span>{
            <span class="hljs-keyword">return</span> [method, (<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(method)</span> </span>{
                <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
                    <span class="hljs-keyword">var</span> msg = format.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
                    <span class="hljs-keyword">if</span> (_.isFunction(<span class="hljs-keyword">this</span>.__logger[method])) {
                        <span class="hljs-keyword">this</span>.__logger[method](msg);
                    }
                }
            })(method)];
        })));
    
        <span class="hljs-keyword">return</span> LoggerWrapper;
    })();</pre></div></div>
            
        </li>
        
        
        <li id="section-65">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-65">&#182;</a>
              </div>
              <p>Define default logger.
The default logger output to the console.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    Debugger.logger = <span class="hljs-keyword">new</span> Logger(<span class="hljs-built_in">console</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-66">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-66">&#182;</a>
              </div>
              <p>Events.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    
    Debugger.Events = (<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(Backbone, _)</span> </span>{
<span class="hljs-pi">        'use strict'</span>;
    
        <span class="hljs-keyword">var</span> Events = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
        };
    
        _.extend(Events.prototype, Backbone.Events);
    
        <span class="hljs-keyword">return</span> Events;
    })(Backbone, _);</pre></div></div>
            
        </li>
        
        
        <li id="section-67">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-67">&#182;</a>
              </div>
              <p>Allow the <code>Debugger</code> object to serve as a global event bus, for folks who
want global âpubsubâ in a convenient place.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    _.extend(Debugger, Backbone.Events);</pre></div></div>
            
        </li>
        
        
        <li id="section-68">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-68">&#182;</a>
              </div>
              <h2 id="connector">Connector</h2>

            </div>
            
        </li>
        
        
        <li id="section-69">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-69">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-70">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-70">&#182;</a>
              </div>
              <p>Create a new Connector with the specified options.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    Debugger.Connector = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(options)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-71">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-71">&#182;</a>
              </div>
              <p>Check supports for WebSocket</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (!WebSocket) {
            throwError(<span class="hljs-string">'WebSocket is not supported.'</span>);
        }
    
        <span class="hljs-keyword">if</span> (_.isFunction(<span class="hljs-keyword">this</span>.initialize)) {
            <span class="hljs-keyword">this</span>.initialize(options);
        }
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-72">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-72">&#182;</a>
              </div>
              <p>Attach all inheritable methods to the Connector prototype.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    _.extend(Debugger.Connector.prototype, Backbone.Events, {</pre></div></div>
            
        </li>
        
        
        <li id="section-73">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-73">&#182;</a>
              </div>
              <p>Initialize the connector with given <code>options</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        initialize: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(options)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-74">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-74">&#182;</a>
              </div>
              <p>Set default options in case some is omitted</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.options = defaultsDeep(options || {}, {
                address: <span class="hljs-string">'localhost'</span>,
                port: <span class="hljs-number">8987</span>,
                reconnection: <span class="hljs-literal">true</span>,
                reconnectionAttempts: <span class="hljs-literal">Infinity</span>,
                reconnectionDelay: <span class="hljs-number">5000</span>
            });
    
            <span class="hljs-keyword">this</span>._connectionAttempted = <span class="hljs-number">0</span>;
            <span class="hljs-keyword">this</span>._requestsQueue = [];
            <span class="hljs-keyword">this</span>._initiate_connection();
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-75">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-75">&#182;</a>
              </div>
              <p>Request livetrace from the AppsGate server.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        requestLiveTrace: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(params)</span> </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._exec({
                name: <span class="hljs-string">'livetrace'</span>,
                args: params
            });
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-76">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-76">&#182;</a>
              </div>
              <p>Request historytrace from the AppsGate server with given <code>params</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        requestHistoryTrace: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(params)</span> </span>{
            <span class="hljs-keyword">var</span> now = <span class="hljs-built_in">Date</span>.now();
    
            params = _.defaults({}, params, {
                from: now - <span class="hljs-number">24</span>*<span class="hljs-number">3600</span>*<span class="hljs-number">1000</span>,
                to: now,
                withEventLine: <span class="hljs-literal">false</span>,
                screenResolution: <span class="hljs-number">930</span>,
                selectorResolution: <span class="hljs-number">10</span>,
                brushResolution: <span class="hljs-number">930</span>,
                order: <span class="hljs-string">'type'</span>
            });
    
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._exec({
                name: <span class="hljs-string">'historytrace'</span>,
                args: params
            });
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-77">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-77">&#182;</a>
              </div>
              <p>Request initial history trace.
The initial history trace is an history trace along with
its associated event line.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        requestInitialHistoryTrace: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(params)</span> </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.requestHistoryTrace(defaultsDeep({withEventLine: <span class="hljs-literal">true</span>}, params));
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-78">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-78">&#182;</a>
              </div>
              <p>Check if connection is persistent.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        isPersistent: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.options.reconnection;
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-79">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-79">&#182;</a>
              </div>
              <p>Attempt a new connection.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        tryReconnection: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.options.reconnection &amp;&amp; <span class="hljs-keyword">this</span>._connectionAttempted &lt; <span class="hljs-keyword">this</span>.options.reconnectionAttempts;
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-80">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-80">&#182;</a>
              </div>
              <p><strong>Private API</strong></p>

            </div>
            
        </li>
        
        
        <li id="section-81">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-81">&#182;</a>
              </div>
              <p>Internal method to initiate socket connection.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _initiate_connection: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
    
            self._connectionAttempted++;</pre></div></div>
            
        </li>
        
        
        <li id="section-82">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-82">&#182;</a>
              </div>
              <p>create socket</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.socket = <span class="hljs-keyword">new</span> WebSocket(<span class="hljs-string">'ws://'</span> + <span class="hljs-keyword">this</span>.options.address + <span class="hljs-string">':'</span> + <span class="hljs-keyword">this</span>.options.port);</pre></div></div>
            
        </li>
        
        
        <li id="section-83">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-83">&#182;</a>
              </div>
              <p>bind to events</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            _.extend(<span class="hljs-keyword">this</span>.socket, {
                onopen: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(event)</span> </span>{
                    Debugger.logger.info(<span class="hljs-string">'Socket opened on #{address}:#{port}'</span>, self.options);
                    Debugger.trigger(<span class="hljs-string">'websocket:open'</span>);
                    self._execLastPendingRequestAndDropOthers();
                },
                onerror: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(event)</span> </span>{
                    Debugger.logger.info(<span class="hljs-string">'Socket error.'</span>);
                    Debugger.trigger(<span class="hljs-string">'websocket:error'</span>);
                },
                onclose: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(event)</span> </span>{
                    <span class="hljs-keyword">var</span> code = event.code;
                    <span class="hljs-keyword">var</span> reason = event.reason;
    
                    <span class="hljs-keyword">if</span> (code != <span class="hljs-number">1000</span>) {
                        Debugger.logger.error(<span class="hljs-string">'Socket closed unexpectedly #{reason}[code: #{code}]'</span>, {
                            code: code,
                            reason: reason ? reason + <span class="hljs-string">" "</span> : <span class="hljs-string">""</span>
                        });
                    } <span class="hljs-keyword">else</span> {
                        Debugger.logger.info(<span class="hljs-string">'Socket closed.'</span>, {
                            code: code,
                            reason: reason
                        });
                    }
    
                    Debugger.trigger(<span class="hljs-string">'websocket:close'</span>);
    
                    <span class="hljs-keyword">if</span> (code != <span class="hljs-number">1000</span> &amp;&amp; self.isPersistent() &amp;&amp; self.tryReconnection()) {</pre></div></div>
            
        </li>
        
        
        <li id="section-84">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-84">&#182;</a>
              </div>
              <p>Notify user.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                        Debugger.logger.info(<span class="hljs-string">"Schedule socket reconnection in #{delay}ms (attempt nÂ°#{attempts})"</span>, {
                                attempts: self._connectionAttempted,
                                delay: self.options.reconnectionDelay}
                        );</pre></div></div>
            
        </li>
        
        
        <li id="section-85">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-85">&#182;</a>
              </div>
              <p>Reschedule connection.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                        setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
                            self._initiate_connection()
                        }, self.options.reconnectionDelay);
                    }
                },
                onmessage: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(message)</span> </span>{
                    <span class="hljs-keyword">try</span> {
                        <span class="hljs-keyword">var</span> unpacked = self._unpackMessage(message.data);
                        self.trigger(<span class="hljs-string">'packet:received'</span>, unpacked);
                    } <span class="hljs-keyword">catch</span> (e) {
                        throwError(<span class="hljs-string">'Skip message "#{message}" due to error #{error}'</span>, {
                            message: message,
                            error: e
                        });
                    }
                }
            });
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-86">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-86">&#182;</a>
              </div>
              <p>Internal methods for executing last pending request and drop the others</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _execLastPendingRequestAndDropOthers: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">if</span> (!_.isEmpty(<span class="hljs-keyword">this</span>._requestsQueue)) {
                <span class="hljs-keyword">var</span> last = _.last(<span class="hljs-keyword">this</span>._requestsQueue);
                _.forEach(<span class="hljs-keyword">this</span>._requestsQueue, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(request)</span> </span>{
                    Debugger.logger.info(<span class="hljs-string">"Dropping old request #{request} from pending queue"</span>, {
                        request: <span class="hljs-built_in">JSON</span>.stringify(request)
                    });
                });
                <span class="hljs-keyword">this</span>._clearRequestsQueue();
                <span class="hljs-keyword">this</span>._exec(last);
            }
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-87">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-87">&#182;</a>
              </div>
              <p>Internal method for executing a <code>request</code>.
In case the socket is not OPEN the request will
be appended to the requestsQueue to be executed later.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _exec: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(request)</span> </span>{
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.socket.readyState == WebSocket.OPEN) {
                Debugger.logger.info(<span class="hljs-string">"Executing request #{request}"</span>, {
                    request: <span class="hljs-built_in">JSON</span>.stringify(request)
                });
                <span class="hljs-keyword">this</span>.socket.send(<span class="hljs-built_in">JSON</span>.stringify(request));
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            } <span class="hljs-keyword">else</span> {
                Debugger.logger.info(<span class="hljs-string">"Postpone request #{request}"</span>, {
                    request: <span class="hljs-built_in">JSON</span>.stringify(request)
                });
                <span class="hljs-keyword">this</span>._requestsQueue.push(request);
                <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
            }
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-88">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-88">&#182;</a>
              </div>
              <p>Clear all pending requests.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _clearRequestsQueue: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">this</span>._requestsQueue = [];
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-89">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-89">&#182;</a>
              </div>
              <p>Unpack message into a {request, data, groups} object.
Depending on the received message, value in the return object might be null.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _unpackMessage: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(message)</span> </span>{
            <span class="hljs-keyword">var</span> answer = <span class="hljs-built_in">JSON</span>.parse(message);
            <span class="hljs-keyword">if</span> (_.isObject(answer) &amp;&amp; _.has(answer, <span class="hljs-string">'request'</span>)) {
                <span class="hljs-keyword">var</span> unpacked = {
                    request: answer.request,
                    data: answer.result.data,
                    eventline: answer.result.eventline,
                    groups: answer.result.groups
                };
    
                <span class="hljs-keyword">if</span> (answer.request.name == <span class="hljs-string">'historytrace'</span>) {
                    unpacked[<span class="hljs-string">'isHistoryTrace'</span>] = <span class="hljs-literal">true</span>;
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (answer.request.name == <span class="hljs-string">'livetrace'</span>) {
                    unpacked[<span class="hljs-string">'isLiveTrace'</span>] = <span class="hljs-literal">true</span>;
                }
    
                <span class="hljs-keyword">return</span> unpacked;
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">return</span> {
                    isLiveTrace: <span class="hljs-literal">true</span>,
                    request: <span class="hljs-literal">null</span>,
                    data: answer,
                    eventline: <span class="hljs-literal">null</span>,
                    groups: <span class="hljs-literal">null</span>
                };
            }
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-90">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-90">&#182;</a>
              </div>
              <p>Import the <code>triggerMethod</code> to trigger events with corresponding
methods if the method exists</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        triggerMethod: Debugger.triggerMethod,</pre></div></div>
            
        </li>
        
        
        <li id="section-91">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-91">&#182;</a>
              </div>
              <p>Destroy the connector properly</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        destroy: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">var</span> args = <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>);
            <span class="hljs-keyword">this</span>.triggerMethod.apply(<span class="hljs-keyword">this</span>, [<span class="hljs-string">'before:destroy'</span>].concat(args));
            <span class="hljs-keyword">this</span>.triggerMethod.apply(<span class="hljs-keyword">this</span>, [<span class="hljs-string">'destroy'</span>].concat(args));
    
            <span class="hljs-keyword">this</span>.stopListening();
            <span class="hljs-keyword">this</span>.off();
            <span class="hljs-keyword">this</span>.socket.close();
        }
    });</pre></div></div>
            
        </li>
        
        
        <li id="section-92">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-92">&#182;</a>
              </div>
              <h2 id="dashboard">Dashboard</h2>

            </div>
            
        </li>
        
        
        <li id="section-93">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-93">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-94">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-94">&#182;</a>
              </div>
              <p>AppsGate <strong>Dashboard</strong> is the central element of the AppsGate Debugger.</p>

            </div>
            
        </li>
        
        
        <li id="section-95">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-95">&#182;</a>
              </div>
              <p>Create a new Dashboard with the specified <code>options</code> and append it to the given <code>selector</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    Debugger.Dashboard = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(selector, options)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-96">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-96">&#182;</a>
              </div>
              <p>check if selector is given</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (!selector) {
            throwError(<span class="hljs-string">'You must specify a selector to create a Dashboard.'</span>);
        }
    
        _.bindAll(<span class="hljs-keyword">this</span>, <span class="hljs-string">'onPacketReceived'</span>);
    
        <span class="hljs-keyword">this</span>._groups = {};
        <span class="hljs-keyword">this</span>._devices = {};
        <span class="hljs-keyword">this</span>._programs = {};</pre></div></div>
            
        </li>
        
        
        <li id="section-97">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-97">&#182;</a>
              </div>
              <p>Extract d3 settings from options</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">if</span> (options) {
            <span class="hljs-keyword">this</span>._d3_settings = options.d3; <span class="hljs-keyword">delete</span> options.d3;
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-98">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-98">&#182;</a>
              </div>
              <p>keep track of time domain, this is required when adding dynamically new
devices or programs in order to sync their timescale.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">this</span>._domain = [_.now(), <span class="hljs-number">0</span>];</pre></div></div>
            
        </li>
        
        
        <li id="section-99">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-99">&#182;</a>
              </div>
              <p>Keep track of dashboard state</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">this</span>._state = {};</pre></div></div>
            
        </li>
        
        
        <li id="section-100">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-100">&#182;</a>
              </div>
              <p>Keep track of dashboard mode.
note: before a dashboard reset the mode is undefined.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="hljs-keyword">this</span>._mode = Debugger.DASHBOARD_MODE.UNKNOWN;
    
        <span class="hljs-keyword">if</span> (_.isFunction(<span class="hljs-keyword">this</span>.initialize)) {
            <span class="hljs-keyword">this</span>.initialize(selector, options);
        }
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-101">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-101">&#182;</a>
              </div>
              <p>Define dashboard MODE</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    Debugger.DASHBOARD_MODE = <span class="hljs-built_in">Object</span>.freeze({
        LIVE: <span class="hljs-string">'live'</span>,
        HISTORY: <span class="hljs-string">'history'</span>,
        UNKNOWN: <span class="hljs-literal">undefined</span>
    });</pre></div></div>
            
        </li>
        
        
        <li id="section-102">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-102">&#182;</a>
              </div>
              <p>Attach all inheritable methods to the Dashboard prototype.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    _.extend(Debugger.Dashboard.prototype, Backbone.Events, {</pre></div></div>
            
        </li>
        
        
        <li id="section-103">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-103">&#182;</a>
              </div>
              <p>Initialize the dashboard.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        initialize: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(selector, options)</span> </span>{
            <span class="hljs-keyword">this</span>.options = defaultsDeep(options || {}, {
                theme: THEMES_BASIC,
                i18n: {
                    ns: <span class="hljs-string">'debugger'</span>
                },
                livetrace: {
                    delayBeforeFlush: <span class="hljs-number">100000</span>
                },
                selector: {
                    resolution: <span class="hljs-number">30</span>
                }
            });
    
            <span class="hljs-keyword">this</span>._init_ui(selector);
            <span class="hljs-keyword">this</span>._init_konami();
            <span class="hljs-keyword">this</span>._init_d3();
            <span class="hljs-keyword">this</span>._clean();
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-104">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-104">&#182;</a>
              </div>
              <p>jQuery delegate for element lookup, scoped to DOM elements within the
current view. This should be preferred to global lookups where possible.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        $: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(selector)</span> </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.$el.find(selector);
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-105">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-105">&#182;</a>
              </div>
              <p>Import the <code>triggerMethod</code> to trigger events with corresponding
methods if the method exists</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        triggerMethod: Debugger.triggerMethod,</pre></div></div>
            
        </li>
        
        
        <li id="section-106">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-106">&#182;</a>
              </div>
              <p>Connect the dashboard to a <code>connector</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        connect: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(connector)</span> </span>{
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.connector) {</pre></div></div>
            
        </li>
        
        
        <li id="section-107">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-107">&#182;</a>
              </div>
              <p>Unregister if already registered.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                Debugger.logger.warn(<span class="hljs-string">"Dashboad connection reinitialized: the dashboad was already connected to a connector."</span>);
                <span class="hljs-keyword">this</span>.connector.off(<span class="hljs-string">'packet:received'</span>, <span class="hljs-keyword">this</span>.update);
            }</pre></div></div>
            
        </li>
        
        
        <li id="section-108">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-108">&#182;</a>
              </div>
              <p>Register to <code>connector</code> events</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.connector = connector;
            <span class="hljs-keyword">this</span>.connector.on(<span class="hljs-string">'packet:received'</span>, <span class="hljs-keyword">this</span>.onPacketReceived);
    
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-109">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-109">&#182;</a>
              </div>
              <p>Update dashboard with new data. This is generally called by the connected
connector when new data are received.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        onPacketReceived: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(packet)</span> </span>{
            <span class="hljs-keyword">try</span> {
                <span class="hljs-keyword">if</span> (!packet.isHistoryTrace &amp;&amp; !packet.isLiveTrace) {
                    <span class="hljs-keyword">throw</span> <span class="hljs-string">"Unsupported packet: packet must be of type history or live."</span>
                }</pre></div></div>
            
        </li>
        
        
        <li id="section-110">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-110">&#182;</a>
              </div>
              <p>If <code>packet</code> contains a request then we must reinitialize some stuff in the dashboard.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">if</span> (packet.request) {</pre></div></div>
            
        </li>
        
        
        <li id="section-111">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-111">&#182;</a>
              </div>
              <p>If a global eventline is sent then we must reset the dashboard.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                    <span class="hljs-keyword">if</span> (packet.eventline) {</pre></div></div>
            
        </li>
        
        
        <li id="section-112">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-112">&#182;</a>
              </div>
              <p>Reset the dashboard whenever a new eventline is sent.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                        <span class="hljs-keyword">this</span>._reset(packet.isHistoryTrace ? Debugger.DASHBOARD_MODE.HISTORY : Debugger.DASHBOARD_MODE.LIVE);</pre></div></div>
            
        </li>
        
        
        <li id="section-113">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-113">&#182;</a>
              </div>
              <p>Reload focusline with data from evenline.
note: here we prevent rendering except for the last frame</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                        <span class="hljs-keyword">var</span> lastFrame = packet.eventline.pop();
    
                        _.each(packet.eventline, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(frame)</span> </span>{
                            <span class="hljs-keyword">this</span>._update_focusline_with_frame(frame, {render: <span class="hljs-literal">false</span>});
                        }, <span class="hljs-keyword">this</span>);
    
                        <span class="hljs-keyword">if</span> (lastFrame) {
                            <span class="hljs-keyword">this</span>._update_focusline_with_frame(lastFrame);
                        }
                    } <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-114">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-114">&#182;</a>
              </div>
              <p>Otherwise clean the dashboard. This will not affect the focusline.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                        <span class="hljs-keyword">this</span>._clean();
                    }
                }
    
                <span class="hljs-keyword">if</span> (packet.isHistoryTrace) {</pre></div></div>
            
        </li>
        
        
        <li id="section-115">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-115">&#182;</a>
              </div>
              <p>This is an <code>historytrace</code> packet</p>

            </div>
            
        </li>
        
        
        <li id="section-116">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-116">&#182;</a>
              </div>
              <p>Set the default group demux.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                    <span class="hljs-keyword">if</span> (packet.groups) {
                        <span class="hljs-keyword">this</span>._demux = <span class="hljs-keyword">this</span>._create_demux({grouping: packet.groups});
                    }</pre></div></div>
            
        </li>
        
        
        <li id="section-117">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-117">&#182;</a>
              </div>
              <p>Update dashboad widgets with received data.
note: here we prevent rendering except for the last frame</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                    <span class="hljs-keyword">var</span> lastFrame = packet.data.pop();
    
                    _.each(packet.data, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(frame)</span> </span>{
                        <span class="hljs-keyword">this</span>._update_all_with_frame(frame, {render: <span class="hljs-literal">false</span>});
                    }, <span class="hljs-keyword">this</span>);
    
                    <span class="hljs-keyword">if</span> (lastFrame) {
                        <span class="hljs-keyword">this</span>._update_all_with_frame(lastFrame);
                    }</pre></div></div>
            
        </li>
        
        
        <li id="section-118">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-118">&#182;</a>
              </div>
              <p>Update shadows so that they span at least the focused range.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                    <span class="hljs-keyword">if</span> (lastFrame &amp;&amp; lastFrame.timestamp &lt; <span class="hljs-keyword">this</span>._focus[<span class="hljs-number">1</span>]) {
                        <span class="hljs-keyword">this</span>._update_focusline_with_frame({timestamp: <span class="hljs-keyword">this</span>._focus[<span class="hljs-number">1</span>]});
                        <span class="hljs-keyword">this</span>._update_all_with_frame({timestamp: <span class="hljs-keyword">this</span>._focus[<span class="hljs-number">1</span>]});
                    }</pre></div></div>
            
        </li>
        
        
        <li id="section-119">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-119">&#182;</a>
              </div>
              <p>If specified, mark focused widget as focused</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                    <span class="hljs-keyword">if</span> (packet.request.args.focus) {
                        <span class="hljs-keyword">switch</span> (packet.request.args.focusType) {
                            <span class="hljs-keyword">case</span> <span class="hljs-string">'id'</span>:
                                (<span class="hljs-keyword">this</span>._devices[packet.request.args.focus] || <span class="hljs-keyword">this</span>._programs[packet.request.args.focus]).markAsFocused(<span class="hljs-literal">true</span>);
                            <span class="hljs-keyword">default</span>:
                                Debugger.logger.warn(<span class="hljs-string">'Only focus by `id` is supported'</span>);
                        }
                    }
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (packet.isLiveTrace) {</pre></div></div>
            
        </li>
        
        
        <li id="section-120">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-120">&#182;</a>
              </div>
              <p>This is a live stream packet</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    
                    <span class="hljs-keyword">var</span> data = packet.data;
                    <span class="hljs-keyword">if</span> (data <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Array</span> &amp;&amp; data.length &gt; <span class="hljs-number">0</span>) {</pre></div></div>
            
        </li>
        
        
        <li id="section-121">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-121">&#182;</a>
              </div>
              <p>Update widgets with received data.
note: here we prevent rendering except for the last frame</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                        <span class="hljs-keyword">var</span> lastFrame = data.pop();
    
                        _.each(data, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(frame)</span> </span>{
                            <span class="hljs-keyword">this</span>._update_focusline_with_frame(frame, {render: <span class="hljs-literal">false</span>});
                            <span class="hljs-keyword">this</span>._update_all_with_frame(frame, {render: <span class="hljs-literal">false</span>});
                        }, <span class="hljs-keyword">this</span>);
    
                        <span class="hljs-keyword">if</span> (lastFrame) {
                            <span class="hljs-keyword">this</span>._update_focusline_with_frame(lastFrame, {live: <span class="hljs-literal">true</span>});
                            <span class="hljs-keyword">this</span>._update_all_with_frame(lastFrame, {live: <span class="hljs-literal">true</span>});
                        }</pre></div></div>
            
        </li>
        
        
        <li id="section-122">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-122">&#182;</a>
              </div>
              <p>Update shadows so that they span at least the focused range.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                        <span class="hljs-keyword">if</span> (lastFrame &amp;&amp; lastFrame.timestamp &lt; <span class="hljs-keyword">this</span>._focus[<span class="hljs-number">1</span>]) {
                            <span class="hljs-keyword">this</span>._update_focusline_with_frame({timestamp: <span class="hljs-keyword">this</span>._focus[<span class="hljs-number">1</span>]});
                            <span class="hljs-keyword">this</span>._update_all_with_frame({timestamp: <span class="hljs-keyword">this</span>._focus[<span class="hljs-number">1</span>]});
                        }
                    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!(data <span class="hljs-keyword">instanceof</span>  <span class="hljs-built_in">Array</span>)) {
                        <span class="hljs-keyword">this</span>._update_focusline_with_frame(data, {live: <span class="hljs-literal">true</span>});
                        <span class="hljs-keyword">this</span>._update_all_with_frame(data, {live: <span class="hljs-literal">true</span>});
                    }
                }</pre></div></div>
            
        </li>
        
        
        <li id="section-123">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-123">&#182;</a>
              </div>
              <p>When packet is an answer to a new request we toggle loading off.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">if</span> (packet.request) {
                    <span class="hljs-keyword">this</span>._toggleLoading(<span class="hljs-literal">false</span>);
                }</pre></div></div>
            
        </li>
        
        
        <li id="section-124">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-124">&#182;</a>
              </div>
              <p>Synchronize widgets with ruler position</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">this</span>._notifyWidgetsOfRulerPosition();
            } <span class="hljs-keyword">catch</span> (e) {
                Debugger.logger.error(<span class="hljs-string">'Error when processing packet `#{packet}`. #{error} #{stacktrace}'</span>, {
                    packet: packet,
                    error: e,
                    stacktrace: e.stack
                });
            }
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-125">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-125">&#182;</a>
              </div>
              <p>Request initial history trace.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        requestInitialHistoryTrace: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(params)</span> </span>{
            params = _.defaults({}, params, {
                order: <span class="hljs-string">'type'</span>,
                screenResolution: <span class="hljs-keyword">this</span>.options.theme.dashboard.width,
                selectorResolution: <span class="hljs-keyword">this</span>.options.selector.resolution,
                brushResolution: <span class="hljs-keyword">this</span>.options.theme.dashboard.width
            });
    
            <span class="hljs-keyword">this</span>._setState(params);
    
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.connector) {
                <span class="hljs-keyword">this</span>.connector.requestInitialHistoryTrace(params);
            }
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-126">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-126">&#182;</a>
              </div>
              <p>Request history trace.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        requestHistoryTrace: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(params)</span> </span>{
            params = _.defaults({}, params, {
                order: <span class="hljs-string">'type'</span>,
                from: <span class="hljs-keyword">this</span>._domain[<span class="hljs-number">0</span>],
                to: <span class="hljs-keyword">this</span>._domain[<span class="hljs-number">1</span>],
                screenResolution: <span class="hljs-keyword">this</span>._focusline.computed(<span class="hljs-string">'svg.width'</span>),
                selectorResolution: <span class="hljs-keyword">this</span>.options.selector.resolution,
                brushResolution: <span class="hljs-keyword">this</span>._focusline.computed(<span class="hljs-string">'svg.width'</span>)
            });
    
            <span class="hljs-keyword">this</span>._setState(params);
    
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.connector) {
                <span class="hljs-keyword">this</span>.connector.requestHistoryTrace(params)
            }
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-127">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-127">&#182;</a>
              </div>
              <p> Request live trace.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        requestLiveTrace: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(params)</span> </span>{
            params = _.defaults({}, params, {
                refreshRate: <span class="hljs-number">2000</span>
            });
    
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.connector) {
                <span class="hljs-keyword">this</span>.connector.requestLiveTrace(params);
            }
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-128">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-128">&#182;</a>
              </div>
              <p>Get current mode.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        mode: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._mode;
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-129">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-129">&#182;</a>
              </div>
              <p>Check is current mode is <code>live</code> mode.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        isLiveMode: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._mode == Debugger.DASHBOARD_MODE.LIVE;
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-130">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-130">&#182;</a>
              </div>
              <p>Check is current mode is <code>history</code> mode.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        isHistoryMode: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._mode == Debugger.DASHBOARD_MODE.HISTORY;
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-131">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-131">&#182;</a>
              </div>
              <p><strong>Private API</strong></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    
        _setState: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(key, value)</span> </span>{
            <span class="hljs-keyword">var</span> attr, attrs;
            <span class="hljs-keyword">if</span> (key == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> key === <span class="hljs-string">'object'</span>) {
                attrs = key;
            } <span class="hljs-keyword">else</span> {
                (attrs = {})[key] = value;
            }
    
            <span class="hljs-keyword">for</span> (attr <span class="hljs-keyword">in</span> attrs) {
                <span class="hljs-keyword">this</span>._state[attr] = attrs[attr];
            }
        },
    
        _delState: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(key)</span> </span>{
            <span class="hljs-keyword">var</span> keys;
            <span class="hljs-keyword">if</span> (key == <span class="hljs-literal">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> key === <span class="hljs-string">'object'</span>) {
                keys = key;
            } <span class="hljs-keyword">else</span> {
                keys = [key];
            }
    
            <span class="hljs-keyword">for</span> (key <span class="hljs-keyword">in</span> keys) {
                <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>._state[keys[key]];
            }
        },
    
        _getState: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(attr)</span> </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>._state[attr];
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-132">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-132">&#182;</a>
              </div>
              <p>Get zoom context</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _getHistoryZoomContext: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">return</span> _.pick(<span class="hljs-keyword">this</span>._state, [
                <span class="hljs-string">'from'</span>, <span class="hljs-string">'to'</span>,
                <span class="hljs-string">'screenResolution'</span>, <span class="hljs-string">'selectorResolution'</span>, <span class="hljs-string">'brushResolution'</span>,
                <span class="hljs-string">'order'</span>, <span class="hljs-string">'focus'</span>, <span class="hljs-string">'focusType'</span>]);
        },
    
        _init_konami: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
            self._konami = <span class="hljs-string">"38,38,40,40,37,39,37,39,66,65"</span>;
            self._konami_slice = self._konami.split(<span class="hljs-string">','</span>).length;
            self._kkeys = [];
            <span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">"keydown"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(e)</span></span>{
                self._kkeys.push( e.keyCode );
                <span class="hljs-keyword">if</span> ( self._kkeys.toString().indexOf( self._konami ) &gt;= <span class="hljs-number">0</span> ) {
                    $(<span class="hljs-string">'body'</span>).addClass(<span class="hljs-string">'konami-background'</span>);
                }
                self._kkeys = self._kkeys.slice(-self._konami_slice);
            }, <span class="hljs-literal">true</span>);
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-133">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-133">&#182;</a>
              </div>
              <p>Initialize the UI within the container designated by the <code>selector</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _init_ui: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(selector)</span> </span>{
            <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-134">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-134">&#182;</a>
              </div>
              <p>Create header and footer.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._$header = $(<span class="hljs-string">'&lt;header&gt;&lt;/header&gt;'</span>).css({
                width: <span class="hljs-built_in">parseInt</span>(<span class="hljs-keyword">this</span>.options.theme.dashboard.width) + <span class="hljs-string">"px"</span>
            });
            <span class="hljs-keyword">this</span>._$footer = $(<span class="hljs-string">'&lt;footer&gt;&lt;/footer&gt;'</span>).css({
                width: <span class="hljs-built_in">parseInt</span>(<span class="hljs-keyword">this</span>.options.theme.dashboard.width) + <span class="hljs-string">"px"</span>
            });</pre></div></div>
            
        </li>
        
        
        <li id="section-135">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-135">&#182;</a>
              </div>
              <p>Create the widgets group container</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._$group_container = $(<span class="hljs-string">'&lt;div class="group-container"&gt;&lt;/div&gt;'</span>).css({
                width: <span class="hljs-built_in">parseInt</span>(<span class="hljs-keyword">this</span>.options.theme.dashboard.width) + <span class="hljs-string">"px"</span>
            });</pre></div></div>
            
        </li>
        
        
        <li id="section-136">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-136">&#182;</a>
              </div>
              <p>Create dashboard content container</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._$container = $(<span class="hljs-string">'&lt;div class="dashboard-container"&gt;&lt;/div&gt;'</span>).append(<span class="hljs-keyword">this</span>._$group_container);</pre></div></div>
            
        </li>
        
        
        <li id="section-137">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-137">&#182;</a>
              </div>
              <p>Create loading bar</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._$loader = $(<span class="hljs-string">'&lt;div class="dashboard-loader"&gt;&lt;div class="icon-loading"&gt;&lt;/div&gt; &lt;/div&gt;'</span>).css({
                width: <span class="hljs-built_in">parseInt</span>(<span class="hljs-keyword">this</span>.options.theme.dashboard.width) + <span class="hljs-string">"px"</span>
            });</pre></div></div>
            
        </li>
        
        
        <li id="section-138">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-138">&#182;</a>
              </div>
              <p>Setup the dashboard.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.$el = $(selector).addClass(<span class="hljs-string">'dashboard'</span>).append(
                <span class="hljs-keyword">this</span>._$header,
                <span class="hljs-keyword">this</span>._$container,
                <span class="hljs-keyword">this</span>._$loader,
                <span class="hljs-keyword">this</span>._$footer);</pre></div></div>
            
        </li>
        
        
        <li id="section-139">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-139">&#182;</a>
              </div>
              <p>Create ruler and hide it</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._create_dashboard_ruler();</pre></div></div>
            
        </li>
        
        
        <li id="section-140">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-140">&#182;</a>
              </div>
              <p>Put dashboard in loading mode</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._toggleLoading(<span class="hljs-literal">true</span>);
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-141">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-141">&#182;</a>
              </div>
              <p>Initialize D3</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _init_d3: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-142">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-142">&#182;</a>
              </div>
              <p>Define main timescale.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.timescale = d3.time.scale().range([<span class="hljs-number">0</span>, <span class="hljs-keyword">this</span>.options.theme.dashboard.width]);</pre></div></div>
            
        </li>
        
        
        <li id="section-143">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-143">&#182;</a>
              </div>
              <p>Setup local and override d3 time format.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._d3_settings &amp;&amp; <span class="hljs-keyword">this</span>._d3_settings.locale) {
                <span class="hljs-keyword">this</span>._d3_locale = d3.locale(<span class="hljs-keyword">this</span>._d3_settings.locale);
                d3.time.format = <span class="hljs-keyword">this</span>._d3_locale.timeFormat;
            }
    
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._d3_settings &amp;&amp; <span class="hljs-keyword">this</span>._d3_settings.timeFormatMulti) {
                <span class="hljs-keyword">this</span>._d3_timeFormatMulti = d3.time.format.multi(<span class="hljs-keyword">this</span>._d3_settings.timeFormatMulti);
            }
        },
    
        _toggleLoading: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(visible)</span> </span>{
            <span class="hljs-keyword">if</span> (visible) {
                <span class="hljs-keyword">this</span>._$header.hide();
                <span class="hljs-keyword">this</span>._$group_container.hide();
                <span class="hljs-keyword">this</span>._$loader.show();
                <span class="hljs-keyword">this</span>._$footer.hide();
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">this</span>._$header.show();
                <span class="hljs-keyword">this</span>._$group_container.show();
                <span class="hljs-keyword">this</span>._$loader.hide();
                <span class="hljs-keyword">this</span>._$footer.show();
            }
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-144">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-144">&#182;</a>
              </div>
              <p>Reset dashboard to its initial state.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _reset: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(mode)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-145">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-145">&#182;</a>
              </div>
              <p>Clean groups, devices, programs.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._clean();
    
            <span class="hljs-keyword">this</span>._devices = {};  <span class="hljs-comment">// reset devices</span>
            <span class="hljs-keyword">this</span>._programs = {}; <span class="hljs-comment">// reset programs</span></pre></div></div>
            
        </li>
        
        
        <li id="section-146">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-146">&#182;</a>
              </div>
              <p>Reset focusline</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._remove_focusline();
            <span class="hljs-keyword">this</span>._create_focusline(mode);</pre></div></div>
            
        </li>
        
        
        <li id="section-147">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-147">&#182;</a>
              </div>
              <p>Reset domain.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._domain = [_.now() - <span class="hljs-keyword">this</span>.options.livetrace.delayBeforeFlush, _.now()];</pre></div></div>
            
        </li>
        
        
        <li id="section-148">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-148">&#182;</a>
              </div>
              <p>Keep track of new mode</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._mode = mode;
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-149">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-149">&#182;</a>
              </div>
              <p>Clean dashboard. Cleaning the dashboard will (a) clean and detach all widgets but
the focusline and (b) destroy all groups.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _clean: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-150">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-150">&#182;</a>
              </div>
              <p>Put dashboard in loading mode</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._toggleLoading(<span class="hljs-literal">true</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-151">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-151">&#182;</a>
              </div>
              <p>Detach devices.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            _.forEach(<span class="hljs-keyword">this</span>._devices, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(widget)</span> </span>{
                <span class="hljs-keyword">this</span>._detach_widget(widget);
            }, <span class="hljs-keyword">this</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-152">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-152">&#182;</a>
              </div>
              <p>Detach programs.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            _.forEach(<span class="hljs-keyword">this</span>._programs, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(widget)</span> </span>{
                <span class="hljs-keyword">this</span>._detach_widget(widget);
            }, <span class="hljs-keyword">this</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-153">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-153">&#182;</a>
              </div>
              <p>Remove groups.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            _.forEach(<span class="hljs-keyword">this</span>._groups, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(group)</span> </span>{
                <span class="hljs-keyword">this</span>._remove_group(group);
            }, <span class="hljs-keyword">this</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-154">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-154">&#182;</a>
              </div>
              <p>Reset groups.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._groups = {};</pre></div></div>
            
        </li>
        
        
        <li id="section-155">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-155">&#182;</a>
              </div>
              <p>Set default group demultiplexer (demux).</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._demux = <span class="hljs-keyword">this</span>._create_demux({ func: <span class="hljs-string">'type'</span> });
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-156">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-156">&#182;</a>
              </div>
              <p>Focus change callback.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _onFocusChange: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">this</span>._notifyWidgetsOnRulerFocusChanged(<span class="hljs-keyword">this</span>._$ruler.position());
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-157">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-157">&#182;</a>
              </div>
              <p>Brush resize callback.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _onBrushResize: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(width)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-158">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-158">&#182;</a>
              </div>
              <p>Keep track of new brush resolution</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._setState(<span class="hljs-string">'brushResolution'</span>, width);</pre></div></div>
            
        </li>
        
        
        <li id="section-159">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-159">&#182;</a>
              </div>
              <p>Propagate event</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.triggerMethod.apply(<span class="hljs-keyword">this</span>, [<span class="hljs-string">'zoom:request'</span>].concat([<span class="hljs-keyword">this</span>._getHistoryZoomContext()]));
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-160">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-160">&#182;</a>
              </div>
              <p>Widget marker click callback.
<code>decorations</code> is an array of decorations associated to the marker.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _onWidgetMarkerClick: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(decorations)</span> </span>{
            <span class="hljs-keyword">var</span> textContent = <span class="hljs-string">''</span>;
            <span class="hljs-keyword">var</span> htmlContent = <span class="hljs-string">''</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-161">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-161">&#182;</a>
              </div>
              <p>Build basic string representation of <code>decorations</code> array
both as plain text and HTML.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            _.each(_.sortBy(decorations, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(decoration)</span> </span>{ <span class="hljs-keyword">return</span> <span class="hljs-built_in">parseInt</span>(decoration.order) }), <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(decoration)</span> </span>{
                textContent += decoration.description + <span class="hljs-string">'\n'</span>;
                htmlContent += decoration.description + <span class="hljs-string">'&lt;/br&gt;'</span>;
            });</pre></div></div>
            
        </li>
        
        
        <li id="section-162">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-162">&#182;</a>
              </div>
              <p>Trigger <code>marker:click</code> event with following arguments:</p>
<ul>
<li>decorations: Arrays - list of decorations associated to the marker</li>
<li>textContent: String - concatenations of all decorations to plain text</li>
<li>htmlContent: String - concatenations of all decorations to HTML</li>
</ul>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.triggerMethod.apply(<span class="hljs-keyword">this</span>, [<span class="hljs-string">'marker:click'</span>].concat([decorations, textContent, htmlContent]));
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-163">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-163">&#182;</a>
              </div>
              <p>Widget focus request</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _onWidgetFocusRequest: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(attributes)</span> </span>{
            <span class="hljs-keyword">var</span> context =  {};
            <span class="hljs-keyword">var</span> markAsUnfocused = <span class="hljs-literal">null</span>;
    
            <span class="hljs-keyword">if</span> (attributes.focused) {
                markAsUnfocused = attributes.id;</pre></div></div>
            
        </li>
        
        
        <li id="section-164">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-164">&#182;</a>
              </div>
              <p>Delete focus state variables</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">this</span>._delState([<span class="hljs-string">'focus'</span>, <span class="hljs-string">'focusType'</span>]);</pre></div></div>
            
        </li>
        
        
        <li id="section-165">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-165">&#182;</a>
              </div>
              <p>Build history context</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                context = _.merge(context, <span class="hljs-keyword">this</span>._getHistoryZoomContext(), {
                    order: <span class="hljs-string">'type'</span>
                });
            } <span class="hljs-keyword">else</span> {
                markAsUnfocused = <span class="hljs-keyword">this</span>._getState(<span class="hljs-string">'focus'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-166">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-166">&#182;</a>
              </div>
              <p>Build history context</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                context = _.merge(context, <span class="hljs-keyword">this</span>._getHistoryZoomContext(), {
                    focus: attributes.id,
                    focusType: <span class="hljs-string">'id'</span>,
                    order: <span class="hljs-string">'dep'</span>
                });
            }
    
            <span class="hljs-keyword">if</span> (markAsUnfocused) {
                (<span class="hljs-keyword">this</span>._devices[markAsUnfocused] || <span class="hljs-keyword">this</span>._programs[markAsUnfocused]).markAsFocused(<span class="hljs-literal">false</span>);
            }
    
            <span class="hljs-keyword">this</span>.triggerMethod.apply(<span class="hljs-keyword">this</span>, [<span class="hljs-string">'eventline:focus:request'</span>].concat([context, attributes]));
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-167">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-167">&#182;</a>
              </div>
              <p>Widget name click</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _onWidgetNameClick: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(attributes)</span> </span>{
            <span class="hljs-keyword">var</span> context = <span class="hljs-keyword">this</span>._getHistoryZoomContext();
            <span class="hljs-keyword">this</span>.triggerMethod.apply(<span class="hljs-keyword">this</span>, [<span class="hljs-string">'eventline:name:click'</span>].concat([context, attributes]));
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-168">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-168">&#182;</a>
              </div>
              <p>Notify widgets of the position of the ruler.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _notifyWidgetsOfRulerPosition: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">this</span>._notifyWidgetsOnRulerFocusChanged(<span class="hljs-keyword">this</span>._$ruler.position());
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-169">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-169">&#182;</a>
              </div>
              <p>Notify widgets that the ruler is at some <code>position</code> and dragged into some <code>direction</code>.
Direction can be âleftâ or ârightâ.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _notifyWidgetsOnRulerFocusChanged: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(position, direction)</span> </span>{
            <span class="hljs-keyword">var</span> offset = <span class="hljs-keyword">this</span>.options.theme.ruler.width / <span class="hljs-number">2</span>;
            <span class="hljs-keyword">var</span> coordinate = <span class="hljs-built_in">Math</span>.max(<span class="hljs-built_in">Math</span>.min((position.left + offset) / ( <span class="hljs-keyword">this</span>._$ruler.parent().width() - <span class="hljs-keyword">this</span>.options.theme.dashboard.sidebar.width), <span class="hljs-number">1</span>), <span class="hljs-number">0</span>);
    
            _.invoke([<span class="hljs-keyword">this</span>._focusline], <span class="hljs-string">'rulerFocusChanged'</span>, coordinate, direction || <span class="hljs-string">'left'</span>);
            _.invoke(<span class="hljs-keyword">this</span>._devices, <span class="hljs-string">'rulerFocusChanged'</span>, coordinate, direction || <span class="hljs-string">'left'</span>);
            _.invoke(<span class="hljs-keyword">this</span>._programs, <span class="hljs-string">'rulerFocusChanged'</span>, coordinate, direction || <span class="hljs-string">'left'</span>);
            _.invoke(_.pluck(<span class="hljs-keyword">this</span>._groups, <span class="hljs-string">'timeline'</span>), <span class="hljs-string">'rulerFocusChanged'</span>, coordinate, direction || <span class="hljs-string">'left'</span>);
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-170">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-170">&#182;</a>
              </div>
              <p>Update focusline.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _update_focusline_with_frame: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(frame, options)</span> </span>{
            <span class="hljs-keyword">if</span> (options &amp;&amp; options.live) {
                <span class="hljs-keyword">this</span>._domain = [<span class="hljs-built_in">Math</span>.max(<span class="hljs-keyword">this</span>._domain[<span class="hljs-number">0</span>], frame.timestamp - <span class="hljs-keyword">this</span>.options.livetrace.delayBeforeFlush), frame.timestamp];
            } <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-171">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-171">&#182;</a>
              </div>
              <p>Update domain.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">this</span>._domain = [<span class="hljs-built_in">Math</span>.min(<span class="hljs-keyword">this</span>._domain[<span class="hljs-number">0</span>], frame.timestamp), <span class="hljs-built_in">Math</span>.max(<span class="hljs-keyword">this</span>._domain[<span class="hljs-number">1</span>], frame.timestamp)];
            }</pre></div></div>
            
        </li>
        
        
        <li id="section-172">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-172">&#182;</a>
              </div>
              <p>Update focusline.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._focusline.update({
                timestamp: frame.timestamp,
                frame: {
                    value: frame.value? frame.value : _.size(frame.devices) + _.size(frame.programs)
                }
            }, <span class="hljs-keyword">this</span>._domain, options);
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-173">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-173">&#182;</a>
              </div>
              <p>Update all widgets attached to the dashboard according to some <code>frame</code> data.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _update_all_with_frame: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(frame, options)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-174">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-174">&#182;</a>
              </div>
              <p>Update focus</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._focus = <span class="hljs-keyword">this</span>._focusline.brush.empty()? <span class="hljs-keyword">this</span>._domain : <span class="hljs-keyword">this</span>._focusline.brush.extent();</pre></div></div>
            
        </li>
        
        
        <li id="section-175">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-175">&#182;</a>
              </div>
              <p>Update <em>Devices</em>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    
            <span class="hljs-keyword">var</span> updated_device_ids = [];</pre></div></div>
            
        </li>
        
        
        <li id="section-176">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-176">&#182;</a>
              </div>
              <p>update devices listed in frame</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            _.forEach(frame.devices, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(update)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-177">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-177">&#182;</a>
              </div>
              <p>Create device if it does not exit yet.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>._has_widget(<span class="hljs-string">'device'</span>, update.id)) {
                    <span class="hljs-keyword">this</span>._create_widget(<span class="hljs-string">'device'</span>, update);
                }</pre></div></div>
            
        </li>
        
        
        <li id="section-178">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-178">&#182;</a>
              </div>
              <p>Update it.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">this</span>._update_one_with_frame(<span class="hljs-string">'device'</span>, update.id, {
                    timestamp: frame.timestamp,
                    frame: update
                }, options);</pre></div></div>
            
        </li>
        
        
        <li id="section-179">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-179">&#182;</a>
              </div>
              <p>Mark as updated.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                updated_device_ids.push(update.id);
            }, <span class="hljs-keyword">this</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-180">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-180">&#182;</a>
              </div>
              <p>Update all other devices (timestamp only).</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            _.forEach(<span class="hljs-keyword">this</span>._devices, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(device, device_id)</span> </span>{
                <span class="hljs-keyword">if</span> (!_.contains(updated_device_ids, device_id)) {
                    <span class="hljs-keyword">this</span>._update_one_with_frame(<span class="hljs-string">'device'</span>, device_id, {timestamp: frame.timestamp}, options);
                }
            }, <span class="hljs-keyword">this</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-181">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-181">&#182;</a>
              </div>
              <p>Update <em>Programs</em>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    
            <span class="hljs-keyword">var</span> updated_program_ids = [];</pre></div></div>
            
        </li>
        
        
        <li id="section-182">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-182">&#182;</a>
              </div>
              <p>Update devices listed in frame.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            _.forEach(frame.programs, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(update)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-183">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-183">&#182;</a>
              </div>
              <p>Create program if it does not exit yet.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>._has_widget(<span class="hljs-string">'program'</span>, update.id)) {
                    <span class="hljs-keyword">this</span>._create_widget(<span class="hljs-string">'program'</span>, update);
                }</pre></div></div>
            
        </li>
        
        
        <li id="section-184">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-184">&#182;</a>
              </div>
              <p>Update it.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">this</span>._update_one_with_frame(<span class="hljs-string">'program'</span>, update.id, {
                    timestamp: frame.timestamp,
                    frame: update
                }, options);</pre></div></div>
            
        </li>
        
        
        <li id="section-185">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-185">&#182;</a>
              </div>
              <p>Mark as updated.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                updated_program_ids.push(update.id);
            }, <span class="hljs-keyword">this</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-186">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-186">&#182;</a>
              </div>
              <p>Update all other programs (timestamp only).</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            _.forEach(<span class="hljs-keyword">this</span>._programs, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(program, program_id)</span> </span>{
                <span class="hljs-keyword">if</span> (!_.contains(updated_program_ids, program_id)) {
                    <span class="hljs-keyword">this</span>._update_one_with_frame(<span class="hljs-string">'program'</span>, program_id, {timestamp: frame.timestamp}, options);
                }
            }, <span class="hljs-keyword">this</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-187">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-187">&#182;</a>
              </div>
              <p>Update <em>Groups</em>/</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            _.forEach(<span class="hljs-keyword">this</span>._groups, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(group)</span> </span>{
               group.timeline.update({
                   timestamp: frame.timestamp
               }, <span class="hljs-keyword">this</span>._focus, options);
            }, <span class="hljs-keyword">this</span>);
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-188">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-188">&#182;</a>
              </div>
              <p>Update a <code>what</code> (e.g. âprogramâ, âdeviceâ) widget with id <code>id</code> according to some <code>frame</code> data.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _update_one_with_frame: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(what, id, frame, options)</span> </span>{
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._has_widget(what, id)) {
                <span class="hljs-keyword">var</span> widget = what === <span class="hljs-string">'device'</span> ? <span class="hljs-keyword">this</span>._devices[id] : <span class="hljs-keyword">this</span>._programs[id];</pre></div></div>
            
        </li>
        
        
        <li id="section-189">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-189">&#182;</a>
              </div>
              <p>Attach the widget to its group if not attached</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">if</span> (widget.isDetached()) {
                    <span class="hljs-keyword">this</span>._attach_widget_to_group(widget);
                }
    
                widget.update(frame, <span class="hljs-keyword">this</span>._focus, options);
            }
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-190">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-190">&#182;</a>
              </div>
              <p>Check whether a <code>what</code> widget with id <code>id</code> exists.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _has_widget: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(what, id)</span> </span>{
            <span class="hljs-keyword">switch</span> (what) {
                <span class="hljs-keyword">case</span> <span class="hljs-string">'device'</span>:
                    <span class="hljs-keyword">return</span> _.has(<span class="hljs-keyword">this</span>._devices, id);
                <span class="hljs-keyword">case</span> <span class="hljs-string">'program'</span>:
                    <span class="hljs-keyword">return</span> _.has(<span class="hljs-keyword">this</span>._programs, id);
                <span class="hljs-keyword">default</span>:
                    <span class="hljs-literal">false</span>;
            }
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-191">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-191">&#182;</a>
              </div>
              <p>Create a group demultiplexer function from given <code>attributes</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _create_demux: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(attributes)</span> </span>{
            <span class="hljs-keyword">if</span> (attributes &amp;&amp; attributes.func) {
                <span class="hljs-keyword">switch</span> (attributes.func) {
                    <span class="hljs-keyword">case</span> <span class="hljs-string">'type'</span>: <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(item)</span> </span>{
                        <span class="hljs-keyword">return</span> item.type? {name: <span class="hljs-string">'Devices'</span>, order: <span class="hljs-number">2</span>} : {name: <span class="hljs-string">'Programs'</span>, order: <span class="hljs-number">4</span>}
                    };
                    <span class="hljs-keyword">default</span>: <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(item)</span> </span>{
                        <span class="hljs-keyword">return</span> { name: <span class="hljs-string">'Unknown'</span>, order: <span class="hljs-number">3</span> }
                    };
                }
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (attributes &amp;&amp; attributes.grouping) {
                <span class="hljs-keyword">return</span> (<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                    <span class="hljs-keyword">var</span> grouping = attributes.grouping;
    
                    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(item)</span> </span>{
                        <span class="hljs-keyword">var</span> group = _.find(grouping, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(group)</span> </span>{
                            <span class="hljs-keyword">return</span> _.indexOf(group.members, item.id) !== -<span class="hljs-number">1</span>;
                        });
    
                        <span class="hljs-keyword">if</span> (group) {
                            <span class="hljs-keyword">return</span> { name: group.name, order: group.order || <span class="hljs-number">3</span>};
                        } <span class="hljs-keyword">else</span> {
                            <span class="hljs-keyword">return</span> { name: <span class="hljs-string">'Unknown'</span>, order: <span class="hljs-number">3</span>};
                        }
                    };
                })();
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(item)</span> </span>{
                    <span class="hljs-keyword">return</span> <span class="hljs-string">'Unknown'</span>;
                };
            }
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-192">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-192">&#182;</a>
              </div>
              <p>Create focusline</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _create_focusline: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(mode)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-193">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-193">&#182;</a>
              </div>
              <p>Setup focusline specific options.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">var</span> focusline_options = defaultsDeep({
                    theme: {
                        dashboard: {
                            widget: {
                                height: <span class="hljs-keyword">this</span>.options.theme.focusline.height,
                                margin: <span class="hljs-keyword">this</span>.options.theme.focusline.margin
                            },
                            sidebar: {
                                width: <span class="hljs-number">0</span>
                            },
                            aside: {
                                width: <span class="hljs-number">0</span>
                            }
                        }
                    },
                    extra: {
                        svg: {
                            innerMargin: {
                                left: <span class="hljs-keyword">this</span>.options.theme.focusline.selector.handle.width,
                                right: <span class="hljs-keyword">this</span>.options.theme.focusline.selector.handle.width
                            }
                        }
                    }
                },
                {
                    theme: <span class="hljs-keyword">this</span>.options.theme
                });</pre></div></div>
            
        </li>
        
        
        <li id="section-194">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-194">&#182;</a>
              </div>
              <p>Setup focusline attributes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">var</span> focusline_attributes = {
                id: <span class="hljs-string">'default'</span>,
                orientation: <span class="hljs-string">'bottom'</span>,
                timeFormat: <span class="hljs-keyword">this</span>._d3_timeFormatMulti,
                live: mode == Debugger.DASHBOARD_MODE.LIVE ? <span class="hljs-literal">true</span> : <span class="hljs-literal">false</span>
            };</pre></div></div>
            
        </li>
        
        
        <li id="section-195">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-195">&#182;</a>
              </div>
              <p>Create focusline.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._focusline = <span class="hljs-keyword">new</span> Debugger.Widgets.Focusline(focusline_attributes, focusline_options);</pre></div></div>
            
        </li>
        
        
        <li id="section-196">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-196">&#182;</a>
              </div>
              <p>Bind dashboard to its events.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.listenTo(<span class="hljs-keyword">this</span>._focusline, <span class="hljs-string">'focus:change'</span>, <span class="hljs-keyword">this</span>._onFocusChange);
            <span class="hljs-keyword">this</span>.listenTo(<span class="hljs-keyword">this</span>._focusline, <span class="hljs-string">'brush:resize'</span>, <span class="hljs-keyword">this</span>._onBrushResize);</pre></div></div>
            
        </li>
        
        
        <li id="section-197">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-197">&#182;</a>
              </div>
              <p>Attach it to the dashboard.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._attach_widget(<span class="hljs-keyword">this</span>._focusline, <span class="hljs-keyword">this</span>._$header);
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-198">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-198">&#182;</a>
              </div>
              <p>Remove focusline</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _remove_focusline: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>._focusline) {
                <span class="hljs-keyword">return</span>;
            }</pre></div></div>
            
        </li>
        
        
        <li id="section-199">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-199">&#182;</a>
              </div>
              <p>Detach timeline.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._detach_widget(<span class="hljs-keyword">this</span>._focusline);</pre></div></div>
            
        </li>
        
        
        <li id="section-200">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-200">&#182;</a>
              </div>
              <p>Unbind dashboard to its events.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.stopListening(<span class="hljs-keyword">this</span>._focusline, <span class="hljs-string">'focus:change'</span>, <span class="hljs-keyword">this</span>._onFocusChange);
            <span class="hljs-keyword">this</span>.stopListening(<span class="hljs-keyword">this</span>._focusline, <span class="hljs-string">'brush:resize'</span>, <span class="hljs-keyword">this</span>._onBrushResize);</pre></div></div>
            
        </li>
        
        
        <li id="section-201">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-201">&#182;</a>
              </div>
              <p>Delete group.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>._focusline;
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-202">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-202">&#182;</a>
              </div>
              <p>Create the dashboard ruler.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _create_dashboard_ruler: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-203">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-203">&#182;</a>
              </div>
              <p>Create the ruler.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._$ruler = $(<span class="hljs-string">'&lt;div class="rule"&gt;&lt;div class="marker top"&gt;&lt;/div&gt;&lt;div class="line"&gt;&lt;/div&gt;&lt;div class="marker bottom"&gt;&lt;/div&gt;&lt;/div&gt;'</span>)
                .css({
                    <span class="hljs-string">'width'</span>: <span class="hljs-keyword">this</span>.options.theme.ruler.width,
                    <span class="hljs-string">'margin-left'</span>: <span class="hljs-keyword">this</span>.options.theme.dashboard.sidebar.width,
                    <span class="hljs-string">'left'</span>: <span class="hljs-keyword">this</span>._$group_container.width() - <span class="hljs-keyword">this</span>.options.theme.dashboard.sidebar.width -  <span class="hljs-keyword">this</span>.options.theme.ruler.width / <span class="hljs-number">2</span>
                });</pre></div></div>
            
        </li>
        
        
        <li id="section-204">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-204">&#182;</a>
              </div>
              <p>Attach it to the dashboard</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._$group_container.append(<span class="hljs-keyword">this</span>._$ruler);</pre></div></div>
            
        </li>
        
        
        <li id="section-205">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-205">&#182;</a>
              </div>
              <p>Make the ruler draggable.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._$ruler.draggable({
                axis: <span class="hljs-string">'x'</span>,
                containment: <span class="hljs-string">'parent'</span>,
                start: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(event, ui)</span> </span>{
                    <span class="hljs-keyword">this</span>.lastPosition = ui.position;
                },
                drag: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(event, ui)</span> </span>{
                    <span class="hljs-keyword">var</span> direction = (<span class="hljs-keyword">this</span>.lastPosition.left &gt; ui.position.left) ? <span class="hljs-string">'left'</span> : <span class="hljs-string">'right'</span>;
                    self._notifyWidgetsOnRulerFocusChanged(ui.position, direction);
                    <span class="hljs-keyword">this</span>.lastPosition = ui.position;
                }
            });
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-206">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-206">&#182;</a>
              </div>
              <p>Remove the dashboard ruler.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _remove_dashboard_ruler: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-207">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-207">&#182;</a>
              </div>
              <p>Remove ruler</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._$ruler.remove();</pre></div></div>
            
        </li>
        
        
        <li id="section-208">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-208">&#182;</a>
              </div>
              <p>Delete ruler.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>._$ruler;
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-209">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-209">&#182;</a>
              </div>
              <p>Create a new group with given <code>attributes</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _create_group: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(attributes)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-210">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-210">&#182;</a>
              </div>
              <p>Setup timeline options.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">var</span> timeline_options = {
                theme: <span class="hljs-keyword">this</span>.options.theme
            };</pre></div></div>
            
        </li>
        
        
        <li id="section-211">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-211">&#182;</a>
              </div>
              <p>Setup timeline attributes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">var</span> timeline_attributes = {
                id: _.uniqueId(<span class="hljs-string">'timeline'</span>),
                name: i18n.t(attributes.name, {ns: <span class="hljs-keyword">this</span>.options.i18n.ns}),
                orientation: <span class="hljs-string">'top'</span>,
                timeFormat: <span class="hljs-keyword">this</span>._d3_timeFormatMulti
            };</pre></div></div>
            
        </li>
        
        
        <li id="section-212">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-212">&#182;</a>
              </div>
              <p>Create timeline for the group.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">var</span> timeline = <span class="hljs-keyword">new</span> Debugger.Widgets.Timeline(timeline_attributes, timeline_options);</pre></div></div>
            
        </li>
        
        
        <li id="section-213">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-213">&#182;</a>
              </div>
              <p>Bind to focusline.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">if</span> (_.isFunction(timeline.onFocusChange)) {
                timeline.listenTo(<span class="hljs-keyword">this</span>._focusline, <span class="hljs-string">'focus:change'</span>, timeline.onFocusChange);
            }
    
            <span class="hljs-keyword">var</span> group = $(<span class="hljs-string">'&lt;div/&gt;'</span>)
                .attr({
                    id: _.uniqueId(<span class="hljs-string">'group'</span>),
                    <span class="hljs-keyword">class</span>: <span class="hljs-string">'group'</span>,
                    <span class="hljs-string">'data-name'</span>: attributes.name,
                    <span class="hljs-string">'data-order'</span>: attributes.order
                })
                .append(<span class="hljs-string">'&lt;header/&gt;'</span>)
                .append(<span class="hljs-string">'&lt;div class="element-container"&gt;&lt;/div&gt;'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-214">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-214">&#182;</a>
              </div>
              <p>Attach group to the dashboard.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._$group_container.append(group);</pre></div></div>
            
        </li>
        
        
        <li id="section-215">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-215">&#182;</a>
              </div>
              <p>Sort group by order then by name</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._$group_container.children().tsort(
                {attr: <span class="hljs-string">'data-order'</span>},
                {attr: <span class="hljs-string">'data-name'</span>}
            );</pre></div></div>
            
        </li>
        
        
        <li id="section-216">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-216">&#182;</a>
              </div>
              <p>Attach timeline to the group.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._attach_widget(timeline, group.find(<span class="hljs-string">'header'</span>)[<span class="hljs-number">0</span>]);</pre></div></div>
            
        </li>
        
        
        <li id="section-217">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-217">&#182;</a>
              </div>
              <p>Return group object.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">return</span> {
                $el: group,
                $container: group.find(<span class="hljs-string">'.element-container'</span>)[<span class="hljs-number">0</span>],
                timeline: timeline
            };
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-218">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-218">&#182;</a>
              </div>
              <p>Remove a group from the dashboard.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _remove_group: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(group)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-219">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-219">&#182;</a>
              </div>
              <p>Detach timeline.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._detach_widget(group.timeline);</pre></div></div>
            
        </li>
        
        
        <li id="section-220">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-220">&#182;</a>
              </div>
              <p>Remove the group $el.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            group.$el.remove();</pre></div></div>
            
        </li>
        
        
        <li id="section-221">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-221">&#182;</a>
              </div>
              <p>Delete group.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">delete</span> group.$el;
            <span class="hljs-keyword">delete</span> group.$container;
            <span class="hljs-keyword">delete</span> group.timeline;
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-222">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-222">&#182;</a>
              </div>
              <p>Create a new <code>what</code> widget with given <code>attributes</code>.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _create_widget: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(what, attributes)</span> </span>{
            <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
            <span class="hljs-keyword">var</span> widget = <span class="hljs-literal">undefined</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-223">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-223">&#182;</a>
              </div>
              <p>Define widget options.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">var</span> widget_options = {
                theme: <span class="hljs-keyword">this</span>.options.theme
            };</pre></div></div>
            
        </li>
        
        
        <li id="section-224">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-224">&#182;</a>
              </div>
              <p>Define widget common attributes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">var</span> widget_attributes = {
                id: attributes.id,
                focused: attributes.id == self._getState(<span class="hljs-string">'focus'</span>)
            };
    
            <span class="hljs-keyword">switch</span> (what) {
                <span class="hljs-keyword">case</span> <span class="hljs-string">'program'</span>:
                    widget = <span class="hljs-keyword">new</span> Debugger.Widgets.Program(widget_attributes, widget_options);
                    <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> <span class="hljs-string">'device'</span>:
                    widget_attributes[<span class="hljs-string">'type'</span>] = attributes.type;
                    <span class="hljs-keyword">switch</span> (attributes.type) {
                        <span class="hljs-keyword">case</span> <span class="hljs-string">'Temperature'</span>:
                            widget = <span class="hljs-keyword">new</span> Debugger.Widgets.Temperature(widget_attributes, widget_options);
                            <span class="hljs-keyword">break</span>;
                        <span class="hljs-keyword">case</span> <span class="hljs-string">'Illumination'</span>:
                            widget = <span class="hljs-keyword">new</span> Debugger.Widgets.Illumination(widget_attributes, widget_options);
                            <span class="hljs-keyword">break</span>;
                        <span class="hljs-keyword">case</span> <span class="hljs-string">'Switch'</span>:
                            widget = <span class="hljs-keyword">new</span> Debugger.Widgets.Switch(widget_attributes, widget_options);
                            <span class="hljs-keyword">break</span>;
                        <span class="hljs-keyword">case</span> <span class="hljs-string">'Contact'</span>:
                            widget = <span class="hljs-keyword">new</span> Debugger.Widgets.Contact(widget_attributes, widget_options);
                            <span class="hljs-keyword">break</span>;
                        <span class="hljs-keyword">case</span> <span class="hljs-string">'KeyCardSwitch'</span>:
                            widget = <span class="hljs-keyword">new</span> Debugger.Widgets.KeycardSwitch(widget_attributes, widget_options);
                            <span class="hljs-keyword">break</span>;
                        <span class="hljs-keyword">case</span> <span class="hljs-string">'SmartPlug'</span>:
                            widget = <span class="hljs-keyword">new</span> Debugger.Widgets.SmartPlug(widget_attributes, widget_options);
                            <span class="hljs-keyword">break</span>;
                        <span class="hljs-keyword">case</span> <span class="hljs-string">'ColorLight'</span>:
                            widget = <span class="hljs-keyword">new</span> Debugger.Widgets.ColorLight(widget_attributes, widget_options);
                            <span class="hljs-keyword">break</span>;
                        <span class="hljs-keyword">case</span> <span class="hljs-string">'DomiCube'</span>:
                            widget = <span class="hljs-keyword">new</span> Debugger.Widgets.DomiCube(widget_attributes, widget_options);
                            <span class="hljs-keyword">break</span>;
                        <span class="hljs-keyword">case</span> <span class="hljs-string">'MediaPlayer'</span>:
                            widget = <span class="hljs-keyword">new</span> Debugger.Widgets.MediaPlayer(widget_attributes, widget_options);
                            <span class="hljs-keyword">break</span>;
                    }
                    <span class="hljs-keyword">break</span>;
            }
    
            <span class="hljs-keyword">if</span> (widget) {</pre></div></div>
            
        </li>
        
        
        <li id="section-225">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-225">&#182;</a>
              </div>
              <p>Keep track of new created widget.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">switch</span> (what) {
                    <span class="hljs-keyword">case</span> <span class="hljs-string">'device'</span>:
                        <span class="hljs-keyword">this</span>._devices[attributes.id] = widget;
                        <span class="hljs-keyword">break</span>;
                    <span class="hljs-keyword">case</span> <span class="hljs-string">'program'</span>:
                        <span class="hljs-keyword">this</span>._programs[attributes.id] = widget;
                        <span class="hljs-keyword">break</span>;
                }</pre></div></div>
            
        </li>
        
        
        <li id="section-226">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-226">&#182;</a>
              </div>
              <p>Bind to focusline.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">if</span> (_.isFunction(widget.onFocusChange)) {
                    widget.listenTo(<span class="hljs-keyword">this</span>._focusline, <span class="hljs-string">'focus:change'</span>, widget.onFocusChange);
                }</pre></div></div>
            
        </li>
        
        
        <li id="section-227">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-227">&#182;</a>
              </div>
              <p>Bind dashboard to widget events.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">this</span>.listenTo(widget, <span class="hljs-string">'marker:click'</span>, <span class="hljs-keyword">this</span>._onWidgetMarkerClick);
                <span class="hljs-keyword">this</span>.listenTo(widget, <span class="hljs-string">'eventline:focus:request'</span>, <span class="hljs-keyword">this</span>._onWidgetFocusRequest);
                <span class="hljs-keyword">this</span>.listenTo(widget, <span class="hljs-string">'eventline:name:click'</span>, <span class="hljs-keyword">this</span>._onWidgetNameClick);</pre></div></div>
            
        </li>
        
        
        <li id="section-228">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-228">&#182;</a>
              </div>
              <p>Find and attach it to the group to which it belongs.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">this</span>._attach_widget_to_group(widget);
            } <span class="hljs-keyword">else</span> {
                Debugger.logger.error(<span class="hljs-string">'Unable to create instance of type `#{type}` with:\n\n'</span>+<span class="hljs-built_in">JSON</span>.stringify(attributes), attributes);
            }
    
            <span class="hljs-keyword">return</span> widget;
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-229">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-229">&#182;</a>
              </div>
              <p>Attach a widget to a group within this dashboard.
If the group if not created then it creates the group first.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _attach_widget_to_group: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(widget)</span> </span>{
            <span class="hljs-keyword">var</span> group = <span class="hljs-keyword">this</span>._demux(widget.attributes);</pre></div></div>
            
        </li>
        
        
        <li id="section-230">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-230">&#182;</a>
              </div>
              <p>If group is not created then create it.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">if</span> (_.isUndefined(<span class="hljs-keyword">this</span>._groups[group.name])) {
                <span class="hljs-keyword">this</span>._groups[group.name] = <span class="hljs-keyword">this</span>._create_group({
                    name: group.name,
                    order: group.order
                });
            }</pre></div></div>
            
        </li>
        
        
        <li id="section-231">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-231">&#182;</a>
              </div>
              <p>Attach it to the group in the DOM.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._attach_widget(widget, <span class="hljs-keyword">this</span>._groups[group.name].$container);
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-232">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-232">&#182;</a>
              </div>
              <p>Attach a widget to a target element within this dashboard.
If multiple elements match the target then the widget is appended to the first found.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _attach_widget: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(widget, target)</span> </span>{
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.$(widget.el).length &gt; <span class="hljs-number">0</span>) {
                throwError(<span class="hljs-string">"Widget #{widget} already attached to dashboard."</span>, { widget: widget});
            }
    
            <span class="hljs-keyword">if</span> (target) {
                <span class="hljs-keyword">this</span>.$(target).first().append(widget.$el);
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">this</span>._$group_container.append(widget.$el);
            }
    
            <span class="hljs-keyword">this</span>.triggerMethod.apply(widget, [<span class="hljs-string">'attached'</span>].concat(<span class="hljs-keyword">this</span>.$el));
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-233">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-233">&#182;</a>
              </div>
              <p>Detach a widget from this dashboard.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _detach_widget: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(widget)</span> </span>{
            <span class="hljs-keyword">var</span> parent = widget.$el.parent();
    
            <span class="hljs-keyword">this</span>.triggerMethod.apply(widget, [<span class="hljs-string">'detached'</span>].concat(parent));
    
            widget.$el.detach();
        }
    });</pre></div></div>
            
        </li>
        
        
        <li id="section-234">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-234">&#182;</a>
              </div>
              <h2 id="widgets">Widgets</h2>

            </div>
            
        </li>
        
        
        <li id="section-235">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-235">&#182;</a>
              </div>
              
            </div>
            
        </li>
        
        
        <li id="section-236">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-236">&#182;</a>
              </div>
              <p>AppsGate <strong>Widgets</strong> are the base elements of the AppsGate Dashboard.</p>

            </div>
            
        </li>
        
        
        <li id="section-237">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-237">&#182;</a>
              </div>
              <p>Define <code>Debugger.Widgets</code> namespace.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    <span class="hljs-keyword">var</span> Widgets = Debugger.Widgets = {};</pre></div></div>
            
        </li>
        
        
        <li id="section-238">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-238">&#182;</a>
              </div>
              <p>Create a new Widget with the specified attributes.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    Widgets.Widget = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(attributes, options)</span> </span>{
        <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
    
        <span class="hljs-keyword">this</span>.attributes = defaultsDeep(attributes || {}, _.result(<span class="hljs-keyword">this</span>, <span class="hljs-string">'defaults'</span>));</pre></div></div>
            
        </li>
        
        
        <li id="section-239">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-239">&#182;</a>
              </div>
              <p>Check if an <em>id</em> and a <em>kind</em> is given</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _.forEach([<span class="hljs-string">'id'</span>, <span class="hljs-string">'kind'</span>], <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(key)</span> </span>{
            _.has(self.attributes, key) || throwError(<span class="hljs-string">'You must specify some *#{key}* to create a Widget.'</span>, { key: key});
        });
    
        _.bindAll(<span class="hljs-keyword">this</span>);
    
        <span class="hljs-keyword">this</span>.exprs = {};
        <span class="hljs-keyword">this</span>.buffer = <span class="hljs-keyword">new</span> Debugger.SmartBuffer(<span class="hljs-keyword">this</span>.attributes.buffer);
        <span class="hljs-keyword">this</span>.gid = <span class="hljs-keyword">this</span>.attributes.kind + <span class="hljs-string">"-"</span> + sluggify(<span class="hljs-keyword">this</span>.attributes.id);
    
        <span class="hljs-keyword">if</span> (_.isFunction(<span class="hljs-keyword">this</span>.initialize)) {
            <span class="hljs-keyword">this</span>.initialize(options);
        }
    };
    
    Widgets.Widget.extend = Debugger.extend;</pre></div></div>
            
        </li>
        
        
        <li id="section-240">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-240">&#182;</a>
              </div>
              <p>Attach all inheritable methods to the Widget prototype.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    _.extend(Widgets.Widget.prototype, Backbone.Events, {</pre></div></div>
            
        </li>
        
        
        <li id="section-241">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-241">&#182;</a>
              </div>
              <p>Initialize widget with default options.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        initialize: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(options)</span> </span>{
            <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-242">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-242">&#182;</a>
              </div>
              <p>set default options in case some is omitted</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.options = defaultsDeep({}, options, {
                theme: THEMES_BASIC,
                extra: {
                    svg: {
                        innerMargin: {
                            top: <span class="hljs-number">0</span>,
                            left: <span class="hljs-number">0</span>,
                            bottom: <span class="hljs-number">0</span>,
                            right: <span class="hljs-number">0</span>
                        }
                    }
                }
            });</pre></div></div>
            
        </li>
        
        
        <li id="section-243">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-243">&#182;</a>
              </div>
              <p>Compute expressions</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.compute(<span class="hljs-string">'svg.width'</span>, <span class="hljs-string">'this.options.theme.dashboard.width - this.options.extra.svg.innerMargin.left - this.options.extra.svg.innerMargin.right - this.options.theme.dashboard.sidebar.width - this.options.theme.dashboard.widget.margin.left - this.options.theme.dashboard.widget.margin.right'</span>);
            <span class="hljs-keyword">this</span>.compute(<span class="hljs-string">'svg.height'</span>, <span class="hljs-string">'this.options.theme.dashboard.widget.height - this.options.extra.svg.innerMargin.top - this.options.extra.svg.innerMargin.bottom - this.options.theme.dashboard.widget.margin.top - this.options.theme.dashboard.widget.margin.bottom'</span>);
            <span class="hljs-keyword">this</span>.compute(<span class="hljs-string">'widget.height'</span>, <span class="hljs-string">'this.options.theme.dashboard.widget.height - this.options.theme.dashboard.widget.margin.top - this.options.theme.dashboard.widget.margin.bottom'</span>);
    
            <span class="hljs-keyword">this</span>._initUI();
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-244">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-244">&#182;</a>
              </div>
              <p>Internal handler triggered when a widget is attached <code>to</code> a dashboard.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        onAttached: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(to)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-245">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-245">&#182;</a>
              </div>
              <p>Set ourselves as attached.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.isAttached = <span class="hljs-literal">true</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-246">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-246">&#182;</a>
              </div>
              <p>Initialize D3.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._initD3(to);
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-247">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-247">&#182;</a>
              </div>
              <p>Handle <code>before:init:UI</code> event.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        onBeforeInitUI: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{ <span class="hljs-comment">/* default implementation: do nothing */</span> },</pre></div></div>
            
        </li>
        
        
        <li id="section-248">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-248">&#182;</a>
              </div>
              <p>Internal method to initialize the user interface.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _initUI: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">var</span> args = <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-249">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-249">&#182;</a>
              </div>
              <p>Notify that we are going to initialize UI.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.triggerMethod.apply(<span class="hljs-keyword">this</span>, [<span class="hljs-string">'before:init:UI'</span>].concat(args));</pre></div></div>
            
        </li>
        
        
        <li id="section-250">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-250">&#182;</a>
              </div>
              <p>Create main element</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.$el = $(<span class="hljs-string">'&lt;div/&gt;'</span>)
                .attr({
                    id: <span class="hljs-keyword">this</span>.gid
                })
                .addClass(<span class="hljs-string">'element'</span>)
                .css({
                    <span class="hljs-string">'margin-top'</span>: <span class="hljs-keyword">this</span>.options.theme.dashboard.widget.margin.top,
                    <span class="hljs-string">'margin-left'</span>: <span class="hljs-keyword">this</span>.options.theme.dashboard.widget.margin.left,
                    <span class="hljs-string">'margin-bottom'</span>: <span class="hljs-keyword">this</span>.options.theme.dashboard.widget.margin.bottom,
                    <span class="hljs-string">'margin-right'</span>: <span class="hljs-keyword">this</span>.options.theme.dashboard.widget.margin.right
                })
                .append(<span class="hljs-string">'&lt;div class="placeholder sidebar"&gt;&lt;/div&gt;'</span>)
                .append(<span class="hljs-string">'&lt;div class="placeholder d3"&gt;&lt;/div&gt;'</span>)
                .append(<span class="hljs-string">'&lt;div class="placeholder aside"&gt;&lt;/div&gt;'</span>);
            <span class="hljs-keyword">this</span>.el = <span class="hljs-keyword">this</span>.$el[<span class="hljs-number">0</span>];</pre></div></div>
            
        </li>
        
        
        <li id="section-251">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-251">&#182;</a>
              </div>
              <p>Create <code>sidebar</code> placeholder located at the left of d3 placeholder.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._$sidebar = <span class="hljs-keyword">this</span>.$(<span class="hljs-string">'.placeholder.sidebar'</span>).css({
                <span class="hljs-string">'width'</span>: <span class="hljs-keyword">this</span>.options.theme.dashboard.sidebar.width,
                <span class="hljs-string">'height'</span>: <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'svg.height'</span>) + <span class="hljs-keyword">this</span>.options.extra.svg.innerMargin.top + <span class="hljs-keyword">this</span>.options.extra.svg.innerMargin.bottom
            });
            <span class="hljs-keyword">this</span>._$sidemenu = $(<span class="hljs-string">'&lt;div/&gt;'</span>).addClass(<span class="hljs-string">'menu'</span>);
            <span class="hljs-keyword">this</span>._$name = $(<span class="hljs-string">'&lt;div/&gt;'</span>).addClass(<span class="hljs-string">'title'</span>).css({
                <span class="hljs-string">'line-height'</span>: <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'svg.height'</span>) + <span class="hljs-keyword">this</span>.options.extra.svg.innerMargin.top + <span class="hljs-keyword">this</span>.options.extra.svg.innerMargin.bottom + <span class="hljs-string">'px'</span>
            });
            <span class="hljs-keyword">this</span>._$sidebar.append(<span class="hljs-keyword">this</span>._$sidemenu, <span class="hljs-keyword">this</span>._$name);</pre></div></div>
            
        </li>
        
        
        <li id="section-252">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-252">&#182;</a>
              </div>
              <p>Create <code>D3</code> placeholder (where we draw).</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._$d3 = <span class="hljs-keyword">this</span>.$(<span class="hljs-string">'.placeholder.d3'</span>).css({
                <span class="hljs-string">'width'</span>: <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'svg.width'</span>) + <span class="hljs-keyword">this</span>.options.extra.svg.innerMargin.left + <span class="hljs-keyword">this</span>.options.extra.svg.innerMargin.right,
                <span class="hljs-string">'height'</span>: <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'widget.height'</span>)
            }).append(BASE_SVG);</pre></div></div>
            
        </li>
        
        
        <li id="section-253">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-253">&#182;</a>
              </div>
              <p>Create <code>aside</code> placeholder located/floating around the ruler.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._$aside = <span class="hljs-keyword">this</span>.$(<span class="hljs-string">'.placeholder.aside'</span>).css({
                <span class="hljs-string">'height'</span>: <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'widget.height'</span>),
                <span class="hljs-string">'visibility'</span>: <span class="hljs-string">'hidden'</span>
            });</pre></div></div>
            
        </li>
        
        
        <li id="section-254">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-254">&#182;</a>
              </div>
              <p>Notify that we are initializing UI.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.triggerMethod.apply(<span class="hljs-keyword">this</span>, [<span class="hljs-string">'init:UI'</span>].concat(args));
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-255">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-255">&#182;</a>
              </div>
              <p>Handle <code>init:UI</code> event.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        onInitUI: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{ <span class="hljs-comment">/* default implementation: do nothing */</span> },</pre></div></div>
            
        </li>
        
        
        <li id="section-256">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-256">&#182;</a>
              </div>
              <p>jQuery delegate for element lookup, scoped to DOM elements within the
current view. This should be preferred to global lookups where possible.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        $: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(selector)</span> </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.$el.find(selector);
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-257">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-257">&#182;</a>
              </div>
              <p>Handle <code>before:init:D3</code> event.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        onBeforeInitD3: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{ <span class="hljs-comment">/* default implementation: do nothing */</span> },</pre></div></div>
            
        </li>
        
        
        <li id="section-258">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-258">&#182;</a>
              </div>
              <p>Internal method to initialize D3.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _initD3: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(to)</span> </span>{
            <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
            <span class="hljs-keyword">var</span> args = <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-259">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-259">&#182;</a>
              </div>
              <p>Notify that we are going to initialized d3</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.triggerMethod.apply(<span class="hljs-keyword">this</span>, [<span class="hljs-string">'before:init:d3'</span>].concat(args));</pre></div></div>
            
        </li>
        
        
        <li id="section-260">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-260">&#182;</a>
              </div>
              <p>Initialize D3 SVG object.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.svg = d3.select(<span class="hljs-keyword">this</span>._$d3[<span class="hljs-number">0</span>]).select(<span class="hljs-string">"svg"</span>).attr({
                <span class="hljs-string">'width'</span>: <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'svg.width'</span>)  + <span class="hljs-keyword">this</span>.options.extra.svg.innerMargin.left + <span class="hljs-keyword">this</span>.options.extra.svg.innerMargin.right,
                <span class="hljs-string">'height'</span>: <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'widget.height'</span>)
            }).append(<span class="hljs-string">"g"</span>)
                .attr(<span class="hljs-string">'transform'</span>, <span class="hljs-string">'translate('</span>+ <span class="hljs-keyword">this</span>.options.extra.svg.innerMargin.left + <span class="hljs-string">', '</span>+ <span class="hljs-keyword">this</span>.options.extra.svg.innerMargin.top +<span class="hljs-string">')'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-261">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-261">&#182;</a>
              </div>
              <p>Setup D3 functions.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.dateFn = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(timestamp)</span> </span>{
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(timestamp)
            };</pre></div></div>
            
        </li>
        
        
        <li id="section-262">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-262">&#182;</a>
              </div>
              <p>Setup D3 timescale.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.timescale = d3.time.scale()
                .range([<span class="hljs-number">0</span>, <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'svg.width'</span>)])
                .clamp(<span class="hljs-literal">true</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-263">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-263">&#182;</a>
              </div>
              <p>Notify that we are initializing d3</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.triggerMethod.apply(<span class="hljs-keyword">this</span>, [<span class="hljs-string">'init:d3'</span>].concat(args));
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-264">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-264">&#182;</a>
              </div>
              <p>Handle <code>init:D3</code> event.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        onInitD3: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{ <span class="hljs-comment">/* default implementation: do nothing */</span> },</pre></div></div>
            
        </li>
        
        
        <li id="section-265">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-265">&#182;</a>
              </div>
              <p>Check if the widget is currently attached to a dashboard.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        isDetached: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">return</span> !<span class="hljs-keyword">this</span>.isAttached;
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-266">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-266">&#182;</a>
              </div>
              <p>Internal handler triggered when a widget is detached <code>from</code> a dashboard.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        onDetached: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(from)</span> </span>{
            <span class="hljs-keyword">var</span> args = <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-267">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-267">&#182;</a>
              </div>
              <p>Set ourselves as detached.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.isAttached = <span class="hljs-literal">false</span>;
    
            <span class="hljs-keyword">this</span>._destroyD3();
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-268">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-268">&#182;</a>
              </div>
              <p>Handle <code>before:destroy:D3</code> event.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        onBeforeDestroyD3: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{ <span class="hljs-comment">/* default implementation: do nothing */</span> },</pre></div></div>
            
        </li>
        
        
        <li id="section-269">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-269">&#182;</a>
              </div>
              <p>Internal handler triggered when a widget is destroyed.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _destroyD3: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">var</span> args = <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-270">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-270">&#182;</a>
              </div>
              <p>Notify that we are going to destroy d3.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.triggerMethod.apply(<span class="hljs-keyword">this</span>, [<span class="hljs-string">'before:destroy:d3'</span>].concat(args));</pre></div></div>
            
        </li>
        
        
        <li id="section-271">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-271">&#182;</a>
              </div>
              <p>Cleanup SVG.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.svg.remove();
            <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.svg;</pre></div></div>
            
        </li>
        
        
        <li id="section-272">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-272">&#182;</a>
              </div>
              <p>Cleanup buffer.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.buffer.clear();</pre></div></div>
            
        </li>
        
        
        <li id="section-273">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-273">&#182;</a>
              </div>
              <p>Notify that we are destroying d3.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.triggerMethod.apply(<span class="hljs-keyword">this</span>, [<span class="hljs-string">'destroy:d3'</span>].concat(args));
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-274">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-274">&#182;</a>
              </div>
              <p>Handle <code>destroy:D3</code> event.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        onDestroyD3: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{ <span class="hljs-comment">/* default implementation: do nothing */</span> },</pre></div></div>
            
        </li>
        
        
        <li id="section-275">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-275">&#182;</a>
              </div>
              <p>Handle <code>before:reset:D3</code> event.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        onBeforeResetD3: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{ <span class="hljs-comment">/* default implementation: do nothing */</span> },</pre></div></div>
            
        </li>
        
        
        <li id="section-276">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-276">&#182;</a>
              </div>
              <p>Reset the widget</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        reset: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">var</span> args = <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-277">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-277">&#182;</a>
              </div>
              <p>Notify that we are going to reset d3.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.triggerMethod.apply(<span class="hljs-keyword">this</span>, [<span class="hljs-string">'before:reset:d3'</span>].concat(args));
    
            <span class="hljs-keyword">this</span>._destroyD3();
            <span class="hljs-keyword">this</span>._initD3();</pre></div></div>
            
        </li>
        
        
        <li id="section-278">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-278">&#182;</a>
              </div>
              <p>Notify that we are resetting d3.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.triggerMethod.apply(<span class="hljs-keyword">this</span>, [<span class="hljs-string">'reset:d3'</span>].concat(args));
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-279">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-279">&#182;</a>
              </div>
              <p>Handle <code>reset:D3</code> event.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        onResetD3: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{ <span class="hljs-comment">/* default implementation: do nothing */</span> },</pre></div></div>
            
        </li>
        
        
        <li id="section-280">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-280">&#182;</a>
              </div>
              <p>Return the value of a computed property.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        computed: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(property)</span> </span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.exprs[property].value;
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-281">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-281">&#182;</a>
              </div>
              <p>Compute the value of a <code>property&#39; given some</code>expression`.
@warning the value is not automatically recomputed.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        compute: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(property, expression)</span> </span>{
            <span class="hljs-keyword">this</span>.exprs[property] = {
                expression: expression,
                value: <span class="hljs-built_in">eval</span>(expression)
            };
    
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.exprs[property].value;
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-282">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-282">&#182;</a>
              </div>
              <p>Handle <code>before:frame:update</code> event.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        onBeforeFrameUpdate: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{ <span class="hljs-comment">/* default implementation: do nothing */</span> },</pre></div></div>
            
        </li>
        
        
        <li id="section-283">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-283">&#182;</a>
              </div>
              <p>Internal method to update the widget with new data.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        update: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(data, focus, options)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-284">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-284">&#182;</a>
              </div>
              <p>Set default options.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            options = _.defaults({}, options, {
                render: <span class="hljs-literal">true</span>
            });</pre></div></div>
            
        </li>
        
        
        <li id="section-285">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-285">&#182;</a>
              </div>
              <p>Build up args for callback.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">var</span> args = <span class="hljs-built_in">Array</span>.prototype.slice.call([data, focus, options]);</pre></div></div>
            
        </li>
        
        
        <li id="section-286">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-286">&#182;</a>
              </div>
              <p>Notify that we are going to update.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.triggerMethod.apply(<span class="hljs-keyword">this</span>, [<span class="hljs-string">'before:frame:update'</span>].concat(args));</pre></div></div>
            
        </li>
        
        
        <li id="section-287">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-287">&#182;</a>
              </div>
              <p>Collect new data.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">if</span> (data &amp;&amp; data.bulk) {
                <span class="hljs-keyword">this</span>.buffer.concat(data.bulk)
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (data &amp;&amp; data.timestamp) {
                <span class="hljs-keyword">this</span>.buffer.push(data.timestamp, data.frame);
            }</pre></div></div>
            
        </li>
        
        
        <li id="section-288">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-288">&#182;</a>
              </div>
              <p>Clear data if live mode is one</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">if</span> (options &amp;&amp; options.live) {
                <span class="hljs-keyword">this</span>.buffer.flushBefore(focus[<span class="hljs-number">0</span>]);
            }</pre></div></div>
            
        </li>
        
        
        <li id="section-289">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-289">&#182;</a>
              </div>
              <p>Notify that we are updating.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.triggerMethod.apply(<span class="hljs-keyword">this</span>, [<span class="hljs-string">'frame:update'</span>].concat(args));</pre></div></div>
            
        </li>
        
        
        <li id="section-290">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-290">&#182;</a>
              </div>
              <p>Render only if required.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">if</span> (options &amp;&amp; options.render) {
                <span class="hljs-keyword">this</span>.timescale.domain(focus);
                <span class="hljs-keyword">this</span>._render();
            }
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-291">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-291">&#182;</a>
              </div>
              <p>Handle <code>frame:update</code> event.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        onFrameUpdate: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{ <span class="hljs-comment">/* default implementation: do nothing */</span> },</pre></div></div>
            
        </li>
        
        
        <li id="section-292">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-292">&#182;</a>
              </div>
              <p>Handle <code>before:render</code> event.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        onBeforeRender: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{ <span class="hljs-comment">/* default implementation: do nothing */</span> },</pre></div></div>
            
        </li>
        
        
        <li id="section-293">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-293">&#182;</a>
              </div>
              <p>Internal method to render the widget.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _render: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">var</span> args = <span class="hljs-built_in">Array</span>.prototype.slice.call(<span class="hljs-built_in">arguments</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-294">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-294">&#182;</a>
              </div>
              <p>Notify that we are going to render.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.triggerMethod.apply(<span class="hljs-keyword">this</span>, [<span class="hljs-string">'before:render'</span>].concat(args));</pre></div></div>
            
        </li>
        
        
        <li id="section-295">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-295">&#182;</a>
              </div>
              <p>nothing to renderâ¦</p>

            </div>
            
        </li>
        
        
        <li id="section-296">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-296">&#182;</a>
              </div>
              <p>Notify that we are rendering.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.triggerMethod.apply(<span class="hljs-keyword">this</span>, [<span class="hljs-string">'render'</span>].concat(args));
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-297">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-297">&#182;</a>
              </div>
              <p>Handle <code>render</code> event.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        onRender: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{ <span class="hljs-comment">/* default implementation: do nothing */</span> },</pre></div></div>
            
        </li>
        
        
        <li id="section-298">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-298">&#182;</a>
              </div>
              <p>Handle <code>before:ruler:focus:update</code> event.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        onBeforeRulerFocusUpdate: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{ <span class="hljs-comment">/* default implementation: do nothing */</span> },</pre></div></div>
            
        </li>
        
        
        <li id="section-299">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-299">&#182;</a>
              </div>
              <p>Internal method to notifying widget that the rulerâs focus just changed.
<code>Coordinate</code> is the coordinate of the ruler between [0..1].
<code>Direction</code> is the <code>left</code> or <code>right</code> direction in which the ruler was dragged.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        rulerFocusChanged: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(coordinate, direction, options)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-300">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-300">&#182;</a>
              </div>
              <p>Set default options.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            options = defaultsDeep({}, options, {
                delta: <span class="hljs-keyword">this</span>.options.theme.ruler.lookahead
            });</pre></div></div>
            
        </li>
        
        
        <li id="section-301">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-301">&#182;</a>
              </div>
              <p>Keep track of last focused frame.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._lastFocusedFrame = <span class="hljs-keyword">this</span>._focusedFrame;</pre></div></div>
            
        </li>
        
        
        <li id="section-302">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-302">&#182;</a>
              </div>
              <p>Get exact matching timestamp.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">var</span> exactTimestamp = <span class="hljs-keyword">this</span>.timescale.invert(<span class="hljs-keyword">this</span>.timescale.range()[<span class="hljs-number">1</span>]*coordinate).getTime();</pre></div></div>
            
        </li>
        
        
        <li id="section-303">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-303">&#182;</a>
              </div>
              <p>Get new focused frame.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._focusedFrame = <span class="hljs-keyword">this</span>._findFocusedFrame(coordinate, direction, exactTimestamp, options.delta);
    
            <span class="hljs-keyword">this</span>.triggerMethod.apply(<span class="hljs-keyword">this</span>, [<span class="hljs-string">'before:ruler:focus:update'</span>, coordinate, direction, exactTimestamp, <span class="hljs-keyword">this</span>._focusedFrame, <span class="hljs-keyword">this</span>._lastFocusedFrame]);</pre></div></div>
            
        </li>
        
        
        <li id="section-304">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-304">&#182;</a>
              </div>
              <p>Update the name of his widget.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">if</span> (ensure(<span class="hljs-keyword">this</span>._focusedFrame, <span class="hljs-string">'data.name'</span>)) {
                <span class="hljs-keyword">this</span>._$name.text(<span class="hljs-keyword">this</span>._focusedFrame.data.name);
            }</pre></div></div>
            
        </li>
        
        
        <li id="section-305">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-305">&#182;</a>
              </div>
              <p>Hide widget if it does not have any state (meaning it disappeared).</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">if</span> (missing(<span class="hljs-keyword">this</span>._focusedFrame, <span class="hljs-string">'data.event.state'</span>)) {
                <span class="hljs-keyword">this</span>.$el.css(<span class="hljs-string">'opacity'</span>, <span class="hljs-keyword">this</span>.options.theme.element.inactive.opacity);
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">this</span>.$el.css(<span class="hljs-string">'opacity'</span>, <span class="hljs-keyword">this</span>.options.theme.element.active.opacity);
            }
    
            <span class="hljs-keyword">this</span>.triggerMethod.apply(<span class="hljs-keyword">this</span>, [<span class="hljs-string">'ruler:focus:update'</span>, coordinate, direction, exactTimestamp, <span class="hljs-keyword">this</span>._focusedFrame, <span class="hljs-keyword">this</span>._lastFocusedFrame]);
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-306">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-306">&#182;</a>
              </div>
              <p>Handle <code>ruler:focus:update</code> event.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        onRulerFocusUpdate: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{ <span class="hljs-comment">/* default implementation: do nothing */</span> },</pre></div></div>
            
        </li>
        
        
        <li id="section-307">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-307">&#182;</a>
              </div>
              <p>Internal method used to find the focused frame.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        _findFocusedFrame: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(coordinate, direction, exactTimestamp, delta)</span> </span>{
            <span class="hljs-keyword">var</span> position = <span class="hljs-keyword">this</span>.timescale.range()[<span class="hljs-number">1</span>] * coordinate;</pre></div></div>
            
        </li>
        
        
        <li id="section-308">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-308">&#182;</a>
              </div>
              <p>Workout timestamp interval.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">var</span> minTimestamp = <span class="hljs-keyword">this</span>.timescale.invert(<span class="hljs-built_in">parseInt</span>(position-delta)).getTime();
            <span class="hljs-keyword">var</span> maxTimestamp = <span class="hljs-keyword">this</span>.timescale.invert(<span class="hljs-built_in">parseInt</span>(position+delta)).getTime();
    
            <span class="hljs-keyword">var</span> focusedFrame = <span class="hljs-keyword">this</span>.buffer.inside(
                [direction == <span class="hljs-string">'left'</span> ? minTimestamp : exactTimestamp, direction == <span class="hljs-string">'right'</span> ? maxTimestamp : exactTimestamp],
                direction
            );
    
            <span class="hljs-keyword">return</span> focusedFrame;
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-309">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-309">&#182;</a>
              </div>
              <p>Import the <code>triggerMethod</code> to trigger events with corresponding
methods if the method exists</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        triggerMethod: Debugger.triggerMethod
    });</pre></div></div>
            
        </li>
        
        
        <li id="section-310">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-310">&#182;</a>
              </div>
              <h2 id="widgets-mixins-">Widgetsâ mixins.</h2>

            </div>
            
        </li>
        
        
        <li id="section-311">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-311">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>    
    Widgets.Mixins = {</pre></div></div>
            
        </li>
        
        
        <li id="section-312">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-312">&#182;</a>
              </div>
              <p><strong>StateChart mixin.</strong></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        StateChart: {
            initD3StateChart: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
                <span class="hljs-keyword">this</span>.state_chart = <span class="hljs-keyword">this</span>.svg.insert(<span class="hljs-string">'g'</span>, <span class="hljs-string">'.markers'</span>).attr({<span class="hljs-keyword">class</span>: <span class="hljs-string">'state area'</span>}).selectAll(<span class="hljs-string">'rect'</span>);
                <span class="hljs-keyword">this</span>.state_chart_border = <span class="hljs-keyword">this</span>.svg.insert(<span class="hljs-string">'path'</span>, <span class="hljs-string">'.markers'</span>).attr({<span class="hljs-keyword">class</span>: <span class="hljs-string">'state border'</span>});
                <span class="hljs-keyword">this</span>.state_chart_extra = <span class="hljs-keyword">this</span>.svg.insert(<span class="hljs-string">'line'</span>, <span class="hljs-comment">/* insert before */</span> <span class="hljs-string">'.markers'</span>).attr({<span class="hljs-keyword">class</span>: <span class="hljs-string">'state border pending'</span>});
            },
            renderD3StateChart: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
                <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
    
                <span class="hljs-comment">/* state_chart */</span>
                <span class="hljs-keyword">var</span> chart = <span class="hljs-keyword">this</span>.state_chart = <span class="hljs-keyword">this</span>.state_chart.data(
                    <span class="hljs-keyword">this</span>.buffer.select(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                        <span class="hljs-keyword">return</span> ensure(d, <span class="hljs-string">'data.event.type'</span>, <span class="hljs-string">'update'</span>);
                    }),
                    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                        <span class="hljs-keyword">return</span> d.timestamp
                    }
                );
    
                chart.enter().append(<span class="hljs-string">'rect'</span>).attr({
                    x: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                        <span class="hljs-keyword">return</span> self.timescale(self.dateFn(d.timestamp));
                    },
                    y: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                        <span class="hljs-keyword">return</span> self.computed(<span class="hljs-string">'svg.height'</span>) - self.stateScale(self.stateFn(d.data));
                    },
                    width: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                        <span class="hljs-keyword">return</span> self.timescale(self.dateFn(d.next.timestamp)) - self.timescale(self.dateFn(d.timestamp))
                    },
                    height: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                        <span class="hljs-keyword">return</span> self.stateScale(self.stateFn(d.data))
                    }
                });
                chart.attr({
                    x: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                        <span class="hljs-keyword">return</span> self.timescale(self.dateFn(d.timestamp))
                    },
                    y: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                        <span class="hljs-keyword">return</span> self.computed(<span class="hljs-string">'svg.height'</span>) - self.stateScale(self.stateFn(d.data))
                    },
                    width: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                        <span class="hljs-keyword">return</span> self.timescale(self.dateFn(d.next.timestamp)) - self.timescale(self.dateFn(d.timestamp))
                    },
                    height: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                        <span class="hljs-keyword">return</span> self.stateScale(self.stateFn(d.data))
                    }
                });
                chart.exit().remove();
    
                <span class="hljs-comment">/* border */</span>
                <span class="hljs-keyword">var</span> line = d3.svg.line()
                    .x(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                        <span class="hljs-keyword">return</span> self.timescale(self.dateFn(d.timestamp));
                    })
                    .y(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                        <span class="hljs-keyword">if</span> (ensure(d, <span class="hljs-string">'data.event.type'</span>, <span class="hljs-string">'update'</span>)) {
                            <span class="hljs-keyword">return</span> self.computed(<span class="hljs-string">'svg.height'</span>) - self.stateScale(self.stateFn(d.data)) - self.options.theme.device.state.border.width/<span class="hljs-number">2</span>;
                        } <span class="hljs-keyword">else</span> {
                            <span class="hljs-keyword">return</span> self.computed(<span class="hljs-string">'svg.height'</span>) + self.options.theme.device.state.border.width;
                        }
                    })
                    .interpolate(<span class="hljs-string">"step-after"</span>);
                <span class="hljs-keyword">this</span>.state_chart_border.datum(
                    <span class="hljs-keyword">this</span>.buffer.all(),
                    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                        <span class="hljs-keyword">return</span> d.timestamp
                    })
                    .attr(<span class="hljs-string">"d"</span>, line);
    
                <span class="hljs-comment">/* extra border */</span>
                <span class="hljs-keyword">var</span> last = <span class="hljs-keyword">this</span>.buffer.last();
                <span class="hljs-keyword">if</span> (last) {
                    <span class="hljs-keyword">this</span>.state_chart_extra.attr({
                        x1: self.timescale(self.dateFn(last.timestamp)),
                        y1: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
                            <span class="hljs-keyword">if</span> (ensure(last, <span class="hljs-string">'data.event.type'</span>, <span class="hljs-string">'update'</span>)) {
                                <span class="hljs-keyword">return</span> self.computed(<span class="hljs-string">'svg.height'</span>) - self.stateScale(self.stateFn(last.data)) - self.options.theme.device.state.border.width/<span class="hljs-number">2</span>;
                            } <span class="hljs-keyword">else</span> {
                                <span class="hljs-keyword">return</span> self.computed(<span class="hljs-string">'svg.height'</span>) + self.options.theme.device.state.border.width;
                            }
                        },
                        x2: self.timescale(self.dateFn(last.next.timestamp)),
                        y2: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
                            <span class="hljs-keyword">if</span> (ensure(last, <span class="hljs-string">'data.event.type'</span>, <span class="hljs-string">'update'</span>)) {
                                <span class="hljs-keyword">return</span> self.computed(<span class="hljs-string">'svg.height'</span>) - self.stateScale(self.stateFn(last.data)) - self.options.theme.device.state.border.width/<span class="hljs-number">2</span>;
                            } <span class="hljs-keyword">else</span> {
                                <span class="hljs-keyword">return</span> self.computed(<span class="hljs-string">'svg.height'</span>) + self.options.theme.device.state.border.width;
                            }
                        }
                    });
                }
            },
    
            updateD3StateChartFocus: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(focused, unfocused)</span> </span>{
                <span class="hljs-keyword">var</span> chart = <span class="hljs-keyword">this</span>.state_chart.data(
                    _.compact([focused, unfocused]),
                    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                        <span class="hljs-keyword">return</span> d.timestamp
                    }
                );
    
                chart.attr({
                    <span class="hljs-keyword">class</span>: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(d)</span> </span>{
                        <span class="hljs-keyword">return</span> d == focused ? <span class="hljs-string">'focused'</span> : <span class="hljs-string">''</span>
                    }
                });
            },
    
            destroyD3StateChart: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
                <span class="hljs-keyword">this</span>.state_chart.remove(); <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.state_chart;
                <span class="hljs-keyword">this</span>.state_chart_border.remove(); <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.state_chart_border;
                <span class="hljs-keyword">this</span>.state_chart_extra.remove(); <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.state_chart_extra;
            }
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-313">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-313">&#182;</a>
              </div>
              <p><strong>StateChart mixin.</strong></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        ValueChart: {
            initD3ValueChart: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
                <span class="hljs-keyword">this</span>.value_chart = <span class="hljs-keyword">this</span>.svg.insert(<span class="hljs-string">'g'</span>, <span class="hljs-string">'.markers'</span>).attr({<span class="hljs-keyword">class</span>: <span class="hljs-string">'value area'</span>}).selectAll(<span class="hljs-string">'rect'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-314">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-314">&#182;</a>
              </div>
              <p>this.value_chart = this.svg.insert(âpathâ, â.markersâ).attr({class: âvalue areaâ});</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">this</span>.value_chart_border = <span class="hljs-keyword">this</span>.svg.insert(<span class="hljs-string">'path'</span>, <span class="hljs-string">'.markers'</span>).attr({<span class="hljs-keyword">class</span>: <span class="hljs-string">'value border'</span>});
                <span class="hljs-keyword">this</span>.value_chart_extra = <span class="hljs-keyword">this</span>.svg.insert(<span class="hljs-string">'line'</span>, <span class="hljs-comment">/* insert before */</span> <span class="hljs-string">'.markers'</span>).attr({<span class="hljs-keyword">class</span>: <span class="hljs-string">'value border pending'</span>});
            },
            renderD3ValueChart: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
                <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
    
                <span class="hljs-comment">/* state_chart */</span>
                <span class="hljs-keyword">var</span> chart = <span class="hljs-keyword">this</span>.value_chart = <span class="hljs-keyword">this</span>.value_chart.data(
                    <span class="hljs-keyword">this</span>.buffer.select(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                        <span class="hljs-keyword">return</span> ensure(d, <span class="hljs-string">'data.event.type'</span>, <span class="hljs-string">'update'</span>);
                    }),
                    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                        <span class="hljs-keyword">return</span> d.timestamp
                    }
                );
    
                chart.enter().append(<span class="hljs-string">'rect'</span>).attr({
                    x: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                        <span class="hljs-keyword">return</span> self.timescale(self.dateFn(d.timestamp));
                    },
                    y: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                        <span class="hljs-keyword">return</span> self.computed(<span class="hljs-string">'svg.height'</span>) - self.valueScale(self.valueFn(d.data));
                    },
                    width: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                        <span class="hljs-keyword">return</span> self.timescale(self.dateFn(d.next.timestamp)) - self.timescale(self.dateFn(d.timestamp))
                    },
                    height: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                        <span class="hljs-keyword">return</span> self.valueScale(self.valueFn(d.data))
                    }
                });
                chart.attr({
                    x: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                        <span class="hljs-keyword">return</span> self.timescale(self.dateFn(d.timestamp))
                    },
                    y: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                        <span class="hljs-keyword">return</span> self.computed(<span class="hljs-string">'svg.height'</span>) - self.valueScale(self.valueFn(d.data))
                    },
                    width: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                        <span class="hljs-keyword">return</span> self.timescale(self.dateFn(d.next.timestamp)) - self.timescale(self.dateFn(d.timestamp))
                    },
                    height: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                        <span class="hljs-keyword">return</span> self.valueScale(self.valueFn(d.data))
                    }
                });
                chart.exit().remove();
    
                <span class="hljs-comment">/* border */</span>
                <span class="hljs-keyword">var</span> line = d3.svg.line()
                    .x(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                        <span class="hljs-keyword">return</span> self.timescale(self.dateFn(d.timestamp));
                    })
                    .y(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                        <span class="hljs-keyword">if</span> (ensure(d, <span class="hljs-string">'data.event.type'</span>, <span class="hljs-string">'update'</span>)) {
                            <span class="hljs-keyword">return</span> self.computed(<span class="hljs-string">'svg.height'</span>) - self.valueScale(self.valueFn(d.data)) - self.options.theme.device.state.border.width/<span class="hljs-number">2</span>;
                        } <span class="hljs-keyword">else</span> {
                            <span class="hljs-keyword">return</span> self.computed(<span class="hljs-string">'svg.height'</span>) + self.options.theme.device.state.border.width;
                        }
                    })
                    .interpolate(<span class="hljs-string">"step-after"</span>);
                <span class="hljs-keyword">this</span>.value_chart_border.datum(
                    <span class="hljs-keyword">this</span>.buffer.all(),
                    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                        <span class="hljs-keyword">return</span> d.timestamp
                    })
                    .attr(<span class="hljs-string">"d"</span>, line);
    
                <span class="hljs-comment">/* extra border */</span>
                <span class="hljs-keyword">var</span> last = <span class="hljs-keyword">this</span>.buffer.last();
                <span class="hljs-keyword">if</span> (last) {
                    <span class="hljs-keyword">this</span>.value_chart_extra.attr({
                        x1: self.timescale(self.dateFn(last.timestamp)),
                        y1: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
                            <span class="hljs-keyword">if</span> (ensure(last, <span class="hljs-string">'data.event.type'</span>, <span class="hljs-string">'update'</span>)) {
                                <span class="hljs-keyword">return</span> self.computed(<span class="hljs-string">'svg.height'</span>) - self.valueScale(self.valueFn(last.data)) - self.options.theme.device.state.border.width/<span class="hljs-number">2</span>;
                            } <span class="hljs-keyword">else</span> {
                                <span class="hljs-keyword">return</span> self.computed(<span class="hljs-string">'svg.height'</span>) + self.options.theme.device.state.border.width;
                            }
                        },
                        x2: self.timescale(self.dateFn(last.next.timestamp)),
                        y2: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
                            <span class="hljs-keyword">if</span> (ensure(last, <span class="hljs-string">'data.event.type'</span>, <span class="hljs-string">'update'</span>)) {
                                <span class="hljs-keyword">return</span> self.computed(<span class="hljs-string">'svg.height'</span>) - self.valueScale(self.valueFn(last.data)) - self.options.theme.device.state.border.width/<span class="hljs-number">2</span>;
                            } <span class="hljs-keyword">else</span> {
                                <span class="hljs-keyword">return</span> self.computed(<span class="hljs-string">'svg.height'</span>) + self.options.theme.device.state.border.width;
                            }
                        }
                    });
                }
            },
    
            updateD3ValueChartFocus: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(focused, unfocused)</span> </span>{
                <span class="hljs-keyword">var</span> chart = <span class="hljs-keyword">this</span>.value_chart.data(
                    _.compact([focused, unfocused]),
                    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                        <span class="hljs-keyword">return</span> d.timestamp
                    }
                );
    
                chart.attr({
                    <span class="hljs-keyword">class</span>: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(d)</span> </span>{
                        <span class="hljs-keyword">return</span> d == focused ? <span class="hljs-string">'focused'</span> : <span class="hljs-string">''</span>
                    }
                });
            },
    
            destroyD3ValueChart: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
                <span class="hljs-keyword">this</span>.value_chart.remove(); <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.value_chart;
                <span class="hljs-keyword">this</span>.value_chart_border.remove(); <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.value_chart_border;
                <span class="hljs-keyword">this</span>.value_chart_extra.remove(); <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.value_chart_extra;
            }
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-315">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-315">&#182;</a>
              </div>
              <p><strong>Markers mixin.</strong></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        Markers: {
            initD3Markers: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                <span class="hljs-keyword">this</span>.markers = <span class="hljs-keyword">this</span>.svg.append(<span class="hljs-string">'g'</span>).attr({<span class="hljs-keyword">class</span>: <span class="hljs-string">'markers'</span>}).selectAll(<span class="hljs-string">'.marker'</span>);
            },
    
            renderD3Markers: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
                <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
    
                <span class="hljs-keyword">var</span> markers = <span class="hljs-keyword">this</span>.markers = <span class="hljs-keyword">this</span>.markers.data(
                    <span class="hljs-keyword">this</span>.buffer.reject(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                        <span class="hljs-keyword">return</span> _.isEmpty(d.data.decorations);
                    }),
                    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                        <span class="hljs-keyword">return</span> d.timestamp
                    }
                );
    
                markers.enter().append(<span class="hljs-string">"g"</span>)
                    .attr({
                        <span class="hljs-keyword">class</span>: <span class="hljs-string">"marker"</span>
                    })
                    .append(<span class="hljs-string">"use"</span>)
                    .attr({
                        <span class="hljs-string">'xlink:href'</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                            <span class="hljs-keyword">if</span> (d.data.decorations.length &gt; <span class="hljs-number">1</span>) {
                                <span class="hljs-keyword">return</span> <span class="hljs-string">"#magnify"</span>
                            } <span class="hljs-keyword">else</span> {
                                <span class="hljs-keyword">return</span> <span class="hljs-string">"#"</span> + d.data.decorations[<span class="hljs-number">0</span>].type;
                            }
                        },
                        <span class="hljs-string">'class'</span>: <span class="hljs-string">"decoration"</span>,
                        <span class="hljs-string">'transform'</span>:
                            <span class="hljs-string">'scale('</span>+<span class="hljs-keyword">this</span>.options.theme.pictogram.scale+<span class="hljs-string">') '</span> +
                            <span class="hljs-string">'translate('</span>+
                            <span class="hljs-comment">/* x */</span> -(<span class="hljs-keyword">this</span>.options.theme.pictogram.dimension.height * <span class="hljs-keyword">this</span>.options.theme.pictogram.scale)/<span class="hljs-number">2</span> + <span class="hljs-string">','</span> +
                            <span class="hljs-comment">/* y */</span> (<span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'svg.height'</span>) - <span class="hljs-keyword">this</span>.options.theme.pictogram.dimension.height * <span class="hljs-keyword">this</span>.options.theme.pictogram.scale)/<span class="hljs-number">2</span> +
                            <span class="hljs-string">')'</span>
                    })
                    .on(<span class="hljs-string">"click"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                        self.triggerMethod.apply(<span class="hljs-keyword">this</span>, [<span class="hljs-string">'marker:click'</span>].concat([d.data.decorations]));
                    });
                markers.attr({
                    transform: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                        <span class="hljs-keyword">return</span> <span class="hljs-string">"translate("</span> + self.timescale(self.dateFn(d.timestamp)) + <span class="hljs-string">", 0)"</span>;
                    }
                });
                markers.exit().remove()
            },
    
            destroyD3Markers: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                <span class="hljs-keyword">this</span>.markers.remove(); <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.markers;
            }
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-316">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-316">&#182;</a>
              </div>
              <p><strong>Aside mixin.</strong></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        Aside: {
            initUIAside: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                <span class="hljs-keyword">this</span>._$aside.css({
                    <span class="hljs-string">'height'</span>: <span class="hljs-built_in">parseInt</span>(<span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'widget.height'</span>))*<span class="hljs-number">0.6</span> + <span class="hljs-string">"px"</span>,
                    <span class="hljs-string">'margin-top'</span>: <span class="hljs-built_in">parseInt</span>(<span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'widget.height'</span>))*<span class="hljs-number">0.2</span> + <span class="hljs-string">"px"</span>,
                    <span class="hljs-string">'line-height'</span>: <span class="hljs-built_in">parseInt</span>(<span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'widget.height'</span>))*<span class="hljs-number">0.6</span> + <span class="hljs-string">"px"</span>,
                    <span class="hljs-string">'visibility'</span>: <span class="hljs-string">'visible'</span>
                });
            },
    
            updateAsidePosition: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(position, direction)</span> </span>{
                <span class="hljs-keyword">var</span> align = <span class="hljs-string">'left'</span>;
    
                <span class="hljs-keyword">if</span> (position &lt; <span class="hljs-keyword">this</span>._$aside.width()) {
                    align = <span class="hljs-string">'right'</span>;
                } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (position &gt; <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'svg.width'</span>) - <span class="hljs-keyword">this</span>._$aside.width()) {
                    align = <span class="hljs-string">'left'</span>;
                } <span class="hljs-keyword">else</span> {
                    align = direction == <span class="hljs-string">'left'</span> ? <span class="hljs-string">'right'</span> : <span class="hljs-string">'left'</span>;
                }
    
                <span class="hljs-keyword">this</span>._$aside.css({
                    <span class="hljs-string">'left'</span>: align == <span class="hljs-string">'right'</span> ? position + <span class="hljs-keyword">this</span>.options.theme.dashboard.sidebar.width + <span class="hljs-number">2</span> * <span class="hljs-keyword">this</span>.options.theme.ruler.width : <span class="hljs-string">'auto'</span>,
                    <span class="hljs-string">'right'</span>: align == <span class="hljs-string">'right'</span> ? <span class="hljs-string">'auto'</span> : <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'svg.width'</span>) - position
                });
            }
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-317">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-317">&#182;</a>
              </div>
              <p><strong>Focus mixin.</strong></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        Focus: {
            onFocusChange: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(brush)</span> </span>{
                <span class="hljs-keyword">this</span>.timescale.domain(brush.empty() ? brush.x().domain() : brush.extent());
                <span class="hljs-keyword">this</span>._render();
            }
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-318">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-318">&#182;</a>
              </div>
              <p><strong>Timeline grid mixin.</strong></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        TimelineGrid: {
            initD3TimelineGrid: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                <span class="hljs-keyword">this</span>.xTimelineGridAxis = d3.svg.axis()
                    .scale(<span class="hljs-keyword">this</span>.timescale)
                    .tickSize(<span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'svg.height'</span>))
                    .orient(<span class="hljs-string">"bottom"</span>)
                    .tickFormat(<span class="hljs-string">""</span>);
                <span class="hljs-keyword">this</span>.xTimelineGridAxisGroup = <span class="hljs-keyword">this</span>.svg.insert(<span class="hljs-string">'g'</span>, <span class="hljs-string">'.markers'</span>).append(<span class="hljs-string">"g"</span>)
                    .attr({<span class="hljs-string">'class'</span>: <span class="hljs-string">'x grid left'</span>})
                    .call(<span class="hljs-keyword">this</span>.xTimelineGridAxis);
            },
    
            renderTimelineGrid: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
                <span class="hljs-keyword">this</span>.xTimelineGridAxisGroup.call(<span class="hljs-keyword">this</span>.xTimelineGridAxis);
            },
    
            destroyTimelineGrid: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                <span class="hljs-keyword">this</span>.xTimelineGridAxisGroup.remove(); <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.xTimelineGridAxisGroup;
            }
        },</pre></div></div>
            
        </li>
        
        
        <li id="section-319">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-319">&#182;</a>
              </div>
              <p><strong>Eventline actions mixin.</strong></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        EventlineActions: {
            initUIEventlineActions: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-320">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-320">&#182;</a>
              </div>
              <p>Button used to focus debugger on this eventline</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">this</span>._$focusButton = $(<span class="hljs-string">'&lt;button type="button "&gt;&lt;/button&gt;"'</span>).css({
                    <span class="hljs-string">'margin-top'</span>: <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'widget.height'</span>) * <span class="hljs-number">0.1</span>,
                    <span class="hljs-string">'height'</span>: <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'widget.height'</span>) * <span class="hljs-number">0.8</span>,
                    <span class="hljs-string">'margin-left'</span>: <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'widget.height'</span>) * <span class="hljs-number">0.1</span>,
                    <span class="hljs-string">'width'</span>: <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'widget.height'</span>) * <span class="hljs-number">0.8</span>,
                    <span class="hljs-string">'background-size'</span>: <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'widget.height'</span>)*<span class="hljs-number">0.6</span> + <span class="hljs-string">'px '</span> + <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'widget.height'</span>)*<span class="hljs-number">0.6</span> + <span class="hljs-string">'px'</span>
                }).addClass(
                    self.attributes.focused ? <span class="hljs-string">'picto-focused'</span> : <span class="hljs-string">'picto-focus'</span>
                ).on(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
                    self.triggerMethod.apply(<span class="hljs-keyword">this</span>, [<span class="hljs-string">'eventline:focus:request'</span>].concat(self.attributes));
                });</pre></div></div>
            
        </li>
        
        
        <li id="section-321">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-321">&#182;</a>
              </div>
              <p>Attach focus button to sidemenu</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">this</span>._$sidemenu.append(<span class="hljs-keyword">this</span>._$focusButton);</pre></div></div>
            
        </li>
        
        
        <li id="section-322">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-322">&#182;</a>
              </div>
              <p>Catch click on eventline name</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">this</span>._$name.on(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
                    self.triggerMethod.apply(<span class="hljs-keyword">this</span>, [<span class="hljs-string">'eventline:name:click'</span>].concat(self.attributes));
                }).css({
                    <span class="hljs-string">'cursor'</span>: <span class="hljs-string">'pointer'</span>
                });
            },
    
            markAsFocused: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(focused)</span> </span>{
                <span class="hljs-keyword">this</span>.attributes.focused = focused;
                <span class="hljs-keyword">this</span>._$focusButton.addClass(focused ? <span class="hljs-string">'picto-focused'</span> : <span class="hljs-string">'picto-focus'</span>);
                <span class="hljs-keyword">this</span>._$focusButton.removeClass(focused ? <span class="hljs-string">'picto-focus'</span> : <span class="hljs-string">'picto-focused'</span>);
            }
        }
    };</pre></div></div>
            
        </li>
        
        
        <li id="section-323">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-323">&#182;</a>
              </div>
              <h2 id="widgets-focusline">Widgets.Focusline</h2>

            </div>
            
        </li>
        
        
        <li id="section-324">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-324">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>    
    Widgets.Focusline = Widgets.Widget.extend({
    
        defaults: {
            kind: <span class="hljs-string">'focusline'</span>,
            live: <span class="hljs-literal">false</span>
        },
    
        onBeforeInitD3: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">this</span>.floatingTimeFormat = d3.time.format(<span class="hljs-string">"%H:%M:%S"</span>);
        },
    
        onInitD3: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            Widgets.Widget.prototype.onInitD3.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-325">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-325">&#182;</a>
              </div>
              <p>Compute some properties</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.compute(<span class="hljs-string">'axis.height'</span>, <span class="hljs-string">'this.options.theme.axis.tick.height + this.options.theme.axis.label.height + this.options.theme.axis.stroke.width'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-326">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-326">&#182;</a>
              </div>
              <p>Define y scale</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.y = d3.scale.linear()
                .range([<span class="hljs-number">0</span>, <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'svg.height'</span>) - <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'axis.height'</span>)]);</pre></div></div>
            
        </li>
        
        
        <li id="section-327">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-327">&#182;</a>
              </div>
              <p>Define chart for drawing events.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.chart = <span class="hljs-keyword">this</span>.svg.append(<span class="hljs-string">'g'</span>).attr({<span class="hljs-keyword">class</span>: <span class="hljs-string">'focusline'</span>}).selectAll(<span class="hljs-string">'rect'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-328">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-328">&#182;</a>
              </div>
              <p>Add ruler shadow</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.rulerShadow = <span class="hljs-keyword">this</span>.svg.append(<span class="hljs-string">'rect'</span>).attr({
                <span class="hljs-string">'class'</span>: <span class="hljs-string">'ruler-shadow'</span>,
                <span class="hljs-string">'width'</span>: <span class="hljs-keyword">this</span>.options.theme.focusline.ruler_shadow.width,
                <span class="hljs-string">'height'</span>: <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'svg.height'</span>) - <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'axis.height'</span>)
            });</pre></div></div>
            
        </li>
        
        
        <li id="section-329">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-329">&#182;</a>
              </div>
              <p>Add focused time text</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.focusedTime = <span class="hljs-keyword">this</span>.svg.append(<span class="hljs-string">'text'</span>).attr({
                <span class="hljs-string">'y'</span>: (<span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'svg.height'</span>) - <span class="hljs-keyword">this</span>.options.theme.focusline.focused_time.label.height)/<span class="hljs-number">2</span>,
                <span class="hljs-string">'line-height'</span>: <span class="hljs-keyword">this</span>.options.theme.focusline.focused_time.label.height
            });
    
            <span class="hljs-keyword">this</span>.xAxis = d3.svg.axis()
                .scale(<span class="hljs-keyword">this</span>.timescale)
                .tickSize(<span class="hljs-keyword">this</span>.options.theme.axis.tick.height)
                .orient(<span class="hljs-keyword">this</span>.attributes.orientation);
            <span class="hljs-keyword">if</span>( <span class="hljs-keyword">this</span>.attributes.timeFormat) {
                <span class="hljs-keyword">this</span>.xAxis.tickFormat(<span class="hljs-keyword">this</span>.attributes.timeFormat);
            }
    
            <span class="hljs-keyword">this</span>.xAxisGroup = <span class="hljs-keyword">this</span>.svg.append(<span class="hljs-string">"g"</span>)
                .attr({
                    <span class="hljs-string">'class'</span>: <span class="hljs-string">'x axis '</span> + <span class="hljs-keyword">this</span>.attributes.orientation,
                    <span class="hljs-string">'transform'</span>: <span class="hljs-string">'translate('</span> + self.options.theme.focusline.selector.handle.width/<span class="hljs-number">2</span> +<span class="hljs-string">','</span> + (<span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'svg.height'</span>) - <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'axis.height'</span>) - <span class="hljs-keyword">this</span>.options.theme.axis.stroke.width)+ <span class="hljs-string">')'</span>
                })
                .call(<span class="hljs-keyword">this</span>.xAxis);</pre></div></div>
            
        </li>
        
        
        <li id="section-330">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-330">&#182;</a>
              </div>
              <p>Define context for displaying focused area.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.context = <span class="hljs-keyword">this</span>.svg.append(<span class="hljs-string">"g"</span>).attr(<span class="hljs-string">"class"</span>, <span class="hljs-string">"context"</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-331">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-331">&#182;</a>
              </div>
              <p>Define a brush for focus selection.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.brush = d3.svg.brush().x(<span class="hljs-keyword">this</span>.timescale)
                .on(<span class="hljs-string">'brush'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
                    <span class="hljs-keyword">var</span> extent = self.brush.extent(),
                        diff = self.timescale(extent[<span class="hljs-number">1</span>]) - self.timescale(extent[<span class="hljs-number">0</span>]),
                        min = self.options.theme.focusline.selector.min_width,
                        max = self.options.theme.focusline.selector.max_width,
                        resize = <span class="hljs-literal">false</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-332">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-332">&#182;</a>
              </div>
              <p>Check if brush extent is not too big or too small</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                    <span class="hljs-keyword">if</span> (min &amp;&amp; (diff &lt; min)) {
                        resize = <span class="hljs-literal">true</span>;
                        <span class="hljs-keyword">if</span> (self.timescale(extent[<span class="hljs-number">0</span>]) + min &gt; self.computed(<span class="hljs-string">'svg.width'</span>)) {
                            extent[<span class="hljs-number">1</span>] = self.timescale.invert(self.computed(<span class="hljs-string">'svg.width'</span>));
                            extent[<span class="hljs-number">0</span>] = self.timescale.invert(self.computed(<span class="hljs-string">'svg.width'</span>) - min)
                        } <span class="hljs-keyword">else</span> {
                            extent[<span class="hljs-number">1</span>] = self.timescale.invert(self.timescale(extent[<span class="hljs-number">0</span>]) + min);
                        }
                    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (max &amp;&amp; (diff &gt; max)) {
                        resize = <span class="hljs-literal">true</span>;
                        extent[<span class="hljs-number">1</span>] = self.timescale.invert(self.timescale(extent[<span class="hljs-number">0</span>]) + max);
                    }</pre></div></div>
            
        </li>
        
        
        <li id="section-333">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-333">&#182;</a>
              </div>
              <p>Resize the extent if required</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                    <span class="hljs-keyword">if</span> (resize) {
                        self.brush.extent(extent)(d3.select(<span class="hljs-keyword">this</span>));
                    }</pre></div></div>
            
        </li>
        
        
        <li id="section-334">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-334">&#182;</a>
              </div>
              <p>Update brush resize handles</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                    self.context.select(<span class="hljs-string">'.mask.left'</span>).attr({
                        <span class="hljs-string">'x'</span>: <span class="hljs-number">0</span>,
                        <span class="hljs-string">'width'</span>: self.timescale(extent[<span class="hljs-number">0</span>])
                    });
                    self.context.select(<span class="hljs-string">'.mask.right'</span>).attr({
                        <span class="hljs-string">'x'</span>: self.timescale(extent[<span class="hljs-number">1</span>]) + self.options.theme.focusline.selector.handle.width,
                        <span class="hljs-string">'width'</span>: self.computed(<span class="hljs-string">'svg.width'</span>) - self.timescale(extent[<span class="hljs-number">1</span>])
                    });</pre></div></div>
            
        </li>
        
        
        <li id="section-335">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-335">&#182;</a>
              </div>
              <p>Notify that brush selection just changed</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                    self.triggerMethod.apply(self, [<span class="hljs-string">'focus:change'</span>].concat([self.brush]));
                })
                .on(<span class="hljs-string">'brushend'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
                    <span class="hljs-keyword">var</span> extent = self.brush.empty() ? self.brush.x().domain() : self.brush.extent();
                    <span class="hljs-keyword">var</span> width = <span class="hljs-built_in">parseInt</span>(self.timescale(extent[<span class="hljs-number">1</span>]) - self.timescale(extent[<span class="hljs-number">0</span>]));
                    self.triggerMethod.apply(self, [<span class="hljs-string">'brush:resize'</span>].concat([width]));
                });</pre></div></div>
            
        </li>
        
        
        <li id="section-336">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-336">&#182;</a>
              </div>
              <p>Attach brush to context</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">var</span> brushGroup = <span class="hljs-keyword">this</span>.brushGroup = <span class="hljs-keyword">this</span>.context.append(<span class="hljs-string">"g"</span>)
                .attr(<span class="hljs-string">"class"</span>, <span class="hljs-string">"x brush"</span>)
                .call(<span class="hljs-keyword">this</span>.brush);
            brushGroup.selectAll(<span class="hljs-string">"rect"</span>)
                .attr(<span class="hljs-string">"y"</span>, <span class="hljs-keyword">this</span>.options.theme.focusline.selector.border.width/<span class="hljs-number">2</span>)
                .attr(<span class="hljs-string">"height"</span>, <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'svg.height'</span>) - <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'axis.height'</span>) - <span class="hljs-keyword">this</span>.options.theme.focusline.selector.border.width);</pre></div></div>
            
        </li>
        
        
        <li id="section-337">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-337">&#182;</a>
              </div>
              <p>Keep reference to brush extent node</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.brushExtent = <span class="hljs-keyword">this</span>.brushGroup.select(<span class="hljs-string">'rect.extent'</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-338">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-338">&#182;</a>
              </div>
              <p>Add brush selector mask</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.context.selectAll(<span class="hljs-string">'.brush'</span>).append(<span class="hljs-string">'rect'</span>).attr(<span class="hljs-string">'class'</span>, <span class="hljs-string">'mask left'</span>);
            <span class="hljs-keyword">this</span>.context.selectAll(<span class="hljs-string">'.brush'</span>).append(<span class="hljs-string">'rect'</span>).attr(<span class="hljs-string">'class'</span>, <span class="hljs-string">'mask right'</span>);
            <span class="hljs-keyword">this</span>.context.selectAll(<span class="hljs-string">'.brush rect.mask'</span>).attr({
                <span class="hljs-string">'y'</span>: <span class="hljs-keyword">this</span>.options.theme.focusline.selector.mask.border.width/<span class="hljs-number">2</span>,
                <span class="hljs-string">'height'</span>: <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'svg.height'</span>) - <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'axis.height'</span>) - <span class="hljs-keyword">this</span>.options.theme.focusline.selector.mask.border.width
            });</pre></div></div>
            
        </li>
        
        
        <li id="section-339">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-339">&#182;</a>
              </div>
              <p>Add brush selector handles</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.context.selectAll(<span class="hljs-string">'.resize'</span>).append(<span class="hljs-string">'rect'</span>).attr({
                <span class="hljs-string">'class'</span>: <span class="hljs-string">'handle'</span>,
                <span class="hljs-string">'width'</span>: self.options.theme.focusline.selector.handle.width,
                <span class="hljs-string">'height'</span>: <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'svg.height'</span>) - <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'axis.height'</span>)
            });</pre></div></div>
            
        </li>
        
        
        <li id="section-340">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-340">&#182;</a>
              </div>
              <p>Prevent clearing the brush</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">var</span> oldBrushMouseDownHandler = brushGroup.on(<span class="hljs-string">'mousedown.brush'</span>);
            brushGroup.on(<span class="hljs-string">'mousedown.brush'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
                brushGroup.on(<span class="hljs-string">'mouseup.brush'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
                    clearHandlers();
                });
    
                brushGroup.on(<span class="hljs-string">'mousemove.brush'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
                    clearHandlers();
                    oldBrushMouseDownHandler.call(<span class="hljs-keyword">this</span>);
                });
    
                <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">clearHandlers</span><span class="hljs-params">()</span> </span>{
                    brushGroup.on(<span class="hljs-string">'mousemove.brush'</span>, <span class="hljs-literal">null</span>);
                    brushGroup.on(<span class="hljs-string">'mouseup.brush'</span>, <span class="hljs-literal">null</span>);
                }
            });</pre></div></div>
            
        </li>
        
        
        <li id="section-341">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-341">&#182;</a>
              </div>
              <p>Hide placeholders</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._$sidebar.hide();
            <span class="hljs-keyword">this</span>._$aside.hide();
        },
    
        onDestroyD3: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            Widgets.Widget.prototype.onDestroyD3.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.y;
            <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.xAxis;
            <span class="hljs-keyword">this</span>.chart.remove(); <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.chart;
            <span class="hljs-keyword">this</span>.context.remove(); <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.context;
            <span class="hljs-keyword">this</span>.brushGroup.remove(); <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.brushGroup;
            <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.brushExtent;
            <span class="hljs-keyword">this</span>.xAxisGroup.remove(); <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.xAxisGroup;
        },
    
        onBeforeRender: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(data, focus, options)</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-342">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-342">&#182;</a>
              </div>
              <p>Setup brush extent to be the size of the whole timescale domain
just before the first rendering.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">if</span> (_.isUndefined(<span class="hljs-keyword">this</span>._isFirstRendering) &amp;&amp; ! <span class="hljs-keyword">this</span>.attributes.live) {
                <span class="hljs-keyword">this</span>.brush.extent(<span class="hljs-keyword">this</span>.timescale.domain())(<span class="hljs-keyword">this</span>.brushGroup);
                <span class="hljs-keyword">this</span>._isFirstRendering = <span class="hljs-literal">false</span>;
            }
        },
    
        onRender: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            Widgets.Widget.prototype.onRender.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-343">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-343">&#182;</a>
              </div>
              <p>Update y domain</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.y.domain(d3.extent(<span class="hljs-keyword">this</span>.buffer.all(), <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                <span class="hljs-keyword">return</span> d.data.value
            }));</pre></div></div>
            
        </li>
        
        
        <li id="section-344">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-344">&#182;</a>
              </div>
              <p>Render event chart</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">var</span> chart = <span class="hljs-keyword">this</span>.chart = <span class="hljs-keyword">this</span>.chart.data(
                <span class="hljs-keyword">this</span>.buffer.select(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                    <span class="hljs-keyword">return</span> d.data.value &gt; <span class="hljs-number">0</span>;
                }),
                <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                    <span class="hljs-keyword">return</span> d.timestamp
                }
            );
    
            chart.enter().append(<span class="hljs-string">"rect"</span>).attr({
                <span class="hljs-string">'x'</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                    <span class="hljs-keyword">return</span> self.timescale(self.dateFn(d.timestamp));
                },
                <span class="hljs-string">'y'</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                    <span class="hljs-keyword">return</span> self.computed(<span class="hljs-string">'svg.height'</span>) - self.computed(<span class="hljs-string">'axis.height'</span>) - self.y(d.data.value)
                },
                <span class="hljs-string">'width'</span>: <span class="hljs-number">1</span>,
                <span class="hljs-string">'height'</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                    <span class="hljs-keyword">return</span> self.y(d.data.value)
                }
            });
            chart.attr({
                <span class="hljs-string">'x'</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d, i)</span> </span>{
                    <span class="hljs-keyword">return</span> self.timescale(self.dateFn(d.timestamp));
                },
                <span class="hljs-string">'width'</span>: <span class="hljs-number">1</span>
            });
            chart.exit().remove();</pre></div></div>
            
        </li>
        
        
        <li id="section-345">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-345">&#182;</a>
              </div>
              <p>Render time axis</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.xAxisGroup.call(<span class="hljs-keyword">this</span>.xAxis);
        },
    
        rulerFocusChanged: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(coordinate, direction, options)</span> </span>{
            <span class="hljs-keyword">var</span> brushExtentOffset = <span class="hljs-built_in">parseInt</span>(<span class="hljs-keyword">this</span>.brushExtent.attr(<span class="hljs-string">'x'</span>));
            <span class="hljs-keyword">var</span> brushExtentWidth = <span class="hljs-keyword">this</span>.brush.empty()? <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'svg.width'</span>) : <span class="hljs-built_in">parseInt</span>(<span class="hljs-keyword">this</span>.brushExtent.attr(<span class="hljs-string">'width'</span>));
            <span class="hljs-keyword">var</span> focusedTextLabelWidth = <span class="hljs-built_in">parseInt</span>(<span class="hljs-keyword">this</span>.focusedTime.node().getBBox().width);</pre></div></div>
            
        </li>
        
        
        <li id="section-346">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-346">&#182;</a>
              </div>
              <p>Workout ruler shadow placement and focused time</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">var</span> placement = brushExtentWidth * coordinate;
            <span class="hljs-keyword">var</span> focusedTime = <span class="hljs-keyword">this</span>.timescale.invert(brushExtentOffset + placement);</pre></div></div>
            
        </li>
        
        
        <li id="section-347">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-347">&#182;</a>
              </div>
              <p>Setup ruler shadow placement</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.rulerShadow.attr({
                transform: <span class="hljs-string">'translate('</span> + (<span class="hljs-keyword">this</span>.options.theme.ruler.width*<span class="hljs-number">2</span>/<span class="hljs-number">3</span> + brushExtentOffset + placement) + <span class="hljs-string">', 0)'</span>
            });</pre></div></div>
            
        </li>
        
        
        <li id="section-348">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-348">&#182;</a>
              </div>
              <p>Workout a nice placement for focused text label</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">if</span> (placement - focusedTextLabelWidth / <span class="hljs-number">2</span> &lt; <span class="hljs-number">0</span>) {
                placement = <span class="hljs-number">0</span>;
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (placement + focusedTextLabelWidth / <span class="hljs-number">2</span> &gt; brushExtentWidth) {
                placement = brushExtentWidth - focusedTextLabelWidth;
            } <span class="hljs-keyword">else</span> {
                placement = placement - focusedTextLabelWidth / <span class="hljs-number">2</span> + <span class="hljs-keyword">this</span>.options.theme.ruler.width;
            }</pre></div></div>
            
        </li>
        
        
        <li id="section-349">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-349">&#182;</a>
              </div>
              <p>Setup focused text label placement and value</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.focusedTime.attr({
                x: brushExtentOffset + placement
            }).text(<span class="hljs-keyword">this</span>.floatingTimeFormat(focusedTime));
        }
    });</pre></div></div>
            
        </li>
        
        
        <li id="section-350">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-350">&#182;</a>
              </div>
              <h2 id="widgets-timeline">Widgets.Timeline</h2>

            </div>
            
        </li>
        
        
        <li id="section-351">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-351">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>    
    Widgets.Timeline = Widgets.Widget.extend({
    
        defaults: {
            kind: <span class="hljs-string">'timeline'</span>,
            name: <span class="hljs-string">'Timeline'</span>,
            orientation: <span class="hljs-string">'top'</span>,
            buffer: {
                ignoreData: <span class="hljs-literal">true</span>
            }
        },
    
        onInitUI: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            Widgets.Widget.prototype.onInitUI.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">this</span>._$name.text(<span class="hljs-keyword">this</span>.attributes.name);
        },
    
        onBeforeInitD3: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">this</span>.floatingTimeFormat = d3.time.format(<span class="hljs-string">"%H:%M:%S"</span>);
        },
    
        onInitD3: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            Widgets.Widget.prototype.onInitD3.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">this</span>.xAxis = d3.svg.axis()
                .scale(<span class="hljs-keyword">this</span>.timescale)
                .orient(<span class="hljs-keyword">this</span>.attributes.orientation);
            <span class="hljs-keyword">if</span>( <span class="hljs-keyword">this</span>.attributes.timeFormat) {
                <span class="hljs-keyword">this</span>.xAxis.tickFormat(<span class="hljs-keyword">this</span>.attributes.timeFormat);
            }
    
            <span class="hljs-keyword">this</span>.xAxisGroup = <span class="hljs-keyword">this</span>.svg.append(<span class="hljs-string">'g'</span>)
                .attr({
                    <span class="hljs-string">'class'</span>: <span class="hljs-string">'x axis '</span> + <span class="hljs-keyword">this</span>.attributes.orientation,
                    <span class="hljs-string">'transform'</span>: <span class="hljs-string">'translate(0,'</span> + <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'svg.height'</span>) + <span class="hljs-string">')'</span>
                })
                .call(<span class="hljs-keyword">this</span>.xAxis);
    
            <span class="hljs-keyword">this</span>.focusedTime = <span class="hljs-keyword">this</span>.xAxisGroup.append(<span class="hljs-string">'text'</span>);
        },
    
        onRender: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            Widgets.Widget.prototype.onRender.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-352">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-352">&#182;</a>
              </div>
              <p>Redraw axis</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.xAxisGroup.call(<span class="hljs-keyword">this</span>.xAxis);
        },
    
        rulerFocusChanged: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(coordinate, direction, options)</span> </span>{
            <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
    
            <span class="hljs-keyword">var</span> timescaleWidth = <span class="hljs-keyword">this</span>.timescale.range()[<span class="hljs-number">1</span>];
            <span class="hljs-keyword">var</span> placement, position = timescaleWidth * coordinate;
            <span class="hljs-keyword">var</span> focusedTime = <span class="hljs-keyword">this</span>.timescale.invert(position);</pre></div></div>
            
        </li>
        
        
        <li id="section-353">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-353">&#182;</a>
              </div>
              <p>Set focused time label value</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.focusedTime.text(<span class="hljs-keyword">this</span>.floatingTimeFormat(focusedTime));</pre></div></div>
            
        </li>
        
        
        <li id="section-354">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-354">&#182;</a>
              </div>
              <p>Get focused time label width</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">var</span> focusedTextLabelWidth = <span class="hljs-built_in">parseInt</span>(<span class="hljs-keyword">this</span>.focusedTime.node().getBBox().width);</pre></div></div>
            
        </li>
        
        
        <li id="section-355">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-355">&#182;</a>
              </div>
              <p>Workout a nice placement for focused text label</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">if</span> (position - focusedTextLabelWidth / <span class="hljs-number">2</span> &lt; <span class="hljs-number">0</span>) {
                placement = <span class="hljs-number">0</span>;
            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (position + focusedTextLabelWidth / <span class="hljs-number">2</span> &gt; timescaleWidth) {
                placement = timescaleWidth - focusedTextLabelWidth;
            } <span class="hljs-keyword">else</span> {
                placement = position - focusedTextLabelWidth / <span class="hljs-number">2</span> + <span class="hljs-keyword">this</span>.options.theme.ruler.width;
            }</pre></div></div>
            
        </li>
        
        
        <li id="section-356">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-356">&#182;</a>
              </div>
              <p>Set timeline tick label opacity</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.xAxisGroup.selectAll(<span class="hljs-string">"text"</span>).style(<span class="hljs-string">"fill-opacity"</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                <span class="hljs-keyword">return</span> <span class="hljs-built_in">Math</span>.abs(self.timescale(d) - placement - focusedTextLabelWidth / <span class="hljs-number">2</span>) &lt; focusedTextLabelWidth ? <span class="hljs-number">0</span> : <span class="hljs-number">1</span>;
            });</pre></div></div>
            
        </li>
        
        
        <li id="section-357">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-357">&#182;</a>
              </div>
              <p>Setup focused text label placement and value</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.focusedTime.attr({
                y: -<span class="hljs-number">9</span>,
                x: placement
            });
        }
    });
    
    _.extend(Widgets.Timeline.prototype, Widgets.Mixins.Focus);</pre></div></div>
            
        </li>
        
        
        <li id="section-358">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-358">&#182;</a>
              </div>
              <h2 id="widgets-device">Widgets.Device</h2>

            </div>
            
        </li>
        
        
        <li id="section-359">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-359">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>    
    Widgets.Device = Widgets.Widget.extend({
    
        onInitUI: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{</pre></div></div>
            
        </li>
        
        
        <li id="section-360">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-360">&#182;</a>
              </div>
              <p>Setup eventline action</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.initUIEventlineActions();</pre></div></div>
            
        </li>
        
        
        <li id="section-361">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-361">&#182;</a>
              </div>
              <p>Device pictogram used to represent its current state</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>._$picto = $(<span class="hljs-string">'&lt;div/&gt;'</span>).addClass(<span class="hljs-string">'picto'</span>).css({
                <span class="hljs-string">'height'</span>: <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'widget.height'</span>),
                <span class="hljs-string">'line-height'</span>: <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'svg.height'</span>) + <span class="hljs-string">'px'</span>,
                <span class="hljs-string">'background-size'</span>: <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'svg.height'</span>) + <span class="hljs-string">'px '</span> + <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'svg.height'</span>) + <span class="hljs-string">'px'</span>,
                <span class="hljs-string">'width'</span>: <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'svg.height'</span>)
            });
            <span class="hljs-keyword">this</span>._$sidebar.append(<span class="hljs-keyword">this</span>._$picto);
        },
    
        onInitD3: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            Widgets.Widget.prototype.onInitD3.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-362">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-362">&#182;</a>
              </div>
              <p>Status is used to display connection/disconnection status</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.status = <span class="hljs-keyword">this</span>.svg.append(<span class="hljs-string">'g'</span>).attr({<span class="hljs-keyword">class</span>: <span class="hljs-string">'status'</span>}).selectAll(<span class="hljs-string">'line'</span>);
    
            <span class="hljs-keyword">this</span>.initD3Markers();
            <span class="hljs-keyword">this</span>.initD3TimelineGrid();
        },
    
        onDestroyD3: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            Widgets.Widget.prototype.onDestroyD3.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-363">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-363">&#182;</a>
              </div>
              <p>Destroy status</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.status.remove(); <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.status;</pre></div></div>
            
        </li>
        
        
        <li id="section-364">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-364">&#182;</a>
              </div>
              <p>Destroy markers</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.destroyD3Markers();</pre></div></div>
            
        </li>
        
        
        <li id="section-365">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-365">&#182;</a>
              </div>
              <p>Destroy TimelineGrid</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.destroyTimelineGrid();
        },
    
        onRender: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            Widgets.Widget.prototype.onRender.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-366">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-366">&#182;</a>
              </div>
              <p>Render status</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">var</span> status = <span class="hljs-keyword">this</span>.status = <span class="hljs-keyword">this</span>.status.data(
                <span class="hljs-keyword">this</span>.buffer.select(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                    <span class="hljs-keyword">return</span> ensure(d, <span class="hljs-string">'data.event'</span>) &amp;&amp;
                        (  d.data.event.type == <span class="hljs-string">'update'</span>
                            || d.data.event.type == <span class="hljs-string">'connection'</span>
                            || d.data.event.type == <span class="hljs-string">'disconnection'</span>);
                }),
                <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                    <span class="hljs-keyword">return</span> d.timestamp
                }
            );
    
            status.enter().append(<span class="hljs-string">'line'</span>).attr({
                x1: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                    <span class="hljs-keyword">return</span> self.timescale(self.dateFn(d.timestamp));
                },
                y1: <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'svg.height'</span>) - self.options.theme.status.border.width/<span class="hljs-number">2</span>,
                x2: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                    <span class="hljs-keyword">return</span> self.timescale(self.dateFn(d.next.timestamp));
                },
                y2: <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'svg.height'</span>) - self.options.theme.status.border.width/<span class="hljs-number">2</span>,
                <span class="hljs-keyword">class</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{ <span class="hljs-keyword">return</span> d.data.event.type }
            });
            status.attr({
                x1: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                    <span class="hljs-keyword">return</span> self.timescale(self.dateFn(d.timestamp))
                },
                x2: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                    <span class="hljs-keyword">return</span> self.timescale(self.dateFn(d.next.timestamp))
                },
                <span class="hljs-keyword">class</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{ <span class="hljs-keyword">return</span> d.data.event.type }
            });
            status.exit().remove();</pre></div></div>
            
        </li>
        
        
        <li id="section-367">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-367">&#182;</a>
              </div>
              <p>Render markers</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.renderD3Markers();</pre></div></div>
            
        </li>
        
        
        <li id="section-368">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-368">&#182;</a>
              </div>
              <p>Render the Timeline Grid</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.renderTimelineGrid();
        },
    
        onRulerFocusUpdate: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(coordinate, direction, timestamp, focusedFrame, lastFocusedFrame)</span> </span>{
            Widgets.Widget.prototype.onRulerFocusUpdate.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">var</span> status = <span class="hljs-keyword">this</span>.status.data(
                _.compact([focusedFrame, lastFocusedFrame]),
                <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                    <span class="hljs-keyword">return</span> d.timestamp
                }
            );
    
            status.classed(<span class="hljs-string">'focused'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(d)</span> </span>{
                <span class="hljs-keyword">return</span> d == focusedFrame
            });
        }
    });
    
    _.extend(
        Widgets.Device.prototype,
        Widgets.Mixins.TimelineGrid,
        Widgets.Mixins.Markers,
        Widgets.Mixins.Focus,
        Widgets.Mixins.EventlineActions
    );</pre></div></div>
            
        </li>
        
        
        <li id="section-369">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-369">&#182;</a>
              </div>
              <h2 id="widgets-temperature">Widgets.Temperature</h2>

            </div>
            
        </li>
        
        
        <li id="section-370">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-370">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>    
    Widgets.Temperature = Widgets.Device.extend({
    
        defaults: {
            kind: <span class="hljs-string">'temperature'</span>,
            buffer: {
                pairing: <span class="hljs-literal">true</span>,
                shadowing: <span class="hljs-literal">true</span>
            }
        },
    
        onInitUI: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            Widgets.Device.prototype.onInitUI.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">this</span>.initUIAside();
        },
    
        onBeforeInitD3: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            Widgets.Device.prototype.onBeforeInitD3.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-371">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-371">&#182;</a>
              </div>
              <p>Setup d3 state functions</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.stateFn = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            };</pre></div></div>
            
        </li>
        
        
        <li id="section-372">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-372">&#182;</a>
              </div>
              <p>Setup d3 value functions</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.valueFn = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-keyword">if</span> (d.timestamp) {
                        <span class="hljs-keyword">return</span> <span class="hljs-built_in">parseFloat</span>(d.data.event.state.value);
                    } <span class="hljs-keyword">else</span> {
                        <span class="hljs-keyword">return</span> <span class="hljs-built_in">parseFloat</span>(d.event.state.value);
                    }
                } <span class="hljs-keyword">catch</span> (e) {
                    <span class="hljs-keyword">return</span> <span class="hljs-number">0.0</span>;
                }
            };
        },
    
        onInitD3: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            Widgets.Device.prototype.onInitD3.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">this</span>.stateScale = d3.scale.quantize()
                .range([<span class="hljs-number">0</span>, <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'svg.height'</span>) - <span class="hljs-keyword">this</span>.options.theme.device.state.border.width])
                .domain([<span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>]);
    
            <span class="hljs-keyword">this</span>.valueScale = d3.scale.linear()
                .range([<span class="hljs-number">0</span>, <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'svg.height'</span>) - <span class="hljs-keyword">this</span>.options.theme.device.state.border.width]);
    
            <span class="hljs-keyword">this</span>.initD3StateChart();
            <span class="hljs-keyword">this</span>.initD3ValueChart();
        },
    
        onDestroyD3: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            Widgets.Device.prototype.onDestroyD3.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.stateScale;
            <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.valueScale;
    
            <span class="hljs-keyword">this</span>.destroyD3StateChart();
            <span class="hljs-keyword">this</span>.destroyD3ValueChart();
        },
    
        onRender: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            Widgets.Device.prototype.onRender.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
    
            <span class="hljs-keyword">this</span>.valueScale.domain(d3.extent(
                self.buffer.select(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                    <span class="hljs-keyword">return</span> ensure(d.data, <span class="hljs-string">'event'</span>) &amp;&amp; d.data.event.type == <span class="hljs-string">'update'</span>}
                ), self.valueFn)
            );
    
            <span class="hljs-keyword">this</span>.renderD3StateChart();
            <span class="hljs-keyword">this</span>.renderD3ValueChart();
        },
    
        onRulerFocusUpdate: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(coordinate, direction, timestamp, focusedFrame, lastFocusedFrame)</span> </span>{
            Widgets.Device.prototype.onRulerFocusUpdate.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">if</span> (ensure(focusedFrame, <span class="hljs-string">'data.event.type'</span>, <span class="hljs-string">'update'</span>) &amp;&amp; ensure(focusedFrame, <span class="hljs-string">'data.event.picto'</span>)) {
                <span class="hljs-keyword">this</span>._$picto.attr({<span class="hljs-keyword">class</span>: <span class="hljs-string">'picto picto-temperature_state_on'</span>});
                <span class="hljs-keyword">this</span>._$aside.text(<span class="hljs-built_in">parseFloat</span>(<span class="hljs-keyword">this</span>.valueFn(focusedFrame.data)).toFixed(<span class="hljs-number">2</span>)+<span class="hljs-string">'Â°'</span>).css(<span class="hljs-string">'visibility'</span>, <span class="hljs-string">'visible'</span>);
            } <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-373">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-373">&#182;</a>
              </div>
              <p>fallback</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">this</span>._$picto.attr({<span class="hljs-keyword">class</span>: <span class="hljs-string">'picto picto-temperature_type'</span>}).text(<span class="hljs-string">''</span>);
                <span class="hljs-keyword">this</span>._$aside.text(<span class="hljs-string">''</span>).css(<span class="hljs-string">'visibility'</span>, <span class="hljs-string">'hidden'</span>);
            }
    
            <span class="hljs-keyword">this</span>.updateD3StateChartFocus(focusedFrame, lastFocusedFrame);
            <span class="hljs-keyword">this</span>.updateD3ValueChartFocus(focusedFrame, lastFocusedFrame);
            <span class="hljs-keyword">this</span>.updateAsidePosition(<span class="hljs-keyword">this</span>.timescale.range()[<span class="hljs-number">1</span>] * coordinate, direction);
        }
    });
    
    _.extend(Widgets.Temperature.prototype, Widgets.Mixins.StateChart, Widgets.Mixins.ValueChart, Widgets.Mixins.Focus, Widgets.Mixins.Aside);</pre></div></div>
            
        </li>
        
        
        <li id="section-374">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-374">&#182;</a>
              </div>
              <h2 id="widgets-illumination">Widgets.Illumination</h2>

            </div>
            
        </li>
        
        
        <li id="section-375">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-375">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>    
    Widgets.Illumination = Widgets.Device.extend({
    
        defaults: {
            kind: <span class="hljs-string">'illumination'</span>,
            buffer: {
                pairing: <span class="hljs-literal">true</span>,
                shadowing: <span class="hljs-literal">true</span>
            }
        },
    
        onInitUI: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            Widgets.Device.prototype.onInitUI.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">this</span>.initUIAside();
        },
    
        onBeforeInitD3: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            Widgets.Device.prototype.onBeforeInitD3.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-376">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-376">&#182;</a>
              </div>
              <p>Setup d3 state functions</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.stateFn = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            };</pre></div></div>
            
        </li>
        
        
        <li id="section-377">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-377">&#182;</a>
              </div>
              <p>Setup d3 value functions</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.valueFn = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-keyword">if</span> (d.timestamp) {
                        <span class="hljs-keyword">return</span> <span class="hljs-built_in">parseInt</span>(d.data.event.state.value);
                    } <span class="hljs-keyword">else</span> {
                        <span class="hljs-keyword">return</span> <span class="hljs-built_in">parseInt</span>(d.event.state.value);
                    }
                } <span class="hljs-keyword">catch</span> (e) {
                    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
                }
            };
        },
    
        onInitD3: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            Widgets.Device.prototype.onInitD3.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">this</span>.stateScale = d3.scale.quantize()
                .range([<span class="hljs-number">0</span>, <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'svg.height'</span>) - <span class="hljs-keyword">this</span>.options.theme.device.state.border.width])
                .domain([<span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>]);
    
            <span class="hljs-keyword">this</span>.valueScale = d3.scale.linear()
                .range([<span class="hljs-number">0</span>, <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'svg.height'</span>) - <span class="hljs-keyword">this</span>.options.theme.device.state.border.width]);
    
            <span class="hljs-keyword">this</span>.initD3StateChart();
            <span class="hljs-keyword">this</span>.initD3ValueChart();
        },
    
        onDestroyD3: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            Widgets.Device.prototype.onDestroyD3.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.stateScale;
            <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.valueScale;
    
            <span class="hljs-keyword">this</span>.destroyD3StateChart();
            <span class="hljs-keyword">this</span>.destroyD3ValueChart();
        },
    
        onRender: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            Widgets.Device.prototype.onRender.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-378">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-378">&#182;</a>
              </div>
              <p>Compute new domain for sensor.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">var</span> domain = d3.extent(
                self.buffer.select(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                    <span class="hljs-keyword">return</span> ensure(d.data, <span class="hljs-string">'event'</span>) &amp;&amp; d.data.event.type == <span class="hljs-string">'update'</span>
                }),
                self.valueFn
            );</pre></div></div>
            
        </li>
        
        
        <li id="section-379">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-379">&#182;</a>
              </div>
              <p>Update y scale.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.valueScale.domain([domain[<span class="hljs-number">0</span>]*<span class="hljs-number">0.9</span>, domain[<span class="hljs-number">1</span>]*<span class="hljs-number">1.1</span>]);</pre></div></div>
            
        </li>
        
        
        <li id="section-380">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-380">&#182;</a>
              </div>
              <p>Render the chart</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.renderD3StateChart();
            <span class="hljs-keyword">this</span>.renderD3ValueChart();
        },
    
        onRulerFocusUpdate: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(coordinate, direction, timestamp, focusedFrame, lastFocusedFrame)</span> </span>{
            Widgets.Device.prototype.onRulerFocusUpdate.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">if</span> (ensure(focusedFrame, <span class="hljs-string">'data.event.type'</span>, <span class="hljs-string">'update'</span>) &amp;&amp; ensure(focusedFrame, <span class="hljs-string">'data.event.picto'</span>)) {
                <span class="hljs-keyword">this</span>._$picto.attr({<span class="hljs-keyword">class</span>: <span class="hljs-string">'picto picto-illumination_state_on'</span>});
                <span class="hljs-keyword">this</span>._$aside.text(<span class="hljs-keyword">this</span>.valueFn(focusedFrame.data) + <span class="hljs-string">' Lux'</span>).css(<span class="hljs-string">'visibility'</span>, <span class="hljs-string">'visible'</span>);;
            } <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-381">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-381">&#182;</a>
              </div>
              <p>fallback</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">this</span>._$picto.attr({<span class="hljs-keyword">class</span>: <span class="hljs-string">'picto picto-illumination_type'</span>});
                <span class="hljs-keyword">this</span>._$aside.text(<span class="hljs-string">''</span>).css(<span class="hljs-string">'visibility'</span>, <span class="hljs-string">'hidden'</span>);
            }
    
            <span class="hljs-keyword">this</span>.updateD3StateChartFocus(focusedFrame, lastFocusedFrame);
            <span class="hljs-keyword">this</span>.updateD3ValueChartFocus(focusedFrame, lastFocusedFrame);
            <span class="hljs-keyword">this</span>.updateAsidePosition(<span class="hljs-keyword">this</span>.timescale.range()[<span class="hljs-number">1</span>] * coordinate, direction);
        }
    });
    
    _.extend(Widgets.Illumination.prototype, Widgets.Mixins.StateChart, Widgets.Mixins.ValueChart, Widgets.Mixins.Focus, Widgets.Mixins.Aside);</pre></div></div>
            
        </li>
        
        
        <li id="section-382">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-382">&#182;</a>
              </div>
              <h2 id="widgets-switch">Widgets.Switch</h2>

            </div>
            
        </li>
        
        
        <li id="section-383">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-383">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>    
    
    Widgets.Switch = Widgets.Device.extend({
    
        defaults: {
            kind: <span class="hljs-string">'switch'</span>,
            buffer: {
                pairing: <span class="hljs-literal">true</span>,
                shadowing: <span class="hljs-literal">true</span>
            }
        },
    
        onInitD3: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            Widgets.Device.prototype.onInitD3.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">this</span>.stateScale = d3.scale.quantize()
                .range([<span class="hljs-number">4</span>, <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'svg.height'</span>) - <span class="hljs-keyword">this</span>.options.theme.device.state.border.width])
                .domain([<span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>]);
    
            <span class="hljs-keyword">this</span>.spikes = <span class="hljs-keyword">this</span>.svg.append(<span class="hljs-string">'g'</span>).attr({<span class="hljs-keyword">class</span>: <span class="hljs-string">'spikes'</span>}).selectAll(<span class="hljs-string">'line'</span>);
            <span class="hljs-keyword">this</span>.border = <span class="hljs-keyword">this</span>.svg.insert(<span class="hljs-string">'path'</span>, <span class="hljs-comment">/* insert before */</span> <span class="hljs-string">'.markers'</span>).attr({<span class="hljs-keyword">class</span>: <span class="hljs-string">'state border'</span>});
            <span class="hljs-keyword">this</span>.border_extra = <span class="hljs-keyword">this</span>.svg.insert(<span class="hljs-string">'line'</span>, <span class="hljs-comment">/* insert before */</span> <span class="hljs-string">'.markers'</span>).attr({<span class="hljs-keyword">class</span>: <span class="hljs-string">'state border pending'</span>});
        },
    
        onDestroyD3: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            Widgets.Device.prototype.onDestroyD3.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.stateScale;
    
            <span class="hljs-keyword">this</span>.spikes.remove(); <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.spikes;
            <span class="hljs-keyword">this</span>.border.remove(); <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.border;
            <span class="hljs-keyword">this</span>.border_extra.remove(); <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.border_extra;
        },
    
        onRender: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            Widgets.Device.prototype.onRender.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-384">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-384">&#182;</a>
              </div>
              <p>Render spikes</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">var</span> spikes = <span class="hljs-keyword">this</span>.spikes = <span class="hljs-keyword">this</span>.spikes.data(
                <span class="hljs-keyword">this</span>.buffer.select(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                    <span class="hljs-keyword">return</span> ensure(d, <span class="hljs-string">'data.event.type'</span>, <span class="hljs-string">'update'</span>);
                }),
                <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                    <span class="hljs-keyword">return</span> d.timestamp
                }
            );
    
            spikes.enter().append(<span class="hljs-string">'line'</span>).attr({
                x1: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                    <span class="hljs-keyword">return</span> self.timescale(self.dateFn(d.timestamp))
                },
                y1: self.stateScale(<span class="hljs-literal">false</span>),
                x2: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                    <span class="hljs-keyword">return</span> self.timescale(self.dateFn(d.timestamp))
                },
                y2: self.stateScale(<span class="hljs-literal">true</span>)
            });
            spikes.attr({
                x1: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                    <span class="hljs-keyword">return</span> self.timescale(self.dateFn(d.timestamp))
                },
                x2: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                    <span class="hljs-keyword">return</span> self.timescale(self.dateFn(d.timestamp))
                }
            });
            spikes.exit().remove();</pre></div></div>
            
        </li>
        
        
        <li id="section-385">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-385">&#182;</a>
              </div>
              <p>Render borders</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">var</span> line = d3.svg.line()
                .x(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                    <span class="hljs-keyword">return</span> self.timescale(self.dateFn(d.timestamp));
                })
                .y(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                    <span class="hljs-keyword">if</span> (ensure(d, <span class="hljs-string">'data.event.type'</span>, <span class="hljs-string">'update'</span>)) {
                        <span class="hljs-keyword">return</span> self.computed(<span class="hljs-string">'svg.height'</span>) - self.options.theme.device.state.border.width/<span class="hljs-number">2</span>;
                    } <span class="hljs-keyword">else</span> {
                        <span class="hljs-keyword">return</span> self.computed(<span class="hljs-string">'svg.height'</span>) + self.options.theme.device.state.border.width;
                    }
                })
                .interpolate(<span class="hljs-string">"step-after"</span>);
            <span class="hljs-keyword">this</span>.border.datum(<span class="hljs-keyword">this</span>.buffer.all(),
                <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                    <span class="hljs-keyword">return</span> d.timestamp
                })
                .attr(<span class="hljs-string">'d'</span>, line);
    
            <span class="hljs-keyword">var</span> last = <span class="hljs-keyword">this</span>.buffer.last();
            <span class="hljs-keyword">if</span> (last) {
                <span class="hljs-keyword">this</span>.border_extra.attr({
                    x1: self.timescale(self.dateFn(last.timestamp)),
                    y1: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
                        <span class="hljs-keyword">if</span> (ensure(last, <span class="hljs-string">'data.event.type'</span>, <span class="hljs-string">'update'</span>)) {
                            <span class="hljs-keyword">return</span> self.computed(<span class="hljs-string">'svg.height'</span>) - self.options.theme.device.state.border.width/<span class="hljs-number">2</span>;
                        } <span class="hljs-keyword">else</span> {
                            <span class="hljs-keyword">return</span> self.computed(<span class="hljs-string">'svg.height'</span>) + self.options.theme.device.state.border.width;
                        }
                    },
                    x2: self.timescale(self.dateFn(last.next.timestamp)),
                    y2: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
                        <span class="hljs-keyword">if</span> (ensure(last, <span class="hljs-string">'data.event.type'</span>, <span class="hljs-string">'update'</span>)) {
                            <span class="hljs-keyword">return</span> self.computed(<span class="hljs-string">'svg.height'</span>) - self.options.theme.device.state.border.width/<span class="hljs-number">2</span>;
                        } <span class="hljs-keyword">else</span> {
                            <span class="hljs-keyword">return</span> self.computed(<span class="hljs-string">'svg.height'</span>) + self.options.theme.device.state.border.width;
                        }
                    }
                });
            }
        },
    
        onRulerFocusUpdate: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(coordinate, direction, timestamp, focusedFrame, lastFocusedFrame)</span> </span>{
            Widgets.Device.prototype.onRulerFocusUpdate.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">if</span> (ensure(focusedFrame, <span class="hljs-string">'data.event.type'</span>, <span class="hljs-string">'update'</span>) &amp;&amp; ensure(focusedFrame, <span class="hljs-string">'data.event.picto'</span>)) {
                <span class="hljs-keyword">this</span>._$picto.attr({<span class="hljs-keyword">class</span>: <span class="hljs-string">'picto picto-'</span> + focusedFrame.data.event.picto});
            } <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">this</span>._$picto.attr({<span class="hljs-keyword">class</span>: <span class="hljs-string">'picto picto-switch_type'</span>});
            }
    
            <span class="hljs-keyword">var</span> spikes = <span class="hljs-keyword">this</span>.spikes.data(
                _.compact([focusedFrame, lastFocusedFrame]),
                <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                    <span class="hljs-keyword">return</span> d.timestamp
                }
            );
    
            spikes.classed(<span class="hljs-string">'focused'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(d)</span> </span>{
                <span class="hljs-keyword">return</span> d == focusedFrame
            });
        }
    });</pre></div></div>
            
        </li>
        
        
        <li id="section-386">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-386">&#182;</a>
              </div>
              <h2 id="widgets-contact">Widgets.Contact</h2>

            </div>
            
        </li>
        
        
        <li id="section-387">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-387">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>    
    
    Widgets.Contact = Widgets.Device.extend({
    
        defaults: {
            kind: <span class="hljs-string">'contact'</span>,
            buffer: {
                pairing: <span class="hljs-literal">true</span>,
                shadowing: <span class="hljs-literal">true</span>
            }
        },
    
        onBeforeInitD3: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            Widgets.Device.prototype.onBeforeInitD3.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-388">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-388">&#182;</a>
              </div>
              <p>Setup d3 functions</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.stateFn = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-keyword">if</span> (d.timestamp) {
                        <span class="hljs-keyword">return</span> parseBoolean(d.data.event.state.value);
                    } <span class="hljs-keyword">else</span> {
                        <span class="hljs-keyword">return</span> parseBoolean(d.event.state.value);
                    }
                } <span class="hljs-keyword">catch</span> (e) {
                    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
                }
            };
        },
    
        onInitD3: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            Widgets.Device.prototype.onInitD3.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">this</span>.stateScale = d3.scale.quantize()
                .range([<span class="hljs-number">0</span>, <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'svg.height'</span>) - <span class="hljs-keyword">this</span>.options.theme.device.state.border.width])
                .domain([<span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>]);
    
            <span class="hljs-keyword">this</span>.initD3StateChart();
        },
    
        onDestroyD3: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            Widgets.Device.prototype.onDestroyD3.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.stateScale;
    
            <span class="hljs-keyword">this</span>.destroyD3StateChart();
        },
    
        onRender: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            Widgets.Device.prototype.onRender.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">this</span>.renderD3StateChart();
        },
    
        onRulerFocusUpdate: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(coordinate, direction, timestamp, focusedFrame, lastFocusedFrame)</span> </span>{
            Widgets.Device.prototype.onRulerFocusUpdate.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">if</span> (ensure(focusedFrame, <span class="hljs-string">'data.event.type'</span>, <span class="hljs-string">'update'</span>) &amp;&amp; ensure(focusedFrame, <span class="hljs-string">'data.event.picto'</span>)) {
                <span class="hljs-keyword">this</span>._$picto.attr({<span class="hljs-keyword">class</span>: <span class="hljs-string">'picto picto-'</span>+focusedFrame.data.event.picto});
            } <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-389">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-389">&#182;</a>
              </div>
              <p>fallback</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">this</span>._$picto.attr({<span class="hljs-keyword">class</span>: <span class="hljs-string">'picto picto-contact_type'</span>});
            }
    
            <span class="hljs-keyword">this</span>.updateD3StateChartFocus(focusedFrame, lastFocusedFrame);
        }
    });
    
    _.extend(Widgets.Contact.prototype, Widgets.Mixins.StateChart);</pre></div></div>
            
        </li>
        
        
        <li id="section-390">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-390">&#182;</a>
              </div>
              <h2 id="widgets-keycardswitch">Widgets.KeycardSwitch</h2>

            </div>
            
        </li>
        
        
        <li id="section-391">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-391">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>    
    
    Widgets.KeycardSwitch = Widgets.Device.extend({
    
        defaults: {
            kind: <span class="hljs-string">'keycardswitch'</span>,
            buffer: {
                pairing: <span class="hljs-literal">true</span>,
                shadowing: <span class="hljs-literal">true</span>
            }
        },
    
        onBeforeInitD3: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            Widgets.Device.prototype.onBeforeInitD3.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-392">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-392">&#182;</a>
              </div>
              <p>Setup d3 functions</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.stateFn = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-keyword">if</span> (d.timestamp) {
                        <span class="hljs-keyword">return</span> parseBoolean(d.data.event.state.state);
                    } <span class="hljs-keyword">else</span> {
                        <span class="hljs-keyword">return</span> parseBoolean(d.event.state.state);
                    }
                } <span class="hljs-keyword">catch</span> (e) {
                    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
                }
            };
        },
    
        onInitD3: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            Widgets.Device.prototype.onInitD3.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">this</span>.stateScale = d3.scale.quantize()
                .range([<span class="hljs-number">0</span>, <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'svg.height'</span>) - <span class="hljs-keyword">this</span>.options.theme.device.state.border.width])
                .domain([<span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>]);
    
            <span class="hljs-keyword">this</span>.initD3StateChart();
        },
    
        onDestroyD3: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            Widgets.Device.prototype.onDestroyD3.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.stateScale;
    
            <span class="hljs-keyword">this</span>.destroyD3StateChart();
        },
    
        onRender: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            Widgets.Device.prototype.onRender.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">this</span>.renderD3StateChart();
        },
    
        onRulerFocusUpdate: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(coordinate, direction, timestamp, focusedFrame, lastFocusedFrame)</span> </span>{
            Widgets.Device.prototype.onRulerFocusUpdate.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">if</span> (ensure(focusedFrame, <span class="hljs-string">'data.event.type'</span>, <span class="hljs-string">'update'</span>) &amp;&amp; ensure(focusedFrame, <span class="hljs-string">'data.event.picto'</span>)) {
                <span class="hljs-keyword">this</span>._$picto.attr({<span class="hljs-keyword">class</span>: <span class="hljs-string">'picto picto-'</span>+focusedFrame.data.event.picto});
            } <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-393">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-393">&#182;</a>
              </div>
              <p>fallback</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">this</span>._$picto.attr({<span class="hljs-keyword">class</span>: <span class="hljs-string">'picto picto-keycardswitch_type'</span>});
            }
    
            <span class="hljs-keyword">this</span>.updateD3StateChartFocus(focusedFrame, lastFocusedFrame);
        }
    });
    
    _.extend(Widgets.KeycardSwitch.prototype, Widgets.Mixins.StateChart);</pre></div></div>
            
        </li>
        
        
        <li id="section-394">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-394">&#182;</a>
              </div>
              <h2 id="widgets-smartplug">Widgets.SmartPlug</h2>

            </div>
            
        </li>
        
        
        <li id="section-395">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-395">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>    
    
    Widgets.SmartPlug = Widgets.Device.extend({
    
        defaults: {
            kind: <span class="hljs-string">'smartplug'</span>,
            buffer: {
                pairing: <span class="hljs-literal">true</span>,
                shadowing: <span class="hljs-literal">true</span>
            }
        },
    
        onInitUI: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            Widgets.Device.prototype.onInitUI.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">this</span>.initUIAside();
        },
    
        onBeforeInitD3: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            Widgets.Device.prototype.onBeforeInitD3.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-396">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-396">&#182;</a>
              </div>
              <p>Setup d3 state functions</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.stateFn = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            };</pre></div></div>
            
        </li>
        
        
        <li id="section-397">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-397">&#182;</a>
              </div>
              <p>Setup d3 value functions</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.valueFn = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-keyword">if</span> (d.timestamp) {
                        <span class="hljs-keyword">return</span> <span class="hljs-built_in">parseInt</span>(d.data.event.state.consumption);
                    } <span class="hljs-keyword">else</span> {
                        <span class="hljs-keyword">return</span> <span class="hljs-built_in">parseInt</span>(d.event.state.consumption);
                    }
                } <span class="hljs-keyword">catch</span> (e) {
                    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
                }
            };
        },
    
        onInitD3: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            Widgets.Device.prototype.onInitD3.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">this</span>.stateScale = d3.scale.quantize()
                .range([<span class="hljs-number">0</span>, <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'svg.height'</span>) - <span class="hljs-keyword">this</span>.options.theme.device.state.border.width])
                .domain([<span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>]);
    
            <span class="hljs-keyword">this</span>.valueScale = d3.scale.linear()
                .range([<span class="hljs-number">0</span>, <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'svg.height'</span>) - <span class="hljs-keyword">this</span>.options.theme.device.state.border.width]);
    
            <span class="hljs-keyword">this</span>.initD3StateChart();
            <span class="hljs-keyword">this</span>.initD3ValueChart();
        },
    
        onDestroyD3: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            Widgets.Device.prototype.onDestroyD3.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.stateScale;
            <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.valueScale;
    
            <span class="hljs-keyword">this</span>.destroyD3StateChart();
            <span class="hljs-keyword">this</span>.destroyD3ValueChart();
        },
    
        onRender: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            Widgets.Device.prototype.onRender.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
    
            <span class="hljs-keyword">this</span>.valueScale.domain(d3.extent(
                self.buffer.select(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                    <span class="hljs-keyword">return</span> ensure(d.data, <span class="hljs-string">'event'</span>) &amp;&amp; d.data.event.type == <span class="hljs-string">'update'</span>}
                ), self.valueFn)
            );
    
            <span class="hljs-keyword">this</span>.renderD3StateChart();
            <span class="hljs-keyword">this</span>.renderD3ValueChart();
        },
    
        onRulerFocusUpdate: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(coordinate, direction, timestamp, focusedFrame, lastFocusedFrame)</span> </span>{
            Widgets.Device.prototype.onRulerFocusUpdate.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">if</span> (ensure(focusedFrame, <span class="hljs-string">'data.event.type'</span>, <span class="hljs-string">'update'</span>) &amp;&amp; ensure(focusedFrame, <span class="hljs-string">'data.event.picto'</span>)) {
                <span class="hljs-keyword">this</span>._$picto.attr({<span class="hljs-keyword">class</span>: <span class="hljs-string">'picto picto-'</span> + focusedFrame.data.event.picto});
                <span class="hljs-keyword">this</span>._$aside.text(<span class="hljs-keyword">this</span>.valueFn(focusedFrame.data)+<span class="hljs-string">' W'</span>).css(<span class="hljs-string">'visibility'</span>, <span class="hljs-string">'visible'</span>);
            } <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-398">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-398">&#182;</a>
              </div>
              <p>fallback</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">this</span>._$picto.attr({<span class="hljs-keyword">class</span>: <span class="hljs-string">'picto picto-smartplug_type'</span>});
                <span class="hljs-keyword">this</span>._$aside.text(<span class="hljs-string">''</span>).css(<span class="hljs-string">'visibility'</span>, <span class="hljs-string">'hidden'</span>);
            }
    
            <span class="hljs-keyword">this</span>.updateD3StateChartFocus(focusedFrame, lastFocusedFrame);
            <span class="hljs-keyword">this</span>.updateD3ValueChartFocus(focusedFrame, lastFocusedFrame);
            <span class="hljs-keyword">this</span>.updateAsidePosition(<span class="hljs-keyword">this</span>.timescale.range()[<span class="hljs-number">1</span>] * coordinate, direction);
        }
    });
    
    _.extend(Widgets.SmartPlug.prototype, Widgets.Mixins.StateChart, Widgets.Mixins.ValueChart, Widgets.Mixins.Aside);</pre></div></div>
            
        </li>
        
        
        <li id="section-399">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-399">&#182;</a>
              </div>
              <h2 id="widgets-colorlight">Widgets.ColorLight</h2>

            </div>
            
        </li>
        
        
        <li id="section-400">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-400">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>    
    Widgets.ColorLight = Widgets.Device.extend({
    
        defaults: {
            kind: <span class="hljs-string">'colorlight'</span>,
            buffer: {
                pairing: <span class="hljs-literal">true</span>,
                shadowing: <span class="hljs-literal">true</span>
            }
        },
    
        onBeforeInitD3: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            Widgets.Device.prototype.onBeforeInitD3.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-401">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-401">&#182;</a>
              </div>
              <p>Setup d3 value function</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.stateFn = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-keyword">if</span> (d.timestamp) {
                        <span class="hljs-keyword">return</span> parseBoolean(d.data.event.state.state);
                    } <span class="hljs-keyword">else</span> {
                        <span class="hljs-keyword">return</span> parseBoolean(d.event.state.state);
                    }
                } <span class="hljs-keyword">catch</span> (e) {
                    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
                }
            };</pre></div></div>
            
        </li>
        
        
        <li id="section-402">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-402">&#182;</a>
              </div>
              <p>Setup d3 color function</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.colorFn = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                <span class="hljs-keyword">try</span> {
                    <span class="hljs-keyword">var</span> state = d.timestamp ? d.data.event.state : d.event.state;
                    <span class="hljs-keyword">return</span> d3.hsl(
                        <span class="hljs-built_in">Math</span>.max(<span class="hljs-number">0.0</span>, <span class="hljs-built_in">Math</span>.min(<span class="hljs-built_in">parseInt</span>(state.color) / <span class="hljs-number">65535.0</span>, <span class="hljs-number">1.0</span>)) * <span class="hljs-number">360</span>,
                        <span class="hljs-built_in">Math</span>.max(<span class="hljs-number">0.0</span>, <span class="hljs-built_in">Math</span>.min(<span class="hljs-built_in">parseInt</span>(state.saturation) / <span class="hljs-number">254.0</span>, <span class="hljs-number">1.0</span>)),
                        <span class="hljs-built_in">Math</span>.max(<span class="hljs-number">0.0</span>, <span class="hljs-built_in">Math</span>.min(<span class="hljs-built_in">parseInt</span>(state.brightness) / <span class="hljs-number">254.0</span>, <span class="hljs-number">1.0</span>))
                    );
                } <span class="hljs-keyword">catch</span> (e) {
                    <span class="hljs-keyword">return</span> d3.hsl(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>);
                }
            }
        },
    
        onInitD3: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            Widgets.Device.prototype.onInitD3.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">this</span>.stateScale = d3.scale.quantize()
                .range([<span class="hljs-number">0</span>, <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'svg.height'</span>) - <span class="hljs-keyword">this</span>.options.theme.device.state.border.width])
                .domain([<span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>]);
    
            <span class="hljs-keyword">this</span>.initD3StateChart();
        },
    
        onDestroyD3: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span> </span>{
            Widgets.Device.prototype.onDestroyD3.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.stateScale;
    
            <span class="hljs-keyword">this</span>.destroyD3StateChart();
        },
    
        onRender: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            Widgets.Device.prototype.onRender.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">this</span>.renderD3StateChart();
        },
    
        onRulerFocusUpdate: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(coordinate, direction, timestamp, focusedFrame, lastFocusedFrame)</span> </span>{
            Widgets.Device.prototype.onRulerFocusUpdate.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">if</span> (ensure(focusedFrame, <span class="hljs-string">'data.event.type'</span>, <span class="hljs-string">'update'</span>) &amp;&amp; ensure(focusedFrame, <span class="hljs-string">'data.event.picto'</span>)) {
                <span class="hljs-keyword">this</span>._$picto.attr({<span class="hljs-keyword">class</span>: <span class="hljs-string">'picto picto-'</span> + focusedFrame.data.event.picto}).css({
                    <span class="hljs-string">'background-color'</span>: <span class="hljs-keyword">this</span>.stateFn(focusedFrame) ? <span class="hljs-keyword">this</span>.colorFn(focusedFrame).toString() : <span class="hljs-string">'transparent'</span>
                });
            } <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-403">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-403">&#182;</a>
              </div>
              <p>fallback</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">this</span>._$picto.attr({<span class="hljs-keyword">class</span>: <span class="hljs-string">'picto picto-colorlight_type'</span>}).css({
                    <span class="hljs-string">'background-color'</span>: <span class="hljs-string">'transparent'</span>
                });
            }
    
            <span class="hljs-keyword">this</span>.updateD3StateChartFocus(focusedFrame, lastFocusedFrame);
        }
    });
    
    _.extend(Widgets.ColorLight.prototype, Widgets.Mixins.StateChart);</pre></div></div>
            
        </li>
        
        
        <li id="section-404">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-404">&#182;</a>
              </div>
              <h2 id="widgets-domicube">Widgets.DomiCube</h2>

            </div>
            
        </li>
        
        
        <li id="section-405">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-405">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>    
    Widgets.DomiCube = Widgets.Device.extend({
    
        defaults: {
            kind: <span class="hljs-string">'domicube'</span>,
            buffer: {
                pairing: <span class="hljs-literal">true</span>,
                shadowing: <span class="hljs-literal">true</span>
            }
        },
    
        onBeforeInitD3: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            Widgets.Device.prototype.onBeforeInitD3.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-406">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-406">&#182;</a>
              </div>
              <p>Setup d3 state functions</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.stateFn = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            };
        },
    
        onInitD3: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            Widgets.Device.prototype.onInitD3.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">this</span>.stateScale = d3.scale.quantize()
                .range([<span class="hljs-number">0</span>, <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'svg.height'</span>) - <span class="hljs-keyword">this</span>.options.theme.device.state.border.width])
                .domain([<span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>]);
    
            <span class="hljs-keyword">this</span>.initD3StateChart();
        },
    
        onDestroyD3: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            Widgets.Device.prototype.onDestroyD3.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.stateScale;
    
            <span class="hljs-keyword">this</span>.destroyD3StateChart();
        },
    
        onRender: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            Widgets.Device.prototype.onRender.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-407">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-407">&#182;</a>
              </div>
              <p>Render the chart</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.renderD3StateChart();
        },
    
        onRulerFocusUpdate: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(coordinate, direction, timestamp, focusedFrame, lastFocusedFrame)</span> </span>{
            Widgets.Device.prototype.onRulerFocusUpdate.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">if</span> (ensure(focusedFrame, <span class="hljs-string">'data.event.type'</span>, <span class="hljs-string">'update'</span>) &amp;&amp; ensure(focusedFrame, <span class="hljs-string">'data.event.picto'</span>)) {
                <span class="hljs-keyword">this</span>._$picto.attr({<span class="hljs-keyword">class</span>: <span class="hljs-string">'picto picto-domicube_state_on'</span>});
            } <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-408">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-408">&#182;</a>
              </div>
              <p>fallback</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">this</span>._$picto.attr({<span class="hljs-keyword">class</span>: <span class="hljs-string">'picto picto-domicube_type'</span>});
            }
    
            <span class="hljs-keyword">this</span>.updateD3StateChartFocus(focusedFrame, lastFocusedFrame);
        }
    });
    
    _.extend(Widgets.DomiCube.prototype, Widgets.Mixins.StateChart, Widgets.Mixins.Focus);</pre></div></div>
            
        </li>
        
        
        <li id="section-409">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-409">&#182;</a>
              </div>
              <h2 id="widgets-mediaplayer">Widgets.MediaPlayer</h2>

            </div>
            
        </li>
        
        
        <li id="section-410">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-410">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>    
    Widgets.MediaPlayer = Widgets.Device.extend({
    
        defaults: {
            kind: <span class="hljs-string">'mediaplayer'</span>,
            buffer: {
                pairing: <span class="hljs-literal">true</span>,
                shadowing: <span class="hljs-literal">true</span>
            }
        },
    
        onBeforeInitD3: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            Widgets.Device.prototype.onBeforeInitD3.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-411">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-411">&#182;</a>
              </div>
              <p>Setup d3 state functions</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.stateFn = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
            };
        },
    
        onInitD3: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            Widgets.Device.prototype.onInitD3.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">this</span>.stateScale = d3.scale.quantize()
                .range([<span class="hljs-number">0</span>, <span class="hljs-keyword">this</span>.computed(<span class="hljs-string">'svg.height'</span>) - <span class="hljs-keyword">this</span>.options.theme.device.state.border.width])
                .domain([<span class="hljs-literal">false</span>, <span class="hljs-literal">true</span>]);
    
            <span class="hljs-keyword">this</span>.initD3StateChart();
        },
    
        onDestroyD3: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            Widgets.Device.prototype.onDestroyD3.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">delete</span> <span class="hljs-keyword">this</span>.stateScale;
    
            <span class="hljs-keyword">this</span>.destroyD3StateChart();
        },
    
        onRender: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            Widgets.Device.prototype.onRender.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-412">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-412">&#182;</a>
              </div>
              <p>Render the chart</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.renderD3StateChart();
        },
    
        onRulerFocusUpdate: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(coordinate, direction, timestamp, focusedFrame, lastFocusedFrame)</span> </span>{
            Widgets.Device.prototype.onRulerFocusUpdate.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">if</span> (ensure(focusedFrame, <span class="hljs-string">'data.event.type'</span>, <span class="hljs-string">'update'</span>) &amp;&amp; ensure(focusedFrame, <span class="hljs-string">'data.event.picto'</span>)) {
                <span class="hljs-keyword">this</span>._$picto.attr({<span class="hljs-keyword">class</span>: <span class="hljs-string">'picto picto-mediaplayer_state_on'</span>});
            } <span class="hljs-keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-413">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-413">&#182;</a>
              </div>
              <p>fallback</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="hljs-keyword">this</span>._$picto.attr({<span class="hljs-keyword">class</span>: <span class="hljs-string">'picto picto-mediaplayer_type'</span>});
            }
    
            <span class="hljs-keyword">this</span>.updateD3StateChartFocus(focusedFrame, lastFocusedFrame);
        }
    });
    
    _.extend(Widgets.MediaPlayer.prototype, Widgets.Mixins.StateChart, Widgets.Mixins.Focus);</pre></div></div>
            
        </li>
        
        
        <li id="section-414">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-414">&#182;</a>
              </div>
              <h2 id="widgets-program">Widgets.Program</h2>

            </div>
            
        </li>
        
        
        <li id="section-415">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-415">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>    
    Widgets.Program = Widgets.Widget.extend({
    
        defaults: {
            kind: <span class="hljs-string">'program'</span>,
            buffer: {
                pairing: <span class="hljs-literal">true</span>,
                shadowing: <span class="hljs-literal">true</span>
            }
        },
    
        onInitUI: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">this</span>.initUIEventlineActions();
        },
    
        onInitD3: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">this</span>.state = <span class="hljs-keyword">this</span>.svg.append(<span class="hljs-string">'g'</span>).attr({<span class="hljs-keyword">class</span>: <span class="hljs-string">'program state'</span>}).selectAll(<span class="hljs-string">'rect'</span>);
            <span class="hljs-keyword">this</span>.initD3Markers();
            <span class="hljs-keyword">this</span>.initD3TimelineGrid();
        },
    
        onRender: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> </span>{
            Widgets.Widget.prototype.onRender.apply(<span class="hljs-keyword">this</span>, <span class="hljs-built_in">arguments</span>);
    
            <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;</pre></div></div>
            
        </li>
        
        
        <li id="section-416">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-416">&#182;</a>
              </div>
              <p>Render State</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">var</span> state = <span class="hljs-keyword">this</span>.state = <span class="hljs-keyword">this</span>.state.data(
                <span class="hljs-keyword">this</span>.buffer.select(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                    <span class="hljs-keyword">return</span> ensure(d, <span class="hljs-string">'data.event'</span>);
                }),
                <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                    <span class="hljs-keyword">return</span> d.timestamp
                }
            );
    
            state.enter().append(<span class="hljs-string">'rect'</span>).attr({
                x: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                    <span class="hljs-keyword">return</span> self.timescale(self.dateFn(d.timestamp));
                },
                width: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                    <span class="hljs-keyword">return</span> self.timescale(self.dateFn(d.next.timestamp)) - self.timescale(self.dateFn(d.timestamp))
                },
                <span class="hljs-keyword">class</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                    <span class="hljs-keyword">return</span> d.data.event.state.name;
                },
                y: (self.computed(<span class="hljs-string">'svg.height'</span>) - self.options.theme.program.state.height) / <span class="hljs-number">2</span>,
                height: self.options.theme.program.state.height,
                rx: self.options.theme.program.state.radius.x,
                ry: self.options.theme.program.state.radius.y
            });
            state.attr({
                x: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                    <span class="hljs-keyword">return</span> self.timescale(self.dateFn(d.timestamp));
                },
                width: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                    <span class="hljs-keyword">return</span> self.timescale(self.dateFn(d.next.timestamp)) - self.timescale(self.dateFn(d.timestamp))
                },
                <span class="hljs-keyword">class</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{ <span class="hljs-keyword">return</span> d.data.event.state.name; }
            });
            state.exit().remove();</pre></div></div>
            
        </li>
        
        
        <li id="section-417">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-417">&#182;</a>
              </div>
              <p>Render Markers</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.renderD3Markers();</pre></div></div>
            
        </li>
        
        
        <li id="section-418">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-418">&#182;</a>
              </div>
              <p>Render the Timeline Grid</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="hljs-keyword">this</span>.renderTimelineGrid();
        },
    
        onRulerFocusUpdate: <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(coordinate, direction, timestamp, focusedFrame, lastFocusedFrame)</span> </span>{
            <span class="hljs-keyword">var</span> state = <span class="hljs-keyword">this</span>.state.data(
                _.compact([focusedFrame, lastFocusedFrame]),
                <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                    <span class="hljs-keyword">return</span> d.timestamp
                }
            );
    
            state.classed(<span class="hljs-string">'focused'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(d)</span> </span>{
                <span class="hljs-keyword">return</span> d == focusedFrame
            });
        }
    });
    
    _.extend(
        Widgets.Program.prototype,
        Widgets.Mixins.TimelineGrid,
        Widgets.Mixins.Markers,
        Widgets.Mixins.Focus,
        Widgets.Mixins.EventlineActions
    );
    
    

    <span class="hljs-keyword">return</span> Debugger;
}));</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
